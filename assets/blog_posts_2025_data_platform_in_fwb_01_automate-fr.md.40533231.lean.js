import{_ as o,H as l,o as t,c as r,S as s,J as a}from"./chunks/framework.ad705b6b.js";const B=JSON.parse('{"title":"Plateforme de données - Partie 2 : Automatiser tout 🤖","description":"","frontmatter":{"date":"2025-07-03T00:00:00.000Z","title":"Plateforme de données - Partie 2 : Automatiser tout 🤖","sidebar":false,"author":"Martin Erpicum","category":"Article","tags":["data","orchestrator"],"blog":"post","aside":"left","prev":false,"next":false},"headers":[],"relativePath":"blog/posts/2025/data_platform_in_fwb_01_automate-fr.md"}'),p={name:"blog/posts/2025/data_platform_in_fwb_01_automate-fr.md"};function i(c,e,d,u,m,y){const n=l("ImageCenter");return t(),r("div",null,[e[0]||(e[0]=s('<p><em>Résumé exécutif</em> : Dans une organisation polycéphale, la Gouvernance des Données est un défi complexe. Cet article explore la mise en œuvre d&#39;une Plateforme de Données basée sur <a href="https://dagster.io/" target="_blank" rel="noreferrer">Dagster</a> pour la <a href="https://www.federation-wallonie-bruxelles.be" target="_blank" rel="noreferrer">Fédération Wallonie-Bruxelles (FWB)</a>. Il met en évidence l&#39;importance de l&#39;automatisation, de la modularité et de la réutilisabilité des composants pour abaisser la barrière technique et améliorer la littératie des données parmi les analystes de données et les gestionnaires de données.</p><hr><p><em>Les opinions exprimées sur ce site web sont les miennes et ne reflètent pas nécessairement celles de mon employeur.</em></p><p><strong>Table des matières</strong></p><nav class="table-of-contents"><ul><li><a href="#🏗️-architecture-technique-de-notre-plateforme-de-donnees">🏗️ Architecture technique de notre plateforme de données</a><ul><li><a href="#structure-des-emplacements-de-code">Structure des emplacements de code</a></li></ul></li><li><a href="#🤖-automatiser-le-ci-cd">🤖 Automatiser le CI/CD</a><ul><li><a href="#flux-ci-cd">Flux CI/CD</a></li><li><a href="#etapes-ci-cd-de-notre-plateforme-de-donnees">Étapes CI/CD de notre plateforme de données</a></li><li><a href="#specificites-des-environnements">Spécificités des environnements</a></li></ul></li><li><a href="#🤖-automatiser-les-tests">🤖 Automatiser les tests</a></li><li><a href="#🚀-automatiser-le-deploiement">🚀 Automatiser le déploiement</a><ul><li><a href="#cycle-de-deploiement-de-notre-plateforme-de-donnees">Cycle de déploiement de notre plateforme de données</a></li><li><a href="#cycle-de-deploiement-de-nos-projets-dbt">Cycle de déploiement de nos projets DBT</a></li></ul></li><li><a href="#👀-automatiser-l-observabilite">👀 Automatiser l&#39;observabilité</a><ul><li><a href="#observabilite-de-notre-pile-conteneurs">Observabilité de notre pile (conteneurs)</a></li><li><a href="#observabilite-de-nos-pipelines-de-donnees">Observabilité de nos pipelines de données</a></li><li><a href="#observabilite-de-nos-donnees">Observabilité de nos données</a></li></ul></li></ul></nav><p>Si vous souhaitez encourager les analystes de données et les gestionnaires de données à participer au développement de pipelines de données, vous devez vous assurer que chaque commit est testé et validé avant d&#39;être déployé en production. Vous voulez également automatiser les tâches répétitives pour réduire la barrière technique autant que possible. De plus, vous voulez mettre en place un système d&#39;observabilité solide pour surveiller la santé de vos systèmes et pipelines de données et détecter les problèmes rapidement.</p><p>Pour expliquer comment nous automatisons le déploiement des pipelines de données, je vais d&#39;abord décrire l&#39;architecture de notre plateforme de données.</p><h2 id="🏗️-architecture-technique-de-notre-plateforme-de-donnees" tabindex="-1">🏗️ Architecture technique de notre plateforme de données <a class="header-anchor" href="#🏗️-architecture-technique-de-notre-plateforme-de-donnees" aria-label="Permalink to &quot;🏗️ Architecture technique de notre plateforme de données&quot;">​</a></h2><p>Notre pile est actuellement basée sur les composants suivants :</p><ul><li><strong>Dagster</strong> : L&#39;orchestrateur de nos pipelines de données. Il nous permet de définir, planifier et surveiller nos workflows de données.</li><li><strong>dbt-core</strong> : L&#39;outil de transformation de données qui nous permet de définir nos modèles et transformations de données de manière modulaire. Il est utilisé pour construire les modèles et transformations de données qui sont exécutés par Dagster.</li><li><strong>DuckDB</strong> : Le moteur SQL qui nous permet d&#39;exécuter des requêtes SQL sur nos données. Il est utilisé pour le développement et les tests locaux de nos pipelines de données.</li><li><strong>Azure</strong> : Le fournisseur cloud qui héberge notre plateforme de données. Nous utilisons Azure Data Lake Storage (ADLS) pour le stockage des données.</li><li><strong>Docker</strong> : La technologie de conteneurisation qui nous permet d&#39;empaqueter nos pipelines de données et leurs dépendances de manière portable.</li><li><strong>GitLab</strong> : Le système de contrôle de version qui nous permet de gérer nos dépôts de code et d&#39;automatiser nos pipelines CI/CD.</li></ul>',10)),a(n,{src:"https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/data_platform.drawio.png",alt:"Flux de données dans notre pile",width:"600"}),e[1]||(e[1]=s(`<p>Une remarque importante ici : nos choix techniques ne sont pas gravés dans le marbre. Nous évaluons constamment de nouvelles technologies et approches pour améliorer notre plateforme de données. L&#39;objectif est de fournir une architecture flexible et évolutive qui peut s&#39;adapter aux besoins changeants de l&#39;organisation. Si <code>dbt-core</code>, <code>Dagster</code>, ou tout autre outil/fournisseur ne répond plus à nos besoins, nous n&#39;hésiterons pas à le changer. Ce à quoi nous nous engageons vraiment, c&#39;est l&#39;(1) <strong>architecture</strong>, et les (2) <strong>langages</strong> que nous utilisons pour l&#39;implémenter (Python, SQL). Les outils et fournisseurs ne sont que des moyens pour atteindre un objectif.</p><p>Pour d&#39;excellentes recommandations sur la façon de construire une plateforme de données solide, je recommande de lire <a href="https://www.oreilly.com/library/view/fundamentals-of-data/9781098108298/" target="_blank" rel="noreferrer">Fundamentals of Data Engineering</a> de Joe Reis et Matt Housley.</p><h3 id="structure-des-emplacements-de-code" tabindex="-1">Structure des emplacements de code <a class="header-anchor" href="#structure-des-emplacements-de-code" aria-label="Permalink to &quot;Structure des emplacements de code&quot;">​</a></h3><p>Pour permettre à chaque administration générale (AG) de posséder son propre dépôt (un <strong>code location</strong> dans le vocabulaire Dagster)—qui contient l&#39;emplacement de code Dagster pour les pipelines de données de cette AG—nous avons décidé de <strong>refléter la structure organisationnelle de la FWB dans l&#39;architecture de notre plateforme de données</strong>. Nous utilisons également des emplacements de code distincts pour des projets spécifiques qui ne sont pas liés à une AG spécifique. Cela permet à chaque AG de gérer ses propres pipelines de données de manière indépendante et d&#39;avoir une propriété claire du code. Les emplacements de code sont ensuite agrégés dans une seule instance Dagster, qui est la plateforme de données.</p><h4 id="🗂️-structure-de-notre-dossier-d-emplacements-de-code" tabindex="-1">🗂️ Structure de notre dossier d&#39;emplacements de code <a class="header-anchor" href="#🗂️-structure-de-notre-dossier-d-emplacements-de-code" aria-label="Permalink to &quot;🗂️ Structure de notre dossier d&#39;emplacements de code&quot;">​</a></h4><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">dagster_home</span><span style="color:#BABED8;"> (main) $ tree -L 1</span></span>
<span class="line"><span style="color:#82AAFF;">.</span></span>
<span class="line"><span style="color:#FFCB6B;">├──</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ags_project</span></span>
<span class="line"><span style="color:#FFCB6B;">├──</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">agaj_project</span></span>
<span class="line"><span style="color:#82AAFF;">...</span></span>
<span class="line"><span style="color:#FFCB6B;">├──</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">data_platform</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;"># notre emplacement de code générique</span></span>
<span class="line"><span style="color:#FFCB6B;">├──</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">dagster.yaml</span></span>
<span class="line"><span style="color:#FFCB6B;">└──</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">workspace.yaml</span></span></code></pre></div><h2 id="🤖-automatiser-le-ci-cd" tabindex="-1">🤖 Automatiser le CI/CD <a class="header-anchor" href="#🤖-automatiser-le-ci-cd" aria-label="Permalink to &quot;🤖 Automatiser le CI/CD&quot;">​</a></h2><h3 id="flux-ci-cd" tabindex="-1">Flux CI/CD <a class="header-anchor" href="#flux-ci-cd" aria-label="Permalink to &quot;Flux CI/CD&quot;">​</a></h3><p>Notre configuration de déploiement est basée sur les pipelines GitLab CI/CD. Le flux est le suivant :</p><ol start="0"><li><strong>Intégration des sous-modules</strong> : Les projets DBT sont intégrés comme un sous-module Git dans le dépôt principal. Cela nous permet d&#39;inclure le travail des gestionnaires de données et des analystes dans la plateforme de données sans avoir à dupliquer le code ou à maintenir des dépôts séparés.</li><li><strong>Build</strong> : Le code est construit et empaqueté dans une image Docker ; la même image est utilisée pour le Webserver, le Daemon et les emplacements de code.</li><li><strong>Valider les définitions</strong> : Les définitions Dagster sont validées pour s&#39;assurer qu&#39;elles sont correctes et ne contiennent aucune erreur.</li><li><strong>Ruff</strong> : Le code est vérifié pour les problèmes de style et de formatage à l&#39;aide de <a href="https://docs.astral.sh/ruff/" target="_blank" rel="noreferrer">Ruff</a>.</li><li><strong>Sonar</strong> : Le code est analysé pour les problèmes de qualité et de sécurité à l&#39;aide de <a href="https://www.sonarqube.org/" target="_blank" rel="noreferrer">SonarQube</a>.</li><li><strong>Test</strong> : Le code est testé à l&#39;aide de <a href="https://docs.pytest.org/en/stable/" target="_blank" rel="noreferrer">pytest</a> pour les tests unitaires, les tests d&#39;intégration et l&#39;analyse de couverture.</li><li><strong>Déployer en DEV</strong> : Le code est déployé dans l&#39;environnement de développement pour chaque commit dans la branche principale ou une branche de fonctionnalité.</li><li><strong>Déployer en STAGING</strong> : Lorsqu&#39;un tag est créé, le code est déployé dans l&#39;environnement de staging.</li><li><strong>Déployer en PROD</strong> : Le code est déployé dans l&#39;environnement de production après validation manuelle en staging.</li></ol><h3 id="etapes-ci-cd-de-notre-plateforme-de-donnees" tabindex="-1">Étapes CI/CD de notre plateforme de données <a class="header-anchor" href="#etapes-ci-cd-de-notre-plateforme-de-donnees" aria-label="Permalink to &quot;Étapes CI/CD de notre plateforme de données&quot;">​</a></h3><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight has-focused-lines"><code><span class="line"><span style="color:#676E95;font-style:italic;"># .gitlab-ci.yml (simplifié)</span></span>
<span class="line has-focus"><span style="color:#F07178;">build</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">stage</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">build</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">docker compose build</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F07178;">validate</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">stage</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">test</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">dagster definitions validate -m data_platform</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F07178;">test</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">stage</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">test</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">pytest -v</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#C3E88D;">--cov=. --cov-branch --cov-report=html --cov-report=term</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#C3E88D;">--cov-report xml:coverage.xml</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#C3E88D;">--junitxml=report.xml</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F07178;">ruff</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">stage</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">test</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ruff check --output-format=gitlab .</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F07178;">sonarqube-check</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">stage</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">test</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">sonar-scanner</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F07178;">deploy_dev</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">stage</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">deploy</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">only</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">main</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">docker compose up -d</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F07178;">deploy_staging</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">stage</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">deploy</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">only</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">tags</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">docker compose up -d</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F07178;">deploy_prod</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">stage</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">deploy</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">when</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">manual</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">only</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">tags</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">docker compose up -d</span></span></code></pre></div><h3 id="specificites-des-environnements" tabindex="-1">Spécificités des environnements <a class="header-anchor" href="#specificites-des-environnements" aria-label="Permalink to &quot;Spécificités des environnements&quot;">​</a></h3><p>Les environnements sont configurés dans le fichier <code>docker-compose.yml</code> à l&#39;aide de variables d&#39;environnement. Chaque environnement a ses propres variables d&#39;environnement, qui sont utilisées pour configurer le comportement de la plateforme de données.</p><p>Nous utilisons un seul fichier <code>docker-compose.yml</code> dont le contenu peut être adapté en fonction de l&#39;environnement. Le fichier compose contient tous les services nécessaires pour exécuter la plateforme de données, y compris le webserver Dagster, le daemon Dagster et les emplacements de code Dagster.</p><p>Dans l&#39;exemple suivant, nous montrons comment nous utilisons le même fichier compose pour déployer la plateforme de données dans différents environnements en utilisant uniquement des variables d&#39;environnement :</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;"># docker-compose.yml (simplifié)</span></span>
<span class="line"><span style="color:#F07178;">version</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3.8</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#F07178;">services</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">dagster_webserver</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">build</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#F07178;">context</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">.</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">\${DOCKER_IMAGE}:\${CI_COMMIT_SHORT_SHA}</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">restart</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">unless-stopped</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">env_file</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">.env</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F07178;">environment</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">      </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">ENVIRONMENT=\${ENVIRONMENT}</span><span style="color:#BABED8;"> </span><span style="color:#676E95;font-style:italic;"># staging, prod</span></span></code></pre></div><h2 id="🤖-automatiser-les-tests" tabindex="-1">🤖 Automatiser les tests <a class="header-anchor" href="#🤖-automatiser-les-tests" aria-label="Permalink to &quot;🤖 Automatiser les tests&quot;">​</a></h2><p>Tous nos tests sont implémentés en Python à l&#39;aide de <code>pytest</code>. Nous couvrons les tests unitaires, les tests d&#39;intégration et l&#39;analyse de couverture. Cependant, nous testons généralement seulement les parties critiques de notre code, telles que les définitions Dagster, les ressources personnalisées, le code Python et le parsing DBT. Nous ne testons généralement pas les requêtes SQL à moins qu&#39;elles ne contiennent une logique complexe.</p><h2 id="🚀-automatiser-le-deploiement" tabindex="-1">🚀 Automatiser le déploiement <a class="header-anchor" href="#🚀-automatiser-le-deploiement" aria-label="Permalink to &quot;🚀 Automatiser le déploiement&quot;">​</a></h2><h3 id="cycle-de-deploiement-de-notre-plateforme-de-donnees" tabindex="-1">Cycle de déploiement de notre plateforme de données <a class="header-anchor" href="#cycle-de-deploiement-de-notre-plateforme-de-donnees" aria-label="Permalink to &quot;Cycle de déploiement de notre plateforme de données&quot;">​</a></h3><p>Le cycle de déploiement de notre plateforme de données consiste en les étapes suivantes :</p><ol start="0"><li>Développement local → un développeur travaille sur une nouvelle fonctionnalité dans son environnement local.</li><li>Commit → le développeur valide ses modifications dans la branche principale ou une branche de fonctionnalité.</li><li>Build → GitLab CI/CD construit le code et l&#39;empaquette dans une image Docker.</li><li>Test → GitLab CI/CD exécute les tests et génère un rapport de couverture.</li><li>Déployer en DEV → GitLab CI/CD déploie le code dans l&#39;environnement de développement.</li><li>Tag de version → lorsque le développeur est satisfait des modifications, il crée un tag de version.</li><li>Déployer en STAGING → GitLab CI/CD déploie le code dans l&#39;environnement de staging.</li><li>Déployer en PROD → Après validation en staging, GitLab CI/CD déploie le code dans l&#39;environnement de production.</li></ol>`,23)),a(n,{src:"https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/dagster_code_location_cycle.drawio.png",alt:"Cycle de déploiement de l'emplacement de code Dagster",width:"600"}),e[2]||(e[2]=s(`<h3 id="cycle-de-deploiement-de-nos-projets-dbt" tabindex="-1">Cycle de déploiement de nos projets DBT <a class="header-anchor" href="#cycle-de-deploiement-de-nos-projets-dbt" aria-label="Permalink to &quot;Cycle de déploiement de nos projets DBT&quot;">​</a></h3><p>Lorsqu&#39;une nouvelle version est créée, le projet DBT est automatiquement versionné à l&#39;aide de l&#39;outil <code>release</code>. La version est incrémentée et un changelog est généré. Le projet DBT est ensuite analysé à l&#39;aide de <code>dbt parse</code> pour produire le fichier <code>manifest.json</code>, qui contient les métadonnées du projet DBT. Ce fichier est utilisé par Dagster pour découvrir les modèles DBT et leurs dépendances.</p><h4 id="le-cycle-de-version-de-nos-projets-dbt-consiste-en-les-etapes-suivantes" tabindex="-1">Le cycle de version de nos projets DBT consiste en les étapes suivantes : <a class="header-anchor" href="#le-cycle-de-version-de-nos-projets-dbt-consiste-en-les-etapes-suivantes" aria-label="Permalink to &quot;Le cycle de version de nos projets DBT consiste en les étapes suivantes :&quot;">​</a></h4><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight has-focused-lines has-diff"><code><span class="line"><span style="color:#676E95;font-style:italic;"># .gitlab-ci.yml</span></span>
<span class="line has-focus"><span style="color:#F07178;">sqlfluff</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">allow_failure</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">sqlfluff lint models</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F07178;">release</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">VERSION=$(release next-version)</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;font-style:italic;">|</span></span>
<span class="line"><span style="color:#C3E88D;">      sed -i &quot;s/version: \\&quot;[^\\&quot;]*\\&quot;/version: \\&quot;$VERSION\\&quot;/&quot; &quot;$FILETOCHANGE&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">release changelog</span></span>
<span class="line has-focus"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">release commit-and-tag --create-tag-pipeline CHANGELOG.md \${DBT_PATH}/dbt_project.yml</span><span style="color:#BABED8;"> </span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#F07178;">dagster_submodule</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">rules</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#F07178;">if</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">$CI_COMMIT_TAG</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">...</span><span style="color:#89DDFF;">]</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">git add .</span></span>
<span class="line has-focus"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">git diff --cached --quiet || git commit -m &quot;Update dbt submodule&quot;</span><span style="color:#BABED8;">  </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;"># Pousser les modifications sans forcer la suppression</span></span>
<span class="line has-focus"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">git push origin dagster_submodule</span><span style="color:#BABED8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Cette étape publie un artefact pour la documentation DBT.</span></span>
<span class="line has-focus"><span style="color:#F07178;">pages</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">stage</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">dbt_docs</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">only</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">main</span></span>
<span class="line"><span style="color:#BABED8;">  </span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">...</span><span style="color:#89DDFF;">]</span></span>
<span class="line has-focus"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> </span><span style="color:#C3E88D;">dbt docs generate</span><span style="color:#BABED8;"> </span></span></code></pre></div><h2 id="👀-automatiser-l-observabilite" tabindex="-1">👀 Automatiser l&#39;observabilité <a class="header-anchor" href="#👀-automatiser-l-observabilite" aria-label="Permalink to &quot;👀 Automatiser l&#39;observabilité&quot;">​</a></h2><p>L&#39;observabilité de notre plateforme de données est un aspect clé de la mise en œuvre d&#39;une Plateforme de Données. Elle nous permet de surveiller la santé de nos systèmes (1) et de nos pipelines de données (2), de détecter les problèmes rapidement et d&#39;assurer la qualité de nos données (3).</p>`,6)),a(n,{src:"https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/images/ms-team-panopticon.png",alt:"Panopticon",width:"600"}),e[3]||(e[3]=s('<h3 id="observabilite-de-notre-pile-conteneurs" tabindex="-1">Observabilité de notre pile (conteneurs) <a class="header-anchor" href="#observabilite-de-notre-pile-conteneurs" aria-label="Permalink to &quot;Observabilité de notre pile (conteneurs)&quot;">​</a></h3><p>Pour l&#39;observabilité de nos systèmes, nous utilisons <a href="https://www.elastic.co/kibana" target="_blank" rel="noreferrer">Kibana</a> et <a href="https://dozzle.dev/" target="_blank" rel="noreferrer">Dozzle</a> pour surveiller les journaux et les métriques de notre plateforme de données.</p><h3 id="observabilite-de-nos-pipelines-de-donnees" tabindex="-1">Observabilité de nos pipelines de données <a class="header-anchor" href="#observabilite-de-nos-pipelines-de-donnees" aria-label="Permalink to &quot;Observabilité de nos pipelines de données&quot;">​</a></h3><p>Comme un <a href="https://fr.wikipedia.org/wiki/Panoptique" target="_blank" rel="noreferrer">panopticon</a> ou un <strong>hub d&#39;observabilité centralisé</strong>, nous utilisons principalement un canal MS Teams (accessible par toutes les parties prenantes) pour centraliser l&#39;observabilité de notre plateforme de données en un seul endroit. Certaines notifications personnalisées sont également envoyées via NTFY et Email pour des événements ou alertes spécifiques.</p><h3 id="observabilite-de-nos-donnees" tabindex="-1">Observabilité de nos données <a class="header-anchor" href="#observabilite-de-nos-donnees" aria-label="Permalink to &quot;Observabilité de nos données&quot;">​</a></h3><p>Pour l&#39;observabilité de nos données, nous utilisons les fonctionnalités intégrées de Dagster pour vérifier la qualité de nos données. Dagster fournit un ensemble de fonctionnalités d&#39;observabilité (personnalisées ou intégrées) qui nous permettent de surveiller la santé de nos pipelines de données et de détecter les problèmes rapidement.</p><p>Même sans écrire de vérifications personnalisées, l&#39;interface utilisateur de Dagster nous permet de surveiller la qualité de nos données. Voici comment nous avons trouvé un problème de qualité dans l&#39;un de nos pipelines de données :</p>',7)),a(n,{src:"https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/images/dagster_asset_quality.png",alt:"Comment la fonctionnalité d'observabilité nous a aidés à détecter des problèmes de qualité",width:"600"}),e[4]||(e[4]=s('<hr><p>Dans cet article, nous avons exploré comment automatiser le déploiement de pipelines de données dans une organisation polycéphale comme la FWB. Nous avons vu comment utiliser Dagster comme orchestrateur, dbt-core pour les transformations de données, et GitLab CI/CD pour automatiser le processus de déploiement.</p><p>Nous avons également discuté de l&#39;importance de la <strong>modularité</strong> et de la <strong>réutilisabilité</strong> des composants pour abaisser la barrière technique pour les analystes de données et les gestionnaires de données. En automatisant le processus de déploiement, nous pouvons nous assurer que chaque commit est testé et validé avant d&#39;être déployé en production, ce qui encourage la participation des analystes de données et des gestionnaires de données dans le développement de pipelines de données.</p><p>Mais comme indiqué dans l&#39;introduction, le <strong>niveau de participation est inversement proportionnel à la barrière technique</strong>. Plus la configuration est complexe, moins les analystes de données et les gestionnaires de données sont susceptibles de participer au développement de pipelines de données.</p><p>Dans le prochain article, nous explorerons comment abaisser encore davantage la barrière technique en fournissant des ressources conviviales pour que les professionnels des données interagissent avec la plateforme de données. Nous discuterons également de la façon d&#39;améliorer la littératie des données parmi les analystes de données et les gestionnaires de données pour les encourager à participer au développement de pipelines de données.</p><ul><li><a href="/blog/posts/2025/data_platform_in_fwb_02_lower_barrier-fr.html">Partie 3 : Comment les ressources personnalisées et la formation aident à abaisser la barrière</a></li></ul>',6))])}const F=o(p,[["render",i]]);export{B as __pageData,F as default};
