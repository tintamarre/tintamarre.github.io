import{_ as t,H as p,o as r,c,C as a,a as n,J as l,S as o}from"./chunks/framework.f141d1be.js";const h=JSON.parse('{"title":"Address lookup - Part 3 - API","description":"","frontmatter":{"date":"2025-05-01T00:00:00.000Z","title":"Address lookup - Part 3 - API","sidebar":false,"author":"Martin Erpicum","category":"Tutorial","tags":["data","api","orchestrator"],"blog":"post","aside":"left","prev":false,"next":false},"headers":[],"relativePath":"blog/posts/2025/address_lookup-part3-api.md"}'),i={name:"blog/posts/2025/address_lookup-part3-api.md"};function y(D,s,F,d,B,A){const e=p("ImageCenter");return r(),c("div",null,[s[0]||(s[0]=a("p",null,[a("em",null,"Executive summary"),n(": In Belgium, a collaborative effort between regional and federal authorities has led to the creation of a unified service that aggregates all Belgian addresses into a comprehensive dataset. This dataset is called "),a("a",{href:"https://bosa.belgium.be/fr/services/best-address-services",target:"_blank",rel:"noreferrer"},"BeStAddress"),n(".")],-1)),s[1]||(s[1]=a("hr",null,null,-1)),s[2]||(s[2]=a("h2",{id:"api-houte-si-true",tabindex:"-1"},[n("API Houte-Si-"),a("code",null,"True"),n(),a("a",{class:"header-anchor",href:"#api-houte-si-true","aria-label":'Permalink to "API Houte-Si-`True`"'},"​")],-1)),l(e,{src:"https://i.imgur.com/GJNQQJA.png",alt:"Houte Si True",width:"300"}),s[3]||(s[3]=o(`<h2 id="api-development-with-fastapi" tabindex="-1">API Development with FastAPI <a class="header-anchor" href="#api-development-with-fastapi" aria-label="Permalink to &quot;API Development with FastAPI&quot;">​</a></h2><p>The HouteSiTrue API was developed using <a href="https://fastapi.tiangolo.com/" target="_blank" rel="noreferrer">FastAPI</a>, a modern, fast web framework for building APIs with Python. The API serves as a bridge between our legacy GEOG system (or any other address system) and the <a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BestAddress reference dataset</a>, providing efficient address lookup and matching capabilities.</p><h3 id="core-components" tabindex="-1">Core Components <a class="header-anchor" href="#core-components" aria-label="Permalink to &quot;Core Components&quot;">​</a></h3><ol><li><strong>Router Structure</strong> The API is organized using FastAPI&#39;s router system, with the main address-related endpoints grouped under the <code>/addresses</code> prefix:</li></ol><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">router </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">APIRouter</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">prefix</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/addresses</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">tags</span><span style="color:#89DDFF;">=[</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">addresses</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">])</span></span></code></pre></div><ol start="2"><li><strong>Key Endpoints</strong></li></ol><ul><li><strong>Single Address Lookup</strong>: Retrieve address details by unique identifier</li><li><strong>Street Listings</strong>: Get streets by postcode or municipality</li><li><strong>Address Matching</strong>: Find the best match for given address components</li><li><strong>Batch Processing</strong>: Handle multiple address lookups in a single request</li><li><strong>Distance Calculations</strong>: Compute distances between geographical locations</li><li><strong>Similar Street Names</strong>: Find similar street names within a specified area</li></ul><h3 id="address-matching-logic" tabindex="-1">Address Matching Logic <a class="header-anchor" href="#address-matching-logic" aria-label="Permalink to &quot;Address Matching Logic&quot;">​</a></h3><p>The core functionality revolves around the address matching system, which uses both strict and fuzzy matching. The implementation combines FastAPI endpoints with sophisticated SQL queries for accurate address matching:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">class</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">AddressRequest</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">BaseModel</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#BABED8;">    postcode</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">str</span></span>
<span class="line"><span style="color:#BABED8;">    streetname</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">str</span></span>
<span class="line"><span style="color:#BABED8;">    house_number</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">str</span></span>
<span class="line"><span style="color:#BABED8;">    box_number</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> </span><span style="color:#FFCB6B;">str</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">router</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/bestmatch</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#BABED8;font-style:italic;">operation_id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">find_bestmatch_for_address</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#BABED8;"> </span><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">find_bestmatch_for_address</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">body</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> AddressRequest</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span><span style="color:#BABED8;font-style:italic;">request</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> Request</span><span style="color:#89DDFF;">):</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    Retrieve the best match for an address.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    - postcode: strict matching</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    - street_name: fuzzy matching</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    - house_number: strict matching</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    - box_number: strict matching</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    </span><span style="color:#89DDFF;font-style:italic;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#BABED8;">    results </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#BABED8;"> find_address</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">bestmatch</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">body</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> request</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#BABED8;"> results</span></span></code></pre></div><p>Under the hood, the bestmatch function utilizes a SQL query that implements fuzzy matching using Levenshtein distance and Jaro similarity scores:</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight has-focused-lines"><code><span class="line"><span style="color:#F78C6C;">SELECT</span></span>
<span class="line"><span style="color:#82AAFF;">count</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">*</span><span style="color:#BABED8;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#BABED8;"> addresses_count</span></span>
<span class="line"><span style="color:#BABED8;">, street_id</span></span>
<span class="line"><span style="color:#BABED8;">, municipality_id</span></span>
<span class="line"><span style="color:#BABED8;">, </span><span style="color:#82AAFF;">lower</span><span style="color:#BABED8;">(strip_accents(streetname_fr)) </span><span style="color:#F78C6C;">as</span><span style="color:#BABED8;"> streetname_fr_striped</span></span>
<span class="line"><span style="color:#BABED8;">, </span><span style="color:#82AAFF;">lower</span><span style="color:#BABED8;">(strip_accents(streetname_nl)) </span><span style="color:#F78C6C;">as</span><span style="color:#BABED8;"> streetname_nl_striped</span></span>
<span class="line"><span style="color:#BABED8;">, </span><span style="color:#82AAFF;">lower</span><span style="color:#BABED8;">(strip_accents(streetname_de)) </span><span style="color:#F78C6C;">as</span><span style="color:#BABED8;"> streetname_de_striped</span></span>
<span class="line"><span style="color:#BABED8;">, default_streetname</span></span>
<span class="line"><span style="color:#BABED8;">, </span><span style="color:#82AAFF;">greatest</span><span style="color:#BABED8;">(</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> (</span></span>
<span class="line has-focus"><span style="color:#BABED8;">    levenshtein(streetname_fr_striped, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{street_name}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">) </span><span style="color:#89DDFF;">/</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">greatest</span><span style="color:#BABED8;">(</span><span style="color:#F78C6C;">length</span><span style="color:#BABED8;">(streetname_fr_striped), </span><span style="color:#F78C6C;">length</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{street_name}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">))), </span></span>
<span class="line has-focus"><span style="color:#BABED8;">    </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> (levenshtein(streetname_nl_striped, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{street_name}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">) </span><span style="color:#89DDFF;">/</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">greatest</span><span style="color:#BABED8;">(</span><span style="color:#F78C6C;">length</span><span style="color:#BABED8;">(streetname_nl_striped), </span><span style="color:#F78C6C;">length</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{street_name}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">))), </span></span>
<span class="line has-focus"><span style="color:#BABED8;">    </span><span style="color:#F78C6C;">1</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">-</span><span style="color:#BABED8;"> (levenshtein(streetname_de_striped, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{street_name}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">) </span><span style="color:#89DDFF;">/</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">greatest</span><span style="color:#BABED8;">(</span><span style="color:#F78C6C;">length</span><span style="color:#BABED8;">(streetname_de_striped), </span><span style="color:#F78C6C;">length</span><span style="color:#BABED8;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{street_name}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">))) </span></span>
<span class="line has-focus"><span style="color:#BABED8;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#BABED8;"> best_levenshtein_score </span></span>
<span class="line"><span style="color:#BABED8;">, </span><span style="color:#82AAFF;">greatest</span><span style="color:#BABED8;">(</span></span>
<span class="line"><span style="color:#BABED8;">    jaro_similarity(streetname_fr_striped, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{street_name}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">),</span></span>
<span class="line"><span style="color:#BABED8;">    jaro_similarity(streetname_nl_striped, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{street_name}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">),</span></span>
<span class="line"><span style="color:#BABED8;">    jaro_similarity(streetname_de_striped, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{street_name}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#BABED8;">)</span></span>
<span class="line"><span style="color:#BABED8;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#BABED8;"> best_jaro_score</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#BABED8;"> bestAddress</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#F78C6C;">AND</span><span style="color:#BABED8;"> postcode </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{postcode}</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line has-focus"><span style="color:#BABED8;">    </span><span style="color:#F78C6C;">AND</span><span style="color:#BABED8;"> best_jaro_score </span><span style="color:#89DDFF;">&gt;</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">0</span><span style="color:#BABED8;">.</span><span style="color:#F78C6C;">6</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#BABED8;"> ALL</span></span>
<span class="line has-focus"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#BABED8;"> best_levenshtein_score </span><span style="color:#F78C6C;">DESC</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#F78C6C;">LIMIT</span><span style="color:#BABED8;"> </span><span style="color:#F78C6C;">3</span><span style="color:#BABED8;">;</span></span></code></pre></div><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">is_perfect_match</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> is_perfect_match</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">is_partial_match</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> is_partial_match</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">street_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> addresses</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">][</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">street_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">municipality_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> addresses</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">][</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">municipality_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">address_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> addresses</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">][</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">address_id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">levenshtein_score</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> results</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">][</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">best_levenshtein_score</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#BABED8;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">matches</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> addresses</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>This query performs several key operations:</p><ol><li>Strips accents and normalizes street names in all three national languages (French, Dutch, and German)</li><li>Calculates Levenshtein distance scores for each language version</li><li>Computes Jaro similarity scores as a secondary matching metric</li><li>Filters results based on a minimum similarity threshold</li><li>The SQL returns the top 3 matches ordered by Levenshtein score</li><li>The Python code returns the best match and the matches found by the SQL query</li></ol><h3 id="application-configuration" tabindex="-1">Application Configuration <a class="header-anchor" href="#application-configuration" aria-label="Permalink to &quot;Application Configuration&quot;">​</a></h3><p>The API is built with scalability and maintainability in mind:</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">get_application</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#BABED8;"> FastAPI</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#BABED8;">    application </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">FastAPI</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#BABED8;font-style:italic;">title</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">metadata</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">app_name</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#BABED8;font-style:italic;">description</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">metadata</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">base_description</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#BABED8;font-style:italic;">version</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">os</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getenv</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">CI_COMMIT_SHORT_SHA</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">N/A</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#BABED8;font-style:italic;">openapi_tags</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">metadata</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">tags_metadata</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#BABED8;font-style:italic;">contact</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">metadata</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">contact</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#BABED8;font-style:italic;">deployement</span><span style="color:#89DDFF;">=</span><span style="color:#82AAFF;">metadata</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">deployement</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#89DDFF;">)</span></span></code></pre></div><h3 id="model-context-protocol-mcp" tabindex="-1">Model-Context-Protocol (MCP) <a class="header-anchor" href="#model-context-protocol-mcp" aria-label="Permalink to &quot;Model-Context-Protocol (MCP)&quot;">​</a></h3><p>We implemented a Model-Context-Protocol (MCP) pattern using <code>FastApiMCP</code>, to be able to call the API from LLM with tools capabilities.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#BABED8;">mcp </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">FastApiMCP</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">app</span><span style="color:#89DDFF;">)</span></span></code></pre></div><h3 id="performance-considerations" tabindex="-1">Performance Considerations <a class="header-anchor" href="#performance-considerations" aria-label="Permalink to &quot;Performance Considerations&quot;">​</a></h3><p>The API includes performance monitoring features:</p><ul><li>Execution time tracking for each request</li><li>Batch processing capabilities (up to 25 addresses per request)</li><li>Efficient distance calculations using the <code>geopy</code> library (spacial library from DuckDB could also be used)</li></ul>`,24)),l(e,{src:"https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/images/bestMatch.gif",alt:"Performance checks",width:"600"}),s[4]||(s[4]=o('<h3 id="error-handling-and-validation" tabindex="-1">Error Handling and Validation <a class="header-anchor" href="#error-handling-and-validation" aria-label="Permalink to &quot;Error Handling and Validation&quot;">​</a></h3><p>The API implements robust error handling and input validation:</p><ul><li>Input validation through Pydantic models</li><li>Batch size limitations</li><li>Proper error responses for invalid requests</li></ul><h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">​</a></h2><p>The HouteSiTrue API provides a robust and efficient solution for address matching and validation in Belgium. By combining strict and fuzzy matching techniques with a well-structured API design, we&#39;ve created a reliable service that bridges the gap between legacy systems and modern address data requirements.</p><p>This API was used to match addresses from our legacy GEOG system with the BestAddress reference dataset. For that we used the <code>bestmatch</code> endpoint in combination with an orchestrator (Dagster).</p>',6)),l(e,{src:"https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/images/run_pipeline_bestaddress.png",alt:"Dagster bestmatch",width:"600"})])}const m=t(i,[["render",y]]);export{h as __pageData,m as default};
