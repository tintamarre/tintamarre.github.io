import{_ as t,H as n,o as l,c as r,S as o,J as e}from"./chunks/framework.f141d1be.js";const h=JSON.parse('{"title":"Data Platform - Part 3: Lower the barrier üöß","description":"","frontmatter":{"date":"2025-04-03T00:00:00.000Z","title":"Data Platform - Part 3: Lower the barrier üöß","sidebar":false,"author":"Martin Erpicum","category":"Article","tags":["data","orchestrator"],"blog":"post","aside":"left","prev":false,"next":false},"headers":[],"relativePath":"blog/posts/2025/data_platform_in_fwb_02_lower_barrier.md"}'),p={name:"blog/posts/2025/data_platform_in_fwb_02_lower_barrier.md"};function c(i,s,d,y,u,D){const a=n("ImageCenter");return l(),r("div",null,[s[0]||(s[0]=o('<p><em>Executive summary</em>: In a polycephalous organization, Data Governance is a complex challenge. This article explores the implementation of a Data Platform based on <a href="https://dagster.io/" target="_blank" rel="noreferrer">Dagster</a> for the <a href="https://www.federation-wallonie-bruxelles.be" target="_blank" rel="noreferrer">F√©d√©ration Wallonie-Bruxelles (FWB)</a>. It highlights the importance of automation, modularity, and component reusability to lower the technical barrier and improve data literacy among data analysts and data stewards.</p><hr><p><em>The views expressed on this website are my own and do not necessarily reflect the views of my employer.</em></p><p><strong>Table of contents</strong></p><nav class="table-of-contents"><ul><li><a href="#üßë‚Äçüíª-code-reusability">üßë‚Äçüíª Code reusability</a><ul><li><a href="#implement-common-library-dagster-cfwb-corresponding-to-our-specific-need">Implement common library dagster-cfwb corresponding to our specific need</a></li></ul></li><li><a href="#üìñ-level-up-the-data-literacy">üìñ Level up the data literacy</a></li></ul></nav><p>After the first two articles in this series, which focused on the <a href="/blog/posts/2025/data_platform_in_fwb_00_intro.html">architecture of our data platform</a> and the <a href="/blog/posts/2025/data_platform_in_fwb_01_automate.html">automation of our data pipelines</a>, this article will discuss how we lower the technical barrier for our users and improve their data literacy.</p><p>There are two main aspects to this:</p><ul><li><strong>Reduce the complexity</strong> of our data platform by providing common resources and components that can be reused by all data analysts and data stewards.</li><li><strong>Level up the data literacy</strong> of our users by training them, writing documentation, accompanying them in their first steps, and providing them with the necessary tools to understand and use the data platform.</li></ul><h2 id="üßë‚Äçüíª-code-reusability" tabindex="-1">üßë‚Äçüíª Code reusability <a class="header-anchor" href="#üßë‚Äçüíª-code-reusability" aria-label="Permalink to &quot;üßë‚Äçüíª Code reusability&quot;">‚Äã</a></h2><p>Without any surprise, <strong>Dagster</strong> provide two main concepts to help code reusability: <strong>resources</strong> and <strong>components</strong>.</p><ul><li><strong>Resources</strong> are used to connect to external systems (databases, APIs, etc.)</li><li><strong>Components</strong> (still kind of new) are used to define reusable pieces of code with <code>YAML</code> that can be used in multiple jobs or pipelines.</li></ul><p>The two concepts are closely related, as resources are often used in components to connect to external systems.</p><p>Since our Data Platform leverage multipls code locations, and that we want to facilitate the onboarding of new data engineers, we need to build a common python library that contains all the resources, components and customs libs (utils) that we need to connect to our data sources. We called this library <code>dagster-cfwb</code>.</p><h3 id="implement-common-library-dagster-cfwb-corresponding-to-our-specific-need" tabindex="-1">Implement common library <code>dagster-cfwb</code> corresponding to our specific need <a class="header-anchor" href="#implement-common-library-dagster-cfwb-corresponding-to-our-specific-need" aria-label="Permalink to &quot;Implement common library `dagster-cfwb` corresponding to our specific need&quot;">‚Äã</a></h3>',14)),e(a,{src:"https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/dagster_cfwb.drawio.png",alt:"",width:"400"}),s[1]||(s[1]=o(`<p>Our <strong>dagster-cfwb package</strong> contains all the Dagster resources that we need to connect to our data sources. This library is used by most of jobs and pipelines in our data platform. It includes resources for connecting to various databases (postgresql, mssql, mysql, db2, ...), APIs (denodo, custom api, oauth2, ...), and other data sources (lakehouse, ftp, nfs ...). It also includes custom components that can be used to perform common tasks, such as importing data from Denodo, storing to the data lakehouse and reporting metadata.</p><p>This library is also extensively documented (directly visible in the Dagster UI) and tested with unit/integration tests during our Gitlab CI/CD pipeline.</p><p>To illustrate this, let&#39;s take a look at the <code>AzureAdlsResource</code> and <code>PostgreSQLResource</code> resources that we implemented in the <code>dagster-cfwb</code> library. These resources are used to connect to an Azure Data Lake Storage (ADLS) and a PostgreSQL database, respectively.</p><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki material-theme-palenight has-focused-lines"><code><span class="line has-focus"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> dagster_cfwb</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">resources</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">lakehouse</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">azure_adls_resource </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> AzureAdlsResource </span></span>
<span class="line has-focus"><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#BABED8;"> dagster_cfwb</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">resources</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">db</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">postgresql_resource </span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#BABED8;"> PostgreSQLResource </span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#89DDFF;">@</span><span style="color:#82AAFF;">asset</span><span style="color:#89DDFF;">()</span><span style="color:#BABED8;"> </span></span>
<span class="line has-focus"><span style="color:#C792EA;">def</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">gld_example</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;"> </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#BABED8;font-style:italic;">context</span><span style="color:#89DDFF;">,</span></span>
<span class="line has-focus"><span style="color:#BABED8;">    </span><span style="color:#BABED8;font-style:italic;">azure_adls</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> AzureAdlsResource</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> </span></span>
<span class="line has-focus"><span style="color:#BABED8;">    </span><span style="color:#BABED8;font-style:italic;">postgresql</span><span style="color:#89DDFF;">:</span><span style="color:#BABED8;"> PostgreSQLResource </span></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;">):</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#BABED8;">    df </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> azure_adls</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query_blob_storage</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">FROM &#39;azure://code_location/stg/example.parquet&#39;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color:#BABED8;">    postgresql</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">copy_from_df</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">df</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">example</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#BABED8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#BABED8;"> </span><span style="color:#82AAFF;">MaterializeResult</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#BABED8;font-style:italic;">metadata</span><span style="color:#89DDFF;">={</span></span>
<span class="line"><span style="color:#82AAFF;">            </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dagster/row_count</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> df</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">shape</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#82AAFF;">            </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">num_columns</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> df</span><span style="color:#89DDFF;">.</span><span style="color:#F07178;">shape</span><span style="color:#89DDFF;">[</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">],</span></span>
<span class="line"><span style="color:#82AAFF;">            </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dashboard_url</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> MetadataValue</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">url</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">                </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://vizu.intranet.fwb.be/example_dashboard</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#82AAFF;">            </span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#82AAFF;">            </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">documentation_url</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#82AAFF;"> MetadataValue</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">url</span><span style="color:#89DDFF;">(</span></span>
<span class="line"><span style="color:#82AAFF;">                </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">https://docs.intranet.fwb.be/example_documentation</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#82AAFF;">            </span><span style="color:#89DDFF;">),</span></span>
<span class="line"><span style="color:#82AAFF;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#82AAFF;">    </span><span style="color:#89DDFF;">)</span></span></code></pre></div><p>As you can see, the <code>AzureAdlsResource</code> and <code>PostgreSQLResource</code> resources are used to connect to the Azure Data Lake Storage and PostgreSQL database, respectively. The <code>gld_example</code> asset uses these resources to query data from the Azure Data Lake Storage and copy it to the PostgreSQL database. All the logic is encapsulated in the <code>dagster-cfwb</code> library, which makes it very easy to reuse this code.</p><h2 id="üìñ-level-up-the-data-literacy" tabindex="-1">üìñ Level up the data literacy <a class="header-anchor" href="#üìñ-level-up-the-data-literacy" aria-label="Permalink to &quot;üìñ Level up the data literacy&quot;">‚Äã</a></h2><ul><li>Train the data engineers and stewards</li><li>Write documentation as much as possible</li><li>document everything</li><li>training</li></ul>`,7)),e(a,{src:"https://i.imgur.com/GtduQZ6.png",alt:"Dagster UI",width:"400"}),e(a,{src:"https://i.imgur.com/bEy2kU2.png",alt:"Dagster UI",width:"400"}),e(a,{src:"https://i.imgur.com/zwhAa9D.png",alt:"Dagster UI",width:"400"})])}const m=t(p,[["render",c]]);export{h as __pageData,m as default};
