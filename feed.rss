<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title></title>
        <link>localhost/blog</link>
        <description>Some thoughts</description>
        <lastBuildDate>Fri, 04 Jul 2025 10:17:24 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en</language>
        <item>
            <title><![CDATA[Data Platform - Part 2: Automate everything ü§ñ]]></title>
            <link>localhost/blog/blog/posts/2025/data_platform_in_fwb_01_automate.html</link>
            <guid>localhost/blog/blog/posts/2025/data_platform_in_fwb_01_automate.html</guid>
            <pubDate>Fri, 04 Jul 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[<p><em>Executive summary</em>: In a polycephalous organization, Data Governance is a complex challenge. This article explores the implementation of a Data Platform based on <a href="https://dagster.io/" target="_blank" rel="noreferrer">Dagster</a> for the <a href="https://www.federation-wallonie-bruxelles.be" target="_blank" rel="noreferrer">F√©d√©ration Wallonie-Bruxelles (FWB)</a>. It highlights the importance of automation, modularity, and component reusability to lower the technical barrier and improve data literacy among data analysts and data stewards.</p>
]]></description>
            <content:encoded><![CDATA[<p><em>Executive summary</em>: In a polycephalous organization, Data Governance is a complex challenge. This article explores the implementation of a Data Platform based on <a href="https://dagster.io/" target="_blank" rel="noreferrer">Dagster</a> for the <a href="https://www.federation-wallonie-bruxelles.be" target="_blank" rel="noreferrer">F√©d√©ration Wallonie-Bruxelles (FWB)</a>. It highlights the importance of automation, modularity, and component reusability to lower the technical barrier and improve data literacy among data analysts and data stewards.</p>
<hr>
<p><em>The views expressed on this website are my own and do not necessarily reflect the views of my employer.</em></p>
<p><strong>Table of contents</strong></p>
<nav class="table-of-contents"><ul><li><a href="#üèóÔ∏è-technical-architecture-of-our-data-platform">üèóÔ∏è Technical Architecture of our Data Platform</a><ul><li><a href="#code-locations-structure">Code locations structure</a></li></ul></li><li><a href="#ü§ñ-automate-ci-cd">ü§ñ Automate CI/CD</a><ul><li><a href="#ci-cd-flow">CI/CD flow</a></li><li><a href="#our-deployment-setup">Our deployment setup</a></li><li><a href="#automate-integration-of-dbt">Automate integration of DBT</a></li></ul></li><li><a href="#üëÄ-automate-observability">üëÄ Automate observability</a></li><li><a href="#üìù-conclusion">üìù Conclusion</a></li></ul></nav>
<p>If you want to encourage data analysts and data stewards to participate in the development of data pipelines, you need to ensure every commit is tested and validated before being deployed to production. You also want to automate repetitive tasks to reduce the technical barrier as much as possible. In addition, you want to setup a solid observability system to monitor the health of your systems and data pipelines and detect issues early.</p>
<p>To explain how we automate the deployment of data pipelines, I will first describe the architecture of our data platform.</p>
<h2 id="üèóÔ∏è-technical-architecture-of-our-data-platform" tabindex="-1">üèóÔ∏è Technical Architecture of our Data Platform <a class="header-anchor" href="#üèóÔ∏è-technical-architecture-of-our-data-platform" aria-label="Permalink to &quot;üèóÔ∏è Technical Architecture of our Data Platform&quot;">&ZeroWidthSpace;</a></h2>
<p>Our stack is currently based on the following components:</p>
<ul>
<li><strong>Dagster</strong>: The orchestrator of our data pipelines. It allows us to define, schedule, and monitor our data workflows.</li>
<li><strong>dbt-core</strong>: The data transformation tool that allows us to define our data models and transformations in a modular way. It is used to build the data models and transformations that are executed by Dagster.</li>
<li><strong>DuckDB</strong>: The SQL engine that allows us to run SQL queries on our data. It is used for local development and testing of our data pipelines.</li>
<li><strong>Azure</strong>: The cloud provider that hosts our data platform. We use Azure Data Lake Storage (ADLS) for data storage.</li>
<li><strong>Docker</strong>: The containerization technology that allows us to package our data pipelines and their dependencies in a portable way.</li>
<li><strong>GitLab</strong>: The version control system that allows us to manage our code repositories and automate our CI/CD pipelines.</li>
</ul>
<ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/fwb_tech_stack.drawio.png" alt="" width="600" /><ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/data_platform.drawio.png" alt="" width="600" /><p>One important side note here: our technical choices are not set in stone. We are constantly evaluating new technologies and approaches to improve our data platform. The goal is to provide a flexible and scalable architecture that can adapt to the changing needs of the organization. If <code>dbt-core</code>, <code>Dagster</code>, or any other tool/provider does not fit our needs anymore, we will not hesitate to change it. What we are really binding ourselves to is the (1) <strong>architecture</strong>, and the (2) <strong>languages</strong> we use to implement it (Python, SQL). The tools and providers are just means to an end.</p>
<p>For excellent recommendations on how to build a solid data platform, I recommend reading <a href="https://www.oreilly.com/library/view/fundamentals-of-data/9781098108298/" target="_blank" rel="noreferrer">Fundamentals of Data Engineering</a> by Joe Reis and Matt Housley.</p>
<h3 id="code-locations-structure" tabindex="-1">Code locations structure <a class="header-anchor" href="#code-locations-structure" aria-label="Permalink to &quot;Code locations structure&quot;">&ZeroWidthSpace;</a></h3>
<p>To allow each administration g√©n√©rale (AG) to own its repository (a <strong>code location</strong> in Dagster vocabulary)‚Äîwhich contains the Dagster code location for the data pipelines of that AG‚Äîwe decided to <strong>mirror the organizational structure of the FWB into the architecture of our data platform</strong>. We also use distinct code locations for specific projects that are not tied to a specific AG.
This allows each AG to manage its own data pipelines independently and have clear ownership of the code. The code locations are then aggregated into a single Dagster instance, which is the data platform.</p>
<h4 id="üóÇÔ∏è-structure-of-our-code-locations-folder" tabindex="-1">üóÇÔ∏è Structure of our code locations folder <a class="header-anchor" href="#üóÇÔ∏è-structure-of-our-code-locations-folder" aria-label="Permalink to &quot;üóÇÔ∏è Structure of our code locations folder&quot;">&ZeroWidthSpace;</a></h4>
<div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #FFCB6B">dagster_home</span><span style="color: #BABED8"> (main) $ tree -L 1</span></span>
<span class="line"><span style="color: #82AAFF">.</span></span>
<span class="line"><span style="color: #FFCB6B">‚îú‚îÄ‚îÄ</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">ags_project</span></span>
<span class="line"><span style="color: #FFCB6B">‚îú‚îÄ‚îÄ</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">agaj_project</span></span>
<span class="line"><span style="color: #82AAFF">...</span></span>
<span class="line"><span style="color: #FFCB6B">‚îú‚îÄ‚îÄ</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">data_platform</span><span style="color: #BABED8"> </span><span style="color: #676E95; font-style: italic"># our generic code location</span></span>
<span class="line"><span style="color: #FFCB6B">‚îú‚îÄ‚îÄ</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">dagster.yaml</span></span>
<span class="line"><span style="color: #FFCB6B">‚îî‚îÄ‚îÄ</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">workspace.yaml</span></span></code></pre>
</div><h2 id="ü§ñ-automate-ci-cd" tabindex="-1">ü§ñ Automate CI/CD <a class="header-anchor" href="#ü§ñ-automate-ci-cd" aria-label="Permalink to &quot;ü§ñ Automate CI/CD&quot;">&ZeroWidthSpace;</a></h2>
<h3 id="ci-cd-flow" tabindex="-1">CI/CD flow <a class="header-anchor" href="#ci-cd-flow" aria-label="Permalink to &quot;CI/CD flow&quot;">&ZeroWidthSpace;</a></h3>
<p>Our deployment setup is based on GitLab CI/CD pipelines. The flow is as follows:</p>
<ol start="0">
<li><strong>Submodules integration</strong>: DBT projects are integrated as a Git submodule in the main repository. This allows us to include the work of data stewards and analysts in the data platform without having to duplicate code or maintain separate repositories.</li>
<li><strong>Build</strong>: The code is built and packaged into a Docker image; the same image is used for Webserver, Daemon, and Code locations.</li>
<li><strong>Validate definitions</strong>: The Dagster definitions are validated to ensure they are correct and do not contain any errors.</li>
<li><strong>Ruff</strong>: The code is checked for style and formatting issues using <a href="https://docs.astral.sh/ruff/" target="_blank" rel="noreferrer">Ruff</a>.</li>
<li><strong>Sonar</strong>: The code is analyzed for quality and security issues using <a href="https://www.sonarqube.org/" target="_blank" rel="noreferrer">SonarQube</a>.</li>
<li><strong>Test</strong>: The code is tested using <a href="https://docs.pytest.org/en/stable/" target="_blank" rel="noreferrer">pytest</a> for unit tests, integration tests, and coverage analysis.</li>
<li><strong>Deploy to DEV</strong>: The code is deployed to the development environment for each commit in the main branch or feature branch.</li>
<li><strong>Release</strong>: A new release is created in GitLab, a tag and a changelog are generated.</li>
<li><strong>Deploy to PROD</strong>: The code is deployed to the production environment.</li>
</ol>
<ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/dagster_flow_stack.drawio.png" alt="" width="800" /><p>Below is an example of how we implement this flow in our <code>.gitlab-ci.yml</code> file.</p>
<h4 id="validate-definitions" tabindex="-1">Validate definitions <a class="header-anchor" href="#validate-definitions" aria-label="Permalink to &quot;Validate definitions&quot;">&ZeroWidthSpace;</a></h4>
<div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre v-pre class="shiki material-theme-palenight has-focused-lines" ><code><span class="line"><span style="color: #676E95; font-style: italic"># .gitlab-ci.yml</span></span>
<span class="line"><span style="color: #89DDFF">[</span><span style="color: #F78C6C">...</span><span style="color: #89DDFF">]</span></span>
<span class="line has-focus"><span style="color: #F07178">validate_definitions</span><span style="color: #89DDFF">:</span><span style="color: #BABED8">  </span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">stage</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">analyse</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">allow_failure</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FF9CAC">false</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">needs</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">build</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">image</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">gitlab.*/*/dagster:latest</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">script</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">cd /opt/dagster/dagster_home</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">rm dagster.yaml</span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">dagster definitions validate -d code_location_1 -m code_location_1</span><span style="color: #BABED8"> </span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">dagster definitions validate -d code_location_2 -m code_location_2</span><span style="color: #BABED8"> </span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">...</span></span></code></pre>
</div><h4 id="sonar" tabindex="-1">Sonar <a class="header-anchor" href="#sonar" aria-label="Permalink to &quot;Sonar&quot;">&ZeroWidthSpace;</a></h4>
<div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre v-pre class="shiki material-theme-palenight has-focused-lines" ><code><span class="line"><span style="color: #676E95; font-style: italic"># .gitlab-ci.yml</span></span>
<span class="line"><span style="color: #89DDFF">[</span><span style="color: #F78C6C">...</span><span style="color: #89DDFF">]</span></span>
<span class="line has-focus"><span style="color: #F07178">sonarqube</span><span style="color: #89DDFF">:</span><span style="color: #BABED8">  </span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">script</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">SONAR_SCANNER_OPTS=&quot;${SONAR_SCANNER_OPTS} -Dsonar.exclusions=**/dbt_packages/**,**/dbt-*/**/*.sql,**/dbt-*/**/*.py&quot;</span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">sonar-scanner</span><span style="color: #BABED8"> </span></span>
<span class="line"><span style="color: #89DDFF">[</span><span style="color: #F78C6C">...</span><span style="color: #89DDFF">]</span></span></code></pre>
</div><h4 id="pytest-and-coverage-analysis" tabindex="-1">Pytest and coverage analysis <a class="header-anchor" href="#pytest-and-coverage-analysis" aria-label="Permalink to &quot;Pytest and coverage analysis&quot;">&ZeroWidthSpace;</a></h4>
<div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre v-pre class="shiki material-theme-palenight has-focused-lines" ><code><span class="line"><span style="color: #676E95; font-style: italic"># .gitlab-ci.yml</span></span>
<span class="line"><span style="color: #89DDFF">[</span><span style="color: #F78C6C">...</span><span style="color: #89DDFF">]</span></span>
<span class="line has-focus"><span style="color: #F07178">test</span><span style="color: #89DDFF">:</span><span style="color: #BABED8">  </span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">stage</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">test</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">script</span><span style="color: #89DDFF">:</span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">uv run coverage run -m pytest --tb=no</span><span style="color: #BABED8"> </span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">uv run coverage xml -o coverage-reports/coverage.xml</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">uv run coverage report -m</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">coverage</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">/TOTAL</span><span style="color: #BABED8">\\</span><span style="color: #C3E88D">s+.*?([0-9]{1,3})%/</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #89DDFF">[</span><span style="color: #F78C6C">...</span><span style="color: #89DDFF">]</span></span></code></pre>
</div><h3 id="our-deployment-setup" tabindex="-1">Our deployment setup <a class="header-anchor" href="#our-deployment-setup" aria-label="Permalink to &quot;Our deployment setup&quot;">&ZeroWidthSpace;</a></h3>
<p>Once deployed, the data platform is composed of the following containerized components:</p>
<ul>
<li>A <strong>PostgreSQL</strong> database to store the Dagster data.</li>
<li>A <strong>webserver</strong> to provide the UI and API for the data platform.</li>
<li>A <strong>daemon</strong> to monitor the code and communicate with the code locations and the webserver.</li>
<li>And a <strong>code location</strong> for each AG or specific project.</li>
</ul>
<ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/dagster_stack.drawio.png" alt="" width="800" /><h3 id="automate-integration-of-dbt" tabindex="-1">Automate integration of DBT <a class="header-anchor" href="#automate-integration-of-dbt" aria-label="Permalink to &quot;Automate integration of DBT&quot;">&ZeroWidthSpace;</a></h3>
<p>We created a <strong>specific release cycle</strong> for our DBT projects. This allows us to include the work of data stewards and analysts in the data platform while giving them full autonomy to develop their data models, transformations, and quality monitoring. The DBT projects are integrated as <strong>Git submodules</strong> in the main repository of the data platform.</p>
<ImageCenter src="https://raw.githubusercontent.com/data-cfwb/charte-graphique/refs/heads/main/custom_css/data_dbt.png" alt="" width="300" /><p>For each commit in the main branch of the DBT project, models are analyzed by sqlfluff, and a GitLab page is published with the documentation of the DBT project that includes the data models, the tests, and the documentation of the data models. This allows us to have a clear overview of the data models and their dependencies and allows analysts to share this documentation with their colleagues.</p>
<p>When a new release is created, the DBT project is automatically versioned using the <code>release</code> tool. The version is bumped and a changelog is generated. The DBT project is then parsed using <code>dbt parse</code> to produce the <code>manifest.json</code> file, which contains the metadata of the DBT project. This file is used by Dagster to discover the DBT models and their dependencies.</p>
<h4 id="the-release-cycle-of-our-dbt-projects-consists-of-the-following-steps" tabindex="-1">The release cycle of our DBT projects consists of the following steps: <a class="header-anchor" href="#the-release-cycle-of-our-dbt-projects-consists-of-the-following-steps" aria-label="Permalink to &quot;The release cycle of our DBT projects consists of the following steps:&quot;">&ZeroWidthSpace;</a></h4>
<div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre v-pre class="shiki material-theme-palenight has-focused-lines has-diff" ><code><span class="line"><span style="color: #676E95; font-style: italic"># .gitlab-ci.yml</span></span>
<span class="line has-focus"><span style="color: #F07178">sqlfluff</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">allow_failure</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FF9CAC">true</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">script</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">sqlfluff lint models</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color: #F07178">release</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">script</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">VERSION=$(release next-version)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #89DDFF; font-style: italic">|</span></span>
<span class="line"><span style="color: #C3E88D">      sed -i &quot;s/version: \&quot;[^\&quot;]*\&quot;/version: \&quot;$VERSION\&quot;/&quot; &quot;$FILETOCHANGE&quot;</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">release changelog</span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">release commit-and-tag --create-tag-pipeline CHANGELOG.md ${DBT_PATH}/dbt_project.yml</span><span style="color: #BABED8"> </span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color: #F07178">dagster_submodule</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">rules</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #F07178">if</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">$CI_COMMIT_TAG</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">script</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">...</span><span style="color: #89DDFF">]</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">git add .</span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">git diff --cached --quiet || git commit -m &quot;Update dbt submodule&quot;</span><span style="color: #BABED8">  </span></span>
<span class="line"><span style="color: #89DDFF">    </span><span style="color: #676E95; font-style: italic"># Push changes without forcing deletion</span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">git push origin dagster_submodule</span><span style="color: #BABED8"> </span></span>
<span class="line"></span>
<span class="line"><span style="color: #676E95; font-style: italic"># This step publishes an artifact for DBT docs.</span></span>
<span class="line has-focus"><span style="color: #F07178">pages</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">stage</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">dbt_docs</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">only</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">main</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F07178">script</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">...</span><span style="color: #89DDFF">]</span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> </span><span style="color: #C3E88D">dbt docs generate</span><span style="color: #BABED8"> </span></span></code></pre>
</div><h2 id="üëÄ-automate-observability" tabindex="-1">üëÄ Automate observability <a class="header-anchor" href="#üëÄ-automate-observability" aria-label="Permalink to &quot;üëÄ Automate observability&quot;">&ZeroWidthSpace;</a></h2>
<p>The observability of our data platform is a key aspect of the implementation of a Data Platform. It allows us to monitor the health of our systems and data pipelines, to detect issues early, and ensure the quality of our data.</p>
<ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/images/ms-team-panopticon.png" alt="" width="600" /><p>Like a <a href="https://en.wikipedia.org/wiki/Panopticon" target="_blank" rel="noreferrer">panopticon</a> or a <strong>centralized observability hub</strong>, we use mainly MS Teams channel (accessible by all stakeholders) to centralize the observability of our data platform in a single place. Some custom notifications are also sent through NTFY and Email for specific events or alerts.</p>
<p>For the observability of our systems, we use <a href="https://www.elastic.co/kibana" target="_blank" rel="noreferrer">Kibana</a> and <a href="https://dozzle.dev/" target="_blank" rel="noreferrer">Dozzle</a> to monitor the logs and metrics of our data platform.</p>
<h2 id="üìù-conclusion" tabindex="-1">üìù Conclusion <a class="header-anchor" href="#üìù-conclusion" aria-label="Permalink to &quot;üìù Conclusion&quot;">&ZeroWidthSpace;</a></h2>
<p>In this article, we have explored how to automate the deployment of data pipelines in a polycephalous organization like the FWB. We have seen how to use Dagster as an orchestrator, dbt-core for data transformations, and GitLab CI/CD for automating the deployment process.</p>
<p>We have also discussed the importance of modularity and reusability of components to lower the technical barrier for data analysts and data stewards. By automating the deployment process, we can ensure that every commit is tested and validated before being deployed to production, which encourages participation from data analysts and data stewards in the development of data pipelines.</p>
<p>But as stated in the introduction, the <strong>level of participation is inversely proportional to the technical barrier</strong>. The more complex the setup, the less likely data analysts and data stewards will participate in the development of data pipelines.</p>
<p>In the next article, we will explore how to lower the technical barrier even further by providing a user-friendly interface for data analysts and data stewards to interact with the data platform. We will also discuss how to improve data literacy among data analysts and data stewards to encourage them to participate in the development of data pipelines.</p>
<ul>
<li><a href="/blog/posts/2025/data_platform_in_fwb_02_lower_barrier.html">Part 3: How custom resources and training help lower the barrier</a></li>
</ul>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Data Platform in a polycephalous organization - Part 1: Overview üéØ]]></title>
            <link>localhost/blog/blog/posts/2025/data_platform_in_fwb_00_intro.html</link>
            <guid>localhost/blog/blog/posts/2025/data_platform_in_fwb_00_intro.html</guid>
            <pubDate>Wed, 02 Jul 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[<p><em>Executive summary</em>: In a polycephalous organization, Data Governance is a complex challenge. This article explores the implementation of a Data Platform based on <a href="https://dagster.io/" target="_blank" rel="noreferrer">Dagster</a> for the <a href="https://www.federation-wallonie-bruxelles.be" target="_blank" rel="noreferrer">F√©d√©ration Wallonie-Bruxelles (FWB)</a>. It highlights the importance of automation, modularity, and component reusability to lower the technical barrier and improve data literacy among data analysts and data stewards.</p>
]]></description>
            <content:encoded><![CDATA[<p><em>Executive summary</em>: In a polycephalous organization, Data Governance is a complex challenge. This article explores the implementation of a Data Platform based on <a href="https://dagster.io/" target="_blank" rel="noreferrer">Dagster</a> for the <a href="https://www.federation-wallonie-bruxelles.be" target="_blank" rel="noreferrer">F√©d√©ration Wallonie-Bruxelles (FWB)</a>. It highlights the importance of automation, modularity, and component reusability to lower the technical barrier and improve data literacy among data analysts and data stewards.</p>
<hr>
<p><em>The views expressed on this website are my own and do not necessarily reflect the views of my employer.</em></p>
<p><strong>Table of contents</strong></p>
<nav class="table-of-contents"><ul><li><a href="#üèõÔ∏è-background">üèõÔ∏è Background</a></li><li><a href="#üéØ-what-is-our-data-strategy">üéØ What is our data strategy?</a></li><li><a href="#üì¶-where-are-the-data">üì¶ Where are the data?</a></li><li><a href="#üèóÔ∏è-conceptual-architecture-of-a-data-stack">üèóÔ∏è Conceptual architecture of a data stack</a></li><li><a href="#ü§ñ-automate-everything-or-almost-facilitate-the-onboarding">ü§ñ Automate everything (or almost) : facilitate the onboarding</a></li><li><a href="#üìö-data-literacy-lower-the-barrier-and-give-power-to-the-users">üìö Data Literacy : Lower the barrier and give power to the users</a></li><li><a href="#üìù-next-articles">üìù Next articles</a></li></ul></nav>
<h2 id="üèõÔ∏è-background" tabindex="-1">üèõÔ∏è Background <a class="header-anchor" href="#üèõÔ∏è-background" aria-label="Permalink to &quot;üèõÔ∏è Background&quot;">&ZeroWidthSpace;</a></h2>
<p>The French Community of Belgium (or F√©d√©ration Wallonie-Bruxelles, FWB) refers to one of the three constituent constitutional linguistic communities in Belgium.</p>
<p>The French Community of Belgium includes <em>~4.5 million</em> people and its administration is responsible for the management of education, culture, sports, youth care, international relation, etc. for the French-speaking population of the country. The administration itself employs more than <em>7 000</em> people but the number of employees in the public sector that directly depend on the FWB is much much larger mainly due to the education and child care sectors.</p>
<ImageCenter src="https://raw.githubusercontent.com/data-cfwb/charte-graphique/refs/heads/main/logo_FWB_PNG_et_SVG/FWBCOUL_FWB_HORI.png" alt="" width="400" /><p>The Ministry of FWB (MFWB) is a complex organization with multiple entities called <strong>&quot;Administrations g√©n√©rales&quot;</strong> (or <strong>AG</strong>). Each of these entitie manages its own data ‚Äî often in silos ‚Äî and has its own governance structures composed of various layers of Services and Directions with Project Managers, Product Owners, Business Analysts, ...etc. Under this organisational complexity, the <strong>technical landscape</strong> is of course also complex. Each AG has its own products, Applications, DBMS, DWH, BI tools, etc. This leads to a lack of consistency and quality in the data. The employees mostly use Microsoft products (<em>Excel</em>) for their data management and analytics needs. Very few people are trained in data management and programmation, which leads sometimes to a lack of data literacy and understanding of the importance of data governance.</p>
<blockquote>
<p>This polycephalous nature of the organization makes it challenging to govern and implement a unified data platform that meets the needs of all stakeholders.</p>
</blockquote>
<ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/images/data_gov_fwb.png" alt="" width="400" /><h2 id="üéØ-what-is-our-data-strategy" tabindex="-1">üéØ What is our data strategy? <a class="header-anchor" href="#üéØ-what-is-our-data-strategy" aria-label="Permalink to &quot;üéØ What is our data strategy?&quot;">&ZeroWidthSpace;</a></h2>
<p>The data strategy of the French-speaking Community of Belgium (FWB), known as &quot;Donn√©es au Centre,&quot; has been in place since 2020 and aims to enhance data management and exploitation to improve service delivery and governance.</p>
<p>Key elements of the strategy include:</p>
<ul>
<li>Assigning a <strong>Data Owner and Data Steward</strong> to each meaningful dataset to ensure accountability and proper management.</li>
<li>Providing <strong>raw access</strong> to datasets for authorized personnel, while adhering to mandatory legal compliance requirements.</li>
<li>Offering technical and non-technical <strong>training</strong> to Data Owners and Data Stewards on topics such as data indicators, visualization, governance, Python, and SQL to enhance their data handling skills.</li>
<li>Cultivating a <strong>data-centric culture</strong> (Donn√©es au centre) through comprehensive <strong>documentation</strong>, training, and <strong>regular community meetings</strong> to encourage effective use of data resources.</li>
</ul>
<p>The strategy outlines objectives focusing on improving data quality, availability, and security, and fostering collaboration across organizational boundaries. It seeks to identify strategic data assets crucial for ministry operations, develop strategic and operational dashboards for informed decision-making, and promote data sharing and reuse beyond organizational barriers.</p>
<p>Additionally, the strategy prioritizes GDPR compliance for personal data, integration of reference data into business solutions, and publication of data through the <a href="https://www.odwb.be" target="_blank" rel="noreferrer">Open Data platform</a> to enhance transparency and accessibility.</p>
<h2 id="üì¶-where-are-the-data" tabindex="-1">üì¶ Where are the data? <a class="header-anchor" href="#üì¶-where-are-the-data" aria-label="Permalink to &quot;üì¶ Where are the data?&quot;">&ZeroWidthSpace;</a></h2>
<p>In the context of this type of organization, <strong>raw data</strong> are collected from various sources, including databases, APIs, and flat files. The heterogeneous nature of these sources makes it challenging to ensure data access, quality, consistency ‚Äî and hence exploitation. To address this challenge, a decision made years ago, was to implement a virtualisation layer (based on <a href="https://www.denodo.com/" target="_blank" rel="noreferrer">Denodo</a>) on top of DBMS.</p>
<p>Denodo is a powerful tool for data virtualization, but it requires a certain level of expertise to configure and maintain. This can be a barrier for some teams, especially those with limited technical resources. It is also not 100% compliant with most SQL standards (Denodo VQL), which can lead to confusion and errors when working with the data (accross upstream and downstream systems).</p>
<blockquote>
<p>While data virtualisation helps to unify the data access, it also adds complexity to the architecture by providing a new layer. Moreover, it does not solve complex transformations, load processes, and data quality monitoring issues. This is where the <strong>data platform</strong> comes into play.</p>
</blockquote>
<h2 id="üèóÔ∏è-conceptual-architecture-of-a-data-stack" tabindex="-1">üèóÔ∏è Conceptual architecture of a data stack <a class="header-anchor" href="#üèóÔ∏è-conceptual-architecture-of-a-data-stack" aria-label="Permalink to &quot;üèóÔ∏è Conceptual architecture of a data stack&quot;">&ZeroWidthSpace;</a></h2>
<p>Starting from <em>raw data</em> (or sometimes <em>virtualised data</em>), the Ministry need to analyse, transform and move data into a format that is suitable for exploration, analysis and/or exploitation.</p>
<p>A data stack is usually composed of several components that work together to manage and process data. The specific components of a data stack can vary depending on the needs of the organization, but they typically include:</p>
<ul>
<li><strong>Sources</strong>: These are the systems and applications that generate and store data. They can include databases, APIs, flat files, and other data repositories.</li>
<li><strong>Platform</strong>: This is where the compute is done to process and analyze data. It can include cloud-based platforms, on-premises servers, and other computing resources.</li>
<li><strong>Storage</strong>: This is where data is stored for later use. It can include databases, data lakes, and other storage solutions.</li>
<li><strong>Processing</strong>: This is where data is transformed and prepared for analysis. It can include ETL (Extract, Transform, Load) processes, data pipelines, and other data processing tools. This also includes ML and AI processes that can be used to analyze and extract insights from data.</li>
<li><strong>Dashboard</strong>: This is where data is presented in a way that is easy to understand and analyze. It can include dashboards, reports, and other visualization tools.</li>
</ul>
<p>Our data stack currently includes several components:</p>
<ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/fwb_tech_stack.drawio.png" alt="" width="600" /><p>We also tried several tools before settling on what we have today. The goal was to find a solution that would be flexible, auditable, transparent, and scalable. By &quot;auditable&quot;, we mean a system where every action and modification can be tracked, logged, and reviewed to ensure accountability and compliance.</p>
<p>We also wanted to avoid <em>vendor lock-in</em> üîí and ensure that the solution could be adapted to the needs of the organization and the level of technical expertise of the users.</p>
<p>Based on those requirements, in terms of orchestrators, we tried <strong>Airflow</strong> for a few weeks and relied on <strong>Prefect</strong> for a few months. We then decided to switch to <strong>Dagster</strong>, for a set of reasons:</p>
<ul>
<li>Data observability features at the core of the architecture -- this is a key requirement for us ;</li>
<li>Separation of code location to match the strong decentralized nature of the FWB ;</li>
<li>Great community and <strong>unified qualitative documentation</strong> ;</li>
</ul>
<p>The new architecture includes a data platform that integrates with existing data sources and tools, providing a more streamlined and efficient approach to data management.</p>
<p>Based on our context and choices, implementing a successful data orchestrator for the FWB hinges on two key challenges: <strong>easy onboarding</strong> and <strong>data literacy</strong> of our users. To achieve this, we need to focus on the following aspects:</p>
<h2 id="ü§ñ-automate-everything-or-almost-facilitate-the-onboarding" tabindex="-1">ü§ñ Automate everything (or almost) : facilitate the onboarding <a class="header-anchor" href="#ü§ñ-automate-everything-or-almost-facilitate-the-onboarding" aria-label="Permalink to &quot;ü§ñ Automate everything (or almost) : facilitate the onboarding&quot;">&ZeroWidthSpace;</a></h2>
<p>Developing a piece of software like a data platform is a complex task that requires a lot of time and effort. To make it easier for users to onboard and use the platform, we need to focus on automating as much of the process as possible. Here's an overview of our automation strategy:</p>
<ul>
<li><strong>Automating testing</strong>: Implementing comprehensive testing from unit tests to integration tests</li>
<li><strong>Automating deployment</strong>: Multi-environment deployment pipeline (testing, staging, production)</li>
<li><strong>Automating integration</strong>: Seamless connection with existing FWB systems</li>
<li><strong>Automating monitoring</strong>: Proactive pipeline and data quality monitoring</li>
</ul>
<blockquote>
<p>üí° For a detailed dive into our automation implementation, including GitLab CI/CD configurations and Dagster asset examples, check out Part 2 of this series.</p>
</blockquote>
<h2 id="üìö-data-literacy-lower-the-barrier-and-give-power-to-the-users" tabindex="-1">üìö Data Literacy : Lower the barrier and give power to the users <a class="header-anchor" href="#üìö-data-literacy-lower-the-barrier-and-give-power-to-the-users" aria-label="Permalink to &quot;üìö Data Literacy : Lower the barrier and give power to the users&quot;">&ZeroWidthSpace;</a></h2>
<p>As most of our users are not trained data professionals, we've developed several strategies to make the platform more accessible:</p>
<ul>
<li><strong>Technical barrier reduction</strong>: User-friendly interfaces and workflows</li>
<li><strong>Core resources development</strong>: Reusable components and templates</li>
<li><strong>Best practices framework</strong>: Clear standards for coding, testing, and deployment</li>
<li><strong>AI integration</strong>: Leveraging AI for pipeline development assistance</li>
<li><strong>Modular code architecture</strong>: Independent code locations for reduced complexity</li>
</ul>
<blockquote>
<p>üí° In Part 3 of this series, we'll explore how our custom resources have enhanced data governance and made the platform more accessible to users of all technical levels.</p>
</blockquote>
<h2 id="üìù-next-articles" tabindex="-1">üìù Next articles <a class="header-anchor" href="#üìù-next-articles" aria-label="Permalink to &quot;üìù Next articles&quot;">&ZeroWidthSpace;</a></h2>
<p>Stay tuned for the next articles in this series:</p>
<ul>
<li><a href="/blog/posts/2025/data_platform_in_fwb_01_automate.html">Part 2: Deep dive into our automation strategy with practical GitLab CI/CD examples</a></li>
<li><a href="/blog/posts/2025/data_platform_in_fwb_02_lower_barrier.html">Part 3: How custom resources and training helps lower the barrier</a></li>
</ul>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[De scripts √©parpill√©s √† une plateforme unifi√©e]]></title>
            <link>localhost/blog/blog/posts/2025/dagster-case-study.html</link>
            <guid>localhost/blog/blog/posts/2025/dagster-case-study.html</guid>
            <pubDate>Tue, 01 Jul 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[<p><em>R√©sum√©</em>:
Cet article pr√©sente une √©tude de cas sur l'utilisation de Dagster √† la <strong>F√©d√©ration Wallonie-Bruxelles</strong>, en Belgique, pour moderniser leur plateforme de donn√©es et am√©liorer l'orchestration et l'observabilit√© des donn√©es. Il s'agit d'une traduction de l'article original disponible sur le <a href="https://dagster.io/blog/federation-wallonie-bruxelles-case-study" target="_blank" rel="noreferrer">site de Dagster</a>, √©crit par <a href="https://www.linkedin.com/in/alexander-noonan" target="_blank" rel="noreferrer">Alex Noonan</a>.</p>
]]></description>
            <content:encoded><![CDATA[<p><em>R√©sum√©</em>:
Cet article pr√©sente une √©tude de cas sur l'utilisation de Dagster √† la <strong>F√©d√©ration Wallonie-Bruxelles</strong>, en Belgique, pour moderniser leur plateforme de donn√©es et am√©liorer l'orchestration et l'observabilit√© des donn√©es. Il s'agit d'une traduction de l'article original disponible sur le <a href="https://dagster.io/blog/federation-wallonie-bruxelles-case-study" target="_blank" rel="noreferrer">site de Dagster</a>, √©crit par <a href="https://www.linkedin.com/in/alexander-noonan" target="_blank" rel="noreferrer">Alex Noonan</a>.</p>
<hr>
<h1 id="de-scripts-eparpilles-a-une-plateforme-unifiee" tabindex="-1">De scripts √©parpill√©s √† une plateforme unifi√©e <a class="header-anchor" href="#de-scripts-eparpilles-a-une-plateforme-unifiee" aria-label="Permalink to &quot;De scripts √©parpill√©s √† une plateforme unifi√©e&quot;">&ZeroWidthSpace;</a></h1>
<p>La F√©d√©ration Wallonie-Bruxelles de Belgique sert 4,5 millions de citoyens dans les domaines de l‚Äô√©ducation, de la culture et des services de jeunesse, mais ses syst√®mes de donn√©es h√©rit√©s fragment√©s cr√©aient des cauchemars op√©rationnels : des processus manuels qui prenaient des mois, une visibilit√© de pipeline limit√©e et des d√©pendances d'outils propri√©taires qui limitaient la flexibilit√©.</p>
<p>L'ing√©nieur en donn√©es <strong>Martin Erpicum</strong> a dirig√© la transformation vers une plateforme moderne et unifi√©e aliment√©e par Dagster, offrant des r√©sultats efficaces : une livraison de pipeline deux fois plus rapide, un passage de la maintenance r√©active au d√©veloppement proactif de produits de donn√©es, une visibilit√© compl√®te des probl√®mes de qualit√© des donn√©es auparavant ind√©tectables et des analyses en libre-service qui ont permis aux utilisateurs finaux de provisionner leurs propres tableaux de bord.</p>
<p>Cette √©tude de cas r√©v√®le comment une grande organisation gouvernementale a modernis√© avec succ√®s sa pile technologique tout en continuant √† servir des millions de citoyens, prouvant que l‚Äôorchestration moderne des donn√©es peut fonctionner √† grande √©chelle, m√™me dans des environnements hautement r√©glement√©s.</p>
<ImageCenter src="https://i.imgur.com/KmCj3Om.png" alt="" width="600" /><p><strong>Table des mati√®res</strong></p>
<nav class="table-of-contents"><ul><li><a href="#resultats-cles">R√©sultats cl√©s</a></li><li><a href="#se-liberer-des-contraintes-des-outils-proprietaires">Se lib√©rer des contraintes des outils propri√©taires</a></li><li><a href="#choisir-la-flexibilite-et-les-pratiques-modernes-d-ingenierie">Choisir la flexibilit√© et les pratiques modernes d‚Äôing√©nierie</a></li><li><a href="#construire-une-plateforme-de-donnees-orientee-developpeur-avec-dagster">Construire une plateforme de donn√©es orient√©e d√©veloppeur avec Dagster</a></li><li><a href="#ameliorations-mesurables-de-fiabilite-et-de-productivite">Am√©liorations mesurables de fiabilit√© et de productivit√©</a></li><li><a href="#elargir-les-capacites-et-ajouter-de-l-ia">√âlargir les capacit√©s et ajouter de l&#39;IA</a></li></ul></nav>
<p>L‚Äôune des trois communaut√©s linguistiques de la Belgique, la <strong>F√©d√©ration Wallonie-Bruxelles</strong> supervise l‚Äô√©ducation, le sport, la culture, les services de jeunesse, etc., pour 4,5 millions de citoyens ‚Äî et g√®re des √©quipes compos√©es de plus de 7000 personnes, r√©parties dans 5 administrations g√©n√©rales diff√©rentes et des centaines d'√©quipes/d√©partements au sein du minist√®re. Avec une telle ampleur, l'organisation g√©n√®re d'√©normes quantit√©s de donn√©es provenant des citoyens qu'elle sert et des organisations qu'elle subventionne. Mais les syst√®mes de donn√©es fragment√©s et ferm√©s de la FWB √©taient lents, inaccessibles et trop souvent d√©sesp√©r√©ment manuels.</p>
<p><strong>Martin Erpicum</strong> est ing√©nieur en donn√©es √† la F√©d√©ration Wallonie-Bruxelles, o√π il a contribu√© √† transformer le syst√®me h√©rit√© lourd de la FWB en une plateforme de donn√©es moderne et modulaire. Comme l'explique Martin √† ses dirigeants, la flexibilit√© de Dagster permet √† son √©quipe de r√©pondre aux importants besoins organisationnels de la FWB sans √™tre contraint par la plateforme. <strong>¬´ Pas de verrouillage fournisseur signifie que 90 % de notre code peut √™tre r√©utilis√© n'importe o√π ¬ª</strong>, dit-il. ¬´ Et, apr√®s seulement dix mois d'utilisation, j'ai d√©j√† vu plusieurs instances o√π les fonctionnalit√©s de data observability de Dagster nous ont aid√©s √† d√©tecter et r√©soudre des probl√®mes qui seraient autrement pass√©s inaper√ßus. ¬ª</p>
<h2 id="resultats-cles" tabindex="-1">R√©sultats cl√©s <a class="header-anchor" href="#resultats-cles" aria-label="Permalink to &quot;R√©sultats cl√©s&quot;">&ZeroWidthSpace;</a></h2>
<ul>
<li><strong>Vitesse de pipeline doubl√©e :</strong> Le temps de livrer des r√©sultats √† partir de donn√©es brutes aux outils BI r√©duit de plus de 50%</li>
<li><strong>R√©actif -&gt; proactif :</strong> Les √©quipes de donn√©es proposent d√©sormais de mani√®re proactive de nouveaux produits de donn√©es aux utilisateurs, au lieu de simplement r√©pondre √† des demandes</li>
<li><strong>Visibilit√© d√©bloqu√©e :</strong> Les probl√®mes de qualit√© des donn√©es qui √©taient auparavant ind√©tectables sont d√©sormais rapidement d√©couverts et r√©solus gr√¢ce au plan de contr√¥le unifi√© de Dagster</li>
<li><strong>Accessibilit√© nulle -&gt; libre-service :</strong> Les utilisateurs finaux provisionnent maintenant leurs propres tableaux de bord de donn√©es depuis un data mart toujours √† jour</li>
</ul>
<h2 id="se-liberer-des-contraintes-des-outils-proprietaires" tabindex="-1">Se lib√©rer des contraintes des outils propri√©taires <a class="header-anchor" href="#se-liberer-des-contraintes-des-outils-proprietaires" aria-label="Permalink to &quot;Se lib√©rer des contraintes des outils propri√©taires&quot;">&ZeroWidthSpace;</a></h2>
<p>√Ä son arriv√©e √† la F√©d√©ration Wallonie-Bruxelles, Martin a trouv√© un minist√®re coinc√© dans un cycle de dette technique et d'inefficacit√© op√©rationnelle que de nombreuses grandes organisations reconna√Ætront.</p>
<p>L'architecture de donn√©es existante de la FWB avait √©volu√© de mani√®re organique au fil des ann√©es, cr√©ant un ensemble disparate de syst√®mes d√©connect√©s qui entravaient plut√¥t qu'aidaient leur mission de servir efficacement les citoyens belges. L'√©quipe de Martin a eu du mal √† suivre les changements ou √† garantir la qualit√© des donn√©es, et ils souhaitaient pouvoir permettre aux utilisateurs de construire et maintenir leurs propres workflows de donn√©es.</p>
<p>Les probl√®mes critiques qui ont motiv√© le changement incluent :</p>
<ul>
<li><strong>D√©pendance aux outils propri√©taires</strong> limitant la flexibilit√© et la transparence des op√©rations gouvernementales</li>
<li><strong>Absence totale de contr√¥le de version</strong> pour les pipelines de donn√©es, rendant les modifications risqu√©es et difficiles √† suivre</li>
<li><strong>Observabilit√© des donn√©es limit√©e ou inexistante</strong> concernant la sant√© du pipeline, la performance ou les √©checs</li>
<li><strong>Obstacles significatifs √† l'int√©gration des utilisateurs</strong> emp√™chant les √©quipes de devenir autonomes avec les donn√©es</li>
</ul>
<p>La pile technique du minist√®re refl√©tait cette complexit√©, avec des donn√©es circulant de SQLServer, MySQL, PostgreSQL, Denodo, DB2, fichiers FTP et divers API vers leur Azure Data Lake et des outils BI comme PowerBI et Metabase.</p>
<p>¬´ La plupart des transformations de donn√©es devaient √™tre effectu√©es manuellement ou via Excel ¬ª, dit Martin.</p>
<p>¬´ C'√©tait un cauchemar parce que chaque ann√©e nous devions tout reprocesser, et j'ai des coll√®gues qui devaient passer deux ou trois mois √† apporter des modifications √† un ensemble de donn√©es. ¬ª</p>
<h2 id="choisir-la-flexibilite-et-les-pratiques-modernes-d-ingenierie" tabindex="-1">Choisir la flexibilit√© et les pratiques modernes d‚Äôing√©nierie <a class="header-anchor" href="#choisir-la-flexibilite-et-les-pratiques-modernes-d-ingenierie" aria-label="Permalink to &quot;Choisir la flexibilit√© et les pratiques modernes d‚Äôing√©nierie&quot;">&ZeroWidthSpace;</a></h2>
<p>Apr√®s avoir lutt√© avec des outils propri√©taires et une architecture de donn√©es fragment√©e, Martin et son √©quipe ont syst√©matiquement √©valu√© leurs options d'orchestration pour trouver une plateforme capable d'unifier leur √©cosyst√®me complexe tout en offrant plus d'accessibilit√© aux utilisateurs d'analytique.</p>
<p>Le minist√®re a test√© plusieurs solutions, y compris TiMi, KNIME, Apache Airflow et Prefect avant de choisir Dagster. Leur exp√©rience pratique avec Airflow pendant plusieurs semaines, suivie de mois avec Prefect, leur a donn√© des aper√ßus clairs de ce qu'ils devaient √©viter. ¬´ Airflow n'√©tait pas intuitif pour nos utilisateurs‚Äîl'interface utilisateur manquait d'amabilit√©, les concepts √©taient difficiles √† saisir et ses capacit√©s de journalisation √©taient limit√©es ¬ª, explique Martin.</p>
<p>Apr√®s une √©valuation approfondie, Dagster est apparu comme le choix clair pour plusieurs raisons cl√©s :</p>
<ul>
<li><strong>Architecture centr√©e sur les actifs :</strong> La focalisation de Dagster sur les actifs de donn√©es en tant que citoyens de premi√®re classe s'alignait parfaitement avec la fa√ßon dont leurs √©quipes conceptualisaient les workflows de donn√©es, plut√¥t que de simplement penser aux t√¢ches et aux processus.</li>
<li><strong>Exp√©rience moderne de d√©veloppeur :</strong> La plateforme offrait des workflows de d√©veloppement propres, des capacit√©s de test local et des meilleures pratiques en ing√©nierie logicielle que leurs √©quipes techniques appr√©ciaient.</li>
<li><strong>Observabilit√© avanc√©e :</strong> Les capacit√©s int√©gr√©es de surveillance et de d√©bogage √©taient essentielles pour g√©rer leur environnement de donn√©es complexe et h√©t√©rog√®ne √† travers de multiples sources et destinations.</li>
<li><strong>Adaptabilit√© organisationnelle :</strong> L'architecture flexible de Dagster pouvait accueillir les cinq ¬´ Administrations G√©n√©rales ¬ª de la FWB travaillant dans des domaines tr√®s diff√©rents.</li>
<li><strong>Fondation √† l'√©preuve du futur :</strong> La plateforme pourrait servir √† la fois leurs besoins d'orchestration imm√©diats et fournir une base pour des capacit√©s avanc√©es d'analytique et d'IA/ML.</li>
</ul>
<p>L'approche diff√©renci√©e de Dagster a imm√©diatement r√©sonn√© avec leurs besoins. L'architecture centr√©e sur les actifs s'alignait parfaitement avec la fa√ßon dont leurs √©quipes pensaient r√©ellement aux donn√©es, tandis que l'exp√©rience de d√©veloppeur moderne promettait de surmonter la friction et l'inaccessibilit√© qui avaient historiquement emp√™ch√© l'adoption g√©n√©ralis√©e des outils de donn√©es dans tout le minist√®re. ¬´ Dagster √©tait particuli√®rement bien adapt√© √† la structure polyc√©phale de notre organisation ¬ª, dit Martin, faisant r√©f√©rence aux nombreuses administrations internes de la FWB, et notant que Dagster √©tait la seule solution qu'ils avaient trouv√©e offrant une observabilit√© avanc√©e des donn√©es √† travers un domaine de donn√©es aussi divergent.</p>
<blockquote>
<p><em>Nous appr√©cions √©norm√©ment que Dagster traite les actifs comme des citoyens de premi√®re classe dans son architecture. Cette capacit√© √† suivre et √† g√©rer de mani√®re exhaustive les actifs de donn√©es tout au long de leur cycle de vie est cruciale pour nous.</em></p>
</blockquote>
<h2 id="construire-une-plateforme-de-donnees-orientee-developpeur-avec-dagster" tabindex="-1">Construire une plateforme de donn√©es orient√©e d√©veloppeur avec Dagster <a class="header-anchor" href="#construire-une-plateforme-de-donnees-orientee-developpeur-avec-dagster" aria-label="Permalink to &quot;Construire une plateforme de donn√©es orient√©e d√©veloppeur avec Dagster&quot;">&ZeroWidthSpace;</a></h2>
<p>Plut√¥t que d'essayer une migration en un grand-bang, la F√©d√©ration Wallonie-Bruxelles a adopt√© une approche r√©fl√©chie par phases qui priorisait l'exp√©rience d√©veloppeur et la gestion du changement organisationnel ‚Äî et beaucoup d'int√©grations. ¬´ C'est un minist√®re du domaine public, et la litt√©ratie des donn√©es dans notre organisation n'est pas encore tr√®s bonne ¬ª, dit Martin. ¬´ Nous savions que le succ√®s de l'adoption ne serait que aussi bon que notre soutien pour nos utilisateurs. ¬ª</p>
<p>L'approche strat√©gique de migration de la FWB comprenait :</p>
<ul>
<li><strong>Strat√©gie de d√©ploiement par phases</strong> pour minimiser les perturbations et assurer des transitions en douceur</li>
<li><strong>Soutien pratique aux utilisateurs</strong> avec des sessions d'int√©gration sur mesure pour chaque √©quipe</li>
<li><strong>Programmes de formation complets</strong> couvrant les fondamentaux comme SQL, Python, Git, et Docker</li>
<li><strong>D√©veloppement des meilleures pratiques</strong> pour assurer la coh√©rence et la qualit√© de l'ensemble du d√©veloppement de pipeline</li>
<li><strong>Cr√©ation de packages Python personnalis√©s</strong> pour simplifier les interactions avec leur √©cosyst√®me unique</li>
</ul>
<p>La mise en ≈ìuvre technique a montr√© des pratiques d'ing√©nierie sophistiqu√©es qui maximisaient les capacit√©s de Dagster tout en r√©pondant aux exigences sp√©cifiques du minist√®re :</p>
<ul>
<li><strong>Ressources personnalis√©es de Dagster et gestionnaires IO</strong> pour SQLServer, PostgreSQL, DB2, et diverses API</li>
<li><strong>Int√©gration transparente de dbt</strong> en utilisant le support int√©gr√© de Dagster pour les workflows de transformation de donn√©es</li>
<li><strong>Int√©gration de DuckDB</strong> pour un traitement et une analyse efficaces des donn√©es</li>
<li><strong>Int√©gration de projet automatis√©e</strong> utilisant les sous-modules Git et les workflows automatis√©s</li>
<li><strong>Automatisation de pipeline CI/CD GitLab</strong> avec tests, validation et d√©ploiement sur une infrastructure Docker Swarm ‚Äì fournie par notre partenaire informatique (<a href="https://etnic.be" target="_blank" rel="noreferrer">ETNIC</a>) ‚Äì dans les environnements de branche de fonctionnalit√©, de mise en sc√®ne et de production</li>
</ul>
<p>L'une de leurs impl√©mentations les plus innovantes d√©montre la puissance de traiter l'infrastructure comme du code : ¬´ Nous avons d√©velopp√© un workflow pour int√©grer automatiquement les projets dbt dans nos emplacements de code Dagster.</p>
<p>Ce workflow implique la s√©paration des r√©f√©rentiels de code pour les projets dbt et les emplacements de code Dagster.</p>
<p>√Ä chaque publication de projet dbt, nous incluons automatiquement le projet dbt comme sous-module Git dans l'emplacement de code Dagster. ¬ª</p>
<p>Cette approche permet √† leurs utilisateurs de tirer parti des projets dbt existants sans n√©cessiter une connaissance approfondie de Dagster, abaissant significativement la barri√®re √† l'entr√©e tout en conservant les avantages de l'orchestration unifi√©e.</p>
<blockquote>
<p><em>Je voulais vraiment que nos analystes de donn√©es se sentent confiants et non intimid√©s ‚Äî pour eux, m√™me utiliser une CLI pouvait √™tre difficile. Avec Dagster, nous pouvions leur donner leur propre environnement, inclus dans l'orchestration.</em></p>
</blockquote>
<h2 id="ameliorations-mesurables-de-fiabilite-et-de-productivite" tabindex="-1">Am√©liorations mesurables de fiabilit√© et de productivit√© <a class="header-anchor" href="#ameliorations-mesurables-de-fiabilite-et-de-productivite" aria-label="Permalink to &quot;Am√©liorations mesurables de fiabilit√© et de productivit√©&quot;">&ZeroWidthSpace;</a></h2>
<p>Six mois apr√®s la mise en ≈ìuvre, la F√©d√©ration Wallonie-Bruxelles a atteint des r√©sultats transformationnels qui d√©montrent l'impact de Dagster tant sur les op√©rations techniques que sur les r√©sultats commerciaux. La combinaison de la fiabilit√© am√©lior√©e, de la productivit√© des d√©veloppeurs renforc√©e et de la gestion proactive des donn√©es a fondamentalement chang√© la fa√ßon dont le minist√®re aborde les donn√©es.</p>
<p>Les am√©liorations op√©rationnelles quantifiables de la FWB incluent :</p>
<ul>
<li><strong>Am√©lioration de la fiabilit√© des pipelines</strong> gr√¢ce √† une surveillance et √† des alertes compl√®tes via les notifications MSTeams et NTFY</li>
<li><strong>R√©solution des probl√®mes plus rapide</strong> gr√¢ce aux fonctionnalit√©s d'observabilit√© de Dagster pour une identification rapide des probl√®mes</li>
<li><strong>D√©tection am√©lior√©e de la qualit√© des donn√©es</strong> aidant les d√©veloppeurs de logiciels √† identifier et r√©soudre les probl√®mes de donn√©es au niveau des applications</li>
<li><strong>R√©duction des perturbations op√©rationnelles</strong> gr√¢ce √† une ex√©cution de pipeline plus fiable et √† un suivi</li>
<li><strong>Confiance renforc√©e dans la prise de d√©cision</strong> permettant la proposition proactive de nouveaux produits de donn√©es aux utilisateurs</li>
</ul>
<p>La transformation s'√©tend au-del√† des simples m√©triques techniques √† des changements culturels et organisationnels qui montrent comment la valeur plus large de l'orchestration moderne des donn√©es apporte des b√©n√©fices organisationnels et strat√©giques :</p>
<ul>
<li><strong>Passage du r√©actif au proactif</strong> dans le d√©veloppement de produits de donn√©es et le support aux utilisateurs</li>
<li><strong>Augmentation de la litt√©ratie des donn√©es</strong> dans toute l'organisation gr√¢ce √† une am√©lioration de la formation et de la documentation</li>
<li><strong>Confiance accrue des parties prenantes</strong> dans la qualit√© des donn√©es et les d√©lais de livraison</li>
<li><strong>Collaboration renforc√©e</strong> entre √©quipes techniques et non techniques</li>
<li><strong>Fondation plus solide</strong> pour les futures initiatives d'IA/ML et d'analytique avanc√©e</li>
</ul>
<p>L'automatisation du suivi de la qualit√© donn√©es du minist√®re illustre comment une observabilit√© ad√©quate transforme les op√©rations : ¬´ Nous avons mis en place un suivi des ex√©cutions et des contr√¥les de qualit√© des donn√©es (avec notifications) pour nous assurer que nos pipelines de donn√©es fonctionnent aussi efficacement que possible ¬ª, explique Martin.</p>
<p>C'est ainsi, dit-il, que l'√©quipe de donn√©es de la FWB est pass√©e de la d√©couverte de probl√®mes seulement <em>apr√®s</em> que les tableaux de bord ont cess√© de fonctionner √† la pr√©vention des probl√®mes avant qu'ils n'aient un impact sur les utilisateurs finaux ‚Äî une capacit√© cruciale lors de la prestation de services gouvernementaux fiables √† 4,5 millions de citoyens.</p>
<h2 id="elargir-les-capacites-et-ajouter-de-l-ia" tabindex="-1">√âlargir les capacit√©s et ajouter de l'IA <a class="header-anchor" href="#elargir-les-capacites-et-ajouter-de-l-ia" aria-label="Permalink to &quot;√âlargir les capacit√©s et ajouter de l'IA&quot;">&ZeroWidthSpace;</a></h2>
<p>La F√©d√©ration Wallonie-Bruxelles voit Dagster comme la base pour des prochaines √©tapes ambitieuses qui permettront de d√©mocratiser davantage l'acc√®s aux donn√©es et, √©ventuellement, de tirer parti des technologies de pointe en IA et en apprentissage automatique pour mieux servir ses citoyens.</p>
<p>Les priorit√©s imm√©diates du plan d'action de la FWB incluent :</p>
<ul>
<li><strong>Assistance utilisateur aliment√©e par l'IA</strong> gr√¢ce √† l'int√©gration du service MCP reliant la documentation de leur biblioth√®que Dagster personnalis√©e √† un LLM pour une aide personnalis√©e et contextuelle</li>
<li><strong>Meilleure int√©gration des utilisateurs</strong> en explorant le nouveau dg CLI de Dagster pour simplifier davantage l'adoption par les utilisateurs</li>
<li><strong>Capacit√©s d'analytique avanc√©e</strong> en s'appuyant sur leur base d'orchestration solide pour prendre en charge des charges de travail IA/ML croissantes</li>
</ul>
<p>La vision √† long terme du minist√®re positionne Dagster comme le composant central dans un √©cosyst√®me de donn√©es complet qui soutient des services de donn√©es unifi√©s et efficaces r√©pondant aux besoins de tous les parties prenantes tout en promouvant la litt√©ratie des donn√©es et les meilleures pratiques en ing√©nierie dans toute l'organisation.</p>
<blockquote>
<p>&quot;Nous envisageons d'int√©grer un service MCP qui relie notre documentation de biblioth√®que Dagster personnalis√©e et nos capacit√©s de d√©couverte de donn√©es √† un LLM, permettant une assistance personnalis√©e et contextuelle pour nos utilisateurs&quot;, explique Martin. &quot;Gr√¢ce √† Dagster, dbt, DuckDB et notre data lake, nous construisons les bases d'une plateforme de donn√©es qui peut cro√Ætre et s'adapter pour soutenir les besoins de notre organisation pendant tr√®s longtemps.&quot;</p>
</blockquote>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Address lookup - Part 3 - API]]></title>
            <link>localhost/blog/blog/posts/2025/address_lookup-part3-api.html</link>
            <guid>localhost/blog/blog/posts/2025/address_lookup-part3-api.html</guid>
            <pubDate>Thu, 01 May 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[<p><em>Executive summary</em>: In Belgium, a collaborative effort between regional and federal authorities has led to the creation of a unified service that aggregates all Belgian addresses into a comprehensive dataset. This dataset is called <a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BeStAddress</a>.</p>
]]></description>
            <content:encoded><![CDATA[<p><em>Executive summary</em>: In Belgium, a collaborative effort between regional and federal authorities has led to the creation of a unified service that aggregates all Belgian addresses into a comprehensive dataset. This dataset is called <a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BeStAddress</a>.</p>
<hr>
<h2 id="api-houte-si-true" tabindex="-1">API Houte-Si-<code>True</code> <a class="header-anchor" href="#api-houte-si-true" aria-label="Permalink to &quot;API Houte-Si-`True`&quot;">&ZeroWidthSpace;</a></h2>
<ImageCenter src="https://i.imgur.com/GJNQQJA.png" alt="Houte Si True" width="300" /><h2 id="api-development-with-fastapi" tabindex="-1">API Development with FastAPI <a class="header-anchor" href="#api-development-with-fastapi" aria-label="Permalink to &quot;API Development with FastAPI&quot;">&ZeroWidthSpace;</a></h2>
<p>The HouteSiTrue API was developed using <a href="https://fastapi.tiangolo.com/" target="_blank" rel="noreferrer">FastAPI</a>, a modern, fast web framework for building APIs with Python. The API serves as a bridge between our legacy GEOG system (or any other address system) and the <a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BestAddress reference dataset</a>, providing efficient address lookup and matching capabilities.</p>
<h3 id="core-components" tabindex="-1">Core Components <a class="header-anchor" href="#core-components" aria-label="Permalink to &quot;Core Components&quot;">&ZeroWidthSpace;</a></h3>
<ol>
<li><strong>Router Structure</strong>
The API is organized using FastAPI's router system, with the main address-related endpoints grouped under the <code>/addresses</code> prefix:</li>
</ol>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #BABED8">router </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">APIRouter</span><span style="color: #89DDFF">(</span><span style="color: #BABED8; font-style: italic">prefix</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">/addresses</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #BABED8; font-style: italic">tags</span><span style="color: #89DDFF">=[</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">addresses</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">])</span></span></code></pre>
</div><ol start="2">
<li><strong>Key Endpoints</strong></li>
</ol>
<ul>
<li><strong>Single Address Lookup</strong>: Retrieve address details by unique identifier</li>
<li><strong>Street Listings</strong>: Get streets by postcode or municipality</li>
<li><strong>Address Matching</strong>: Find the best match for given address components</li>
<li><strong>Batch Processing</strong>: Handle multiple address lookups in a single request</li>
<li><strong>Distance Calculations</strong>: Compute distances between geographical locations</li>
<li><strong>Similar Street Names</strong>: Find similar street names within a specified area</li>
</ul>
<h3 id="address-matching-logic" tabindex="-1">Address Matching Logic <a class="header-anchor" href="#address-matching-logic" aria-label="Permalink to &quot;Address Matching Logic&quot;">&ZeroWidthSpace;</a></h3>
<p>The core functionality revolves around the address matching system, which uses both strict and fuzzy matching. The implementation combines FastAPI endpoints with sophisticated SQL queries for accurate address matching:</p>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #C792EA">class</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">AddressRequest</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">BaseModel</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #BABED8">    postcode</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">str</span></span>
<span class="line"><span style="color: #BABED8">    streetname</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">str</span></span>
<span class="line"><span style="color: #BABED8">    house_number</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">str</span></span>
<span class="line"><span style="color: #BABED8">    box_number</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #FFCB6B">str</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF">@</span><span style="color: #82AAFF">router</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">post</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">/bestmatch</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #BABED8; font-style: italic">operation_id</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">find_bestmatch_for_address</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #C792EA">async</span><span style="color: #BABED8"> </span><span style="color: #C792EA">def</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">find_bestmatch_for_address</span><span style="color: #89DDFF">(</span><span style="color: #BABED8; font-style: italic">body</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> AddressRequest</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #BABED8; font-style: italic">request</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> Request</span><span style="color: #89DDFF">):</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF; font-style: italic">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color: #676E95; font-style: italic">    Retrieve the best match for an address.</span></span>
<span class="line"><span style="color: #676E95; font-style: italic">    - postcode: strict matching</span></span>
<span class="line"><span style="color: #676E95; font-style: italic">    - street_name: fuzzy matching</span></span>
<span class="line"><span style="color: #676E95; font-style: italic">    - house_number: strict matching</span></span>
<span class="line"><span style="color: #676E95; font-style: italic">    - box_number: strict matching</span></span>
<span class="line"><span style="color: #676E95; font-style: italic">    </span><span style="color: #89DDFF; font-style: italic">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color: #BABED8">    results </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF; font-style: italic">await</span><span style="color: #BABED8"> find_address</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">bestmatch</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">body</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> request</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> results</span></span></code></pre>
</div><p>Under the hood, the bestmatch function utilizes a SQL query that implements fuzzy matching using Levenshtein distance and Jaro similarity scores:</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight has-focused-lines" ><code><span class="line"><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #82AAFF">count</span><span style="color: #BABED8">(</span><span style="color: #89DDFF">*</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> addresses_count</span></span>
<span class="line"><span style="color: #BABED8">, street_id</span></span>
<span class="line"><span style="color: #BABED8">, municipality_id</span></span>
<span class="line"><span style="color: #BABED8">, </span><span style="color: #82AAFF">lower</span><span style="color: #BABED8">(strip_accents(streetname_fr)) </span><span style="color: #F78C6C">as</span><span style="color: #BABED8"> streetname_fr_striped</span></span>
<span class="line"><span style="color: #BABED8">, </span><span style="color: #82AAFF">lower</span><span style="color: #BABED8">(strip_accents(streetname_nl)) </span><span style="color: #F78C6C">as</span><span style="color: #BABED8"> streetname_nl_striped</span></span>
<span class="line"><span style="color: #BABED8">, </span><span style="color: #82AAFF">lower</span><span style="color: #BABED8">(strip_accents(streetname_de)) </span><span style="color: #F78C6C">as</span><span style="color: #BABED8"> streetname_de_striped</span></span>
<span class="line"><span style="color: #BABED8">, default_streetname</span></span>
<span class="line"><span style="color: #BABED8">, </span><span style="color: #82AAFF">greatest</span><span style="color: #BABED8">(</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> (</span></span>
<span class="line has-focus"><span style="color: #BABED8">    levenshtein(streetname_fr_striped, </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">{street_name}</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">greatest</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">length</span><span style="color: #BABED8">(streetname_fr_striped), </span><span style="color: #F78C6C">length</span><span style="color: #BABED8">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">{street_name}</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">))), </span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> (levenshtein(streetname_nl_striped, </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">{street_name}</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">greatest</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">length</span><span style="color: #BABED8">(streetname_nl_striped), </span><span style="color: #F78C6C">length</span><span style="color: #BABED8">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">{street_name}</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">))), </span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> (levenshtein(streetname_de_striped, </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">{street_name}</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">greatest</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">length</span><span style="color: #BABED8">(streetname_de_striped), </span><span style="color: #F78C6C">length</span><span style="color: #BABED8">(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">{street_name}</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">))) </span></span>
<span class="line has-focus"><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> best_levenshtein_score </span></span>
<span class="line"><span style="color: #BABED8">, </span><span style="color: #82AAFF">greatest</span><span style="color: #BABED8">(</span></span>
<span class="line"><span style="color: #BABED8">    jaro_similarity(streetname_fr_striped, </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">{street_name}</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">    jaro_similarity(streetname_nl_striped, </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">{street_name}</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">    jaro_similarity(streetname_de_striped, </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">{street_name}</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> best_jaro_score</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">1</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> postcode </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">{postcode}</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> best_jaro_score </span><span style="color: #89DDFF">&gt;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">0</span><span style="color: #BABED8">.</span><span style="color: #F78C6C">6</span><span style="color: #BABED8"> </span></span>
<span class="line"><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> ALL</span></span>
<span class="line has-focus"><span style="color: #F78C6C">ORDER BY</span><span style="color: #BABED8"> best_levenshtein_score </span><span style="color: #F78C6C">DESC</span><span style="color: #BABED8"> </span></span>
<span class="line"><span style="color: #F78C6C">LIMIT</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">3</span><span style="color: #BABED8">;</span></span></code></pre>
</div><div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">is_perfect_match</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> is_perfect_match</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">is_partial_match</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> is_partial_match</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">street_id</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> addresses</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">][</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">street_id</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">],</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">municipality_id</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> addresses</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">][</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">municipality_id</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">],</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">address_id</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> addresses</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">][</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">address_id</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">],</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">levenshtein_score</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> results</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">][</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">best_levenshtein_score</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">],</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">matches</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> addresses</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
</div><p>This query performs several key operations:</p>
<ol>
<li>Strips accents and normalizes street names in all three national languages (French, Dutch, and German)</li>
<li>Calculates Levenshtein distance scores for each language version</li>
<li>Computes Jaro similarity scores as a secondary matching metric</li>
<li>Filters results based on a minimum similarity threshold</li>
<li>The SQL returns the top 3 matches ordered by Levenshtein score</li>
<li>The Python code returns the best match and the matches found by the SQL query</li>
</ol>
<h3 id="application-configuration" tabindex="-1">Application Configuration <a class="header-anchor" href="#application-configuration" aria-label="Permalink to &quot;Application Configuration&quot;">&ZeroWidthSpace;</a></h3>
<p>The API is built with scalability and maintainability in mind:</p>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #C792EA">def</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">get_application</span><span style="color: #89DDFF">()</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">-&gt;</span><span style="color: #BABED8"> FastAPI</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    application </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">FastAPI</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #BABED8; font-style: italic">title</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">metadata</span><span style="color: #89DDFF">.</span><span style="color: #F07178">app_name</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #BABED8; font-style: italic">description</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">metadata</span><span style="color: #89DDFF">.</span><span style="color: #F07178">base_description</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #BABED8; font-style: italic">version</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">os</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">getenv</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">CI_COMMIT_SHORT_SHA</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">N/A</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">),</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #BABED8; font-style: italic">openapi_tags</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">metadata</span><span style="color: #89DDFF">.</span><span style="color: #F07178">tags_metadata</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #BABED8; font-style: italic">contact</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">metadata</span><span style="color: #89DDFF">.</span><span style="color: #F07178">contact</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #BABED8; font-style: italic">deployement</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">metadata</span><span style="color: #89DDFF">.</span><span style="color: #F07178">deployement</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #89DDFF">)</span></span></code></pre>
</div><h3 id="model-context-protocol-mcp" tabindex="-1">Model-Context-Protocol (MCP) <a class="header-anchor" href="#model-context-protocol-mcp" aria-label="Permalink to &quot;Model-Context-Protocol (MCP)&quot;">&ZeroWidthSpace;</a></h3>
<p>We implemented a Model-Context-Protocol (MCP) pattern using <code>FastApiMCP</code>, to be able to call the API from LLM with tools capabilities.</p>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #BABED8">mcp </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">FastApiMCP</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">app</span><span style="color: #89DDFF">)</span></span></code></pre>
</div><h3 id="performance-considerations" tabindex="-1">Performance Considerations <a class="header-anchor" href="#performance-considerations" aria-label="Permalink to &quot;Performance Considerations&quot;">&ZeroWidthSpace;</a></h3>
<p>The API includes performance monitoring features:</p>
<ul>
<li>Execution time tracking for each request</li>
<li>Batch processing capabilities (up to 25 addresses per request)</li>
<li>Efficient distance calculations using the <code>geopy</code> library (spacial library from DuckDB could also be used)</li>
</ul>
<h3 id="error-handling-and-validation" tabindex="-1">Error Handling and Validation <a class="header-anchor" href="#error-handling-and-validation" aria-label="Permalink to &quot;Error Handling and Validation&quot;">&ZeroWidthSpace;</a></h3>
<p>The API implements robust error handling and input validation:</p>
<ul>
<li>Input validation through Pydantic models</li>
<li>Batch size limitations</li>
<li>Proper error responses for invalid requests</li>
</ul>
<h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">&ZeroWidthSpace;</a></h2>
<p>The HouteSiTrue API provides a robust and efficient solution for address matching and validation in Belgium. By combining strict and fuzzy matching techniques with a well-structured API design, we've created a reliable service that bridges the gap between legacy systems and modern address data requirements.</p>
<p>This API was used to match addresses from our legacy GEOG system with the BestAddress reference dataset. For that we used the <code>bestmatch</code> endpoint in combination with an orchestrator (Dagster).</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Data Platform - Part 3: Lower the barrier üöß]]></title>
            <link>localhost/blog/blog/posts/2025/data_platform_in_fwb_02_lower_barrier.html</link>
            <guid>localhost/blog/blog/posts/2025/data_platform_in_fwb_02_lower_barrier.html</guid>
            <pubDate>Thu, 03 Apr 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[<p><em>Executive summary</em>: In a polycephalous organization, Data Governance is a complex challenge. This article explores the implementation of a Data Platform based on <a href="https://dagster.io/" target="_blank" rel="noreferrer">Dagster</a> for the <a href="https://www.federation-wallonie-bruxelles.be" target="_blank" rel="noreferrer">F√©d√©ration Wallonie-Bruxelles (FWB)</a>. It highlights the importance of automation, modularity, and component reusability to lower the technical barrier and improve data literacy among data analysts and data stewards.</p>
]]></description>
            <content:encoded><![CDATA[<p><em>Executive summary</em>: In a polycephalous organization, Data Governance is a complex challenge. This article explores the implementation of a Data Platform based on <a href="https://dagster.io/" target="_blank" rel="noreferrer">Dagster</a> for the <a href="https://www.federation-wallonie-bruxelles.be" target="_blank" rel="noreferrer">F√©d√©ration Wallonie-Bruxelles (FWB)</a>. It highlights the importance of automation, modularity, and component reusability to lower the technical barrier and improve data literacy among data analysts and data stewards.</p>
<hr>
<p><em>The views expressed on this website are my own and do not necessarily reflect the views of my employer.</em></p>
<p><strong>Table of contents</strong></p>
<nav class="table-of-contents"><ul><li><a href="#üßë‚Äçüíª-code-reusability">üßë‚Äçüíª Code reusability</a><ul><li><a href="#implement-common-library-dagster-cfwb-corresponding-to-our-specific-need">Implement common library dagster-cfwb corresponding to our specific need</a></li></ul></li><li><a href="#üìñ-level-up-the-data-literacy">üìñ Level up the data literacy</a><ul><li><a href="#communicate-about-the-data-platform">Communicate about the data platform</a></li><li><a href="#train-the-users">Train the users</a></li><li><a href="#build-a-community-to-share-knowledge">Build a community to share knowledge</a></li></ul></li><li><a href="#conclusion">Conclusion</a></li></ul></nav>
<p>After the first two articles in this series, which focused on the <a href="/blog/posts/2025/data_platform_in_fwb_00_intro.html">architecture of our data platform</a> and the <a href="/blog/posts/2025/data_platform_in_fwb_01_automate.html">automation of our data pipelines</a>, this article will discuss how we lower the technical barrier for our users and improve their data literacy.</p>
<p>There are two main aspects to this:</p>
<ul>
<li><strong>Reduce the complexity</strong> of our data platform by providing common resources and components that can be reused by all data analysts and data stewards.</li>
<li><strong>Level up the data literacy</strong> of our users by training them, writing documentation, accompanying them in their first steps, and providing them with the necessary tools to understand and use the data platform.</li>
</ul>
<h2 id="üßë‚Äçüíª-code-reusability" tabindex="-1">üßë‚Äçüíª Code reusability <a class="header-anchor" href="#üßë‚Äçüíª-code-reusability" aria-label="Permalink to &quot;üßë‚Äçüíª Code reusability&quot;">&ZeroWidthSpace;</a></h2>
<p>Without any surprise, <strong>Dagster</strong> provide two main concepts to help code reusability: <strong>resources</strong> and <strong>components</strong>.</p>
<ul>
<li><strong>Resources</strong> are used to connect to external systems (databases, APIs, etc.)</li>
<li><strong>Components</strong> (still kind of new) are used to define reusable pieces of code with <code>YAML</code> that can be used in multiple jobs or pipelines.</li>
</ul>
<p>The two concepts are closely related, as resources are often used in components to connect to external systems.</p>
<p>Since our Data Platform leverage multipls code locations, and that we want to facilitate the onboarding of new data engineers, we need to build a common python library that contains all the resources, components and customs libs (utils) that we need to connect to our data sources. We called this library <code>dagster-cfwb</code>.</p>
<h3 id="implement-common-library-dagster-cfwb-corresponding-to-our-specific-need" tabindex="-1">Implement common library <code>dagster-cfwb</code> corresponding to our specific need <a class="header-anchor" href="#implement-common-library-dagster-cfwb-corresponding-to-our-specific-need" aria-label="Permalink to &quot;Implement common library `dagster-cfwb` corresponding to our specific need&quot;">&ZeroWidthSpace;</a></h3>
<ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/dagster_cfwb.drawio.png" alt="" width="400" /><p>Our <strong>dagster-cfwb package</strong> contains all the Dagster resources that we need to connect to our data sources. This library is used by most of jobs and pipelines in our data platform. It includes resources for connecting to various databases (postgresql, mssql, mysql, db2, ...), APIs (denodo, custom api, oauth2, ...), and other data sources (lakehouse, ftp, nfs ...). It also includes custom components that can be used to perform common tasks, such as importing data from Denodo, storing to the data lakehouse and reporting metadata.</p>
<p>This library is also extensively documented (directly visible in the Dagster UI), versioned and tested with unit/integration tests during our Gitlab CI/CD pipeline.</p>
<p>To illustrate this, let's take a look at the <code>AzureAdlsResource</code> and <code>PostgreSQLResource</code> resources that we implemented in the <code>dagster-cfwb</code> library. These resources are used to connect to an Azure Data Lake Storage (ADLS) and a PostgreSQL database, respectively.</p>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight has-focused-lines" ><code><span class="line has-focus"><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #BABED8"> dagster_cfwb</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">resources</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">lakehouse</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">azure_adls_resource </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #BABED8"> AzureAdlsResource </span></span>
<span class="line has-focus"><span style="color: #89DDFF; font-style: italic">from</span><span style="color: #BABED8"> dagster_cfwb</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">resources</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">db</span><span style="color: #89DDFF">.</span><span style="color: #BABED8">postgresql_resource </span><span style="color: #89DDFF; font-style: italic">import</span><span style="color: #BABED8"> PostgreSQLResource </span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color: #89DDFF">@</span><span style="color: #82AAFF">asset</span><span style="color: #89DDFF">()</span><span style="color: #BABED8"> </span></span>
<span class="line has-focus"><span style="color: #C792EA">def</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">gld_example</span><span style="color: #89DDFF">(</span><span style="color: #BABED8"> </span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #BABED8; font-style: italic">context</span><span style="color: #89DDFF">,</span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #BABED8; font-style: italic">azure_adls</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> AzureAdlsResource</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span></span>
<span class="line has-focus"><span style="color: #BABED8">    </span><span style="color: #BABED8; font-style: italic">postgresql</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> PostgreSQLResource </span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF">):</span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color: #BABED8">    df </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> azure_adls</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">query_blob_storage</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">FROM &#39;azure://code_location/stg/example.parquet&#39;</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)</span><span style="color: #BABED8"> </span></span>
<span class="line"></span>
<span class="line has-focus"><span style="color: #BABED8">    postgresql</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">copy_from_df</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">df</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">example</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)</span><span style="color: #BABED8"> </span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">MaterializeResult</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #BABED8; font-style: italic">metadata</span><span style="color: #89DDFF">={</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">dagster/row_count</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> df</span><span style="color: #89DDFF">.</span><span style="color: #F07178">shape</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">],</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">num_columns</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> df</span><span style="color: #89DDFF">.</span><span style="color: #F07178">shape</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">],</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">dashboard_url</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> MetadataValue</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">url</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">                </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://vizu.intranet.fwb.be/example_dashboard</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #89DDFF">),</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">documentation_url</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #82AAFF"> MetadataValue</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">url</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">                </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://docs.intranet.fwb.be/example_documentation</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #82AAFF">            </span><span style="color: #89DDFF">),</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #89DDFF">},</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #89DDFF">)</span></span></code></pre>
</div><p>As you can see, the <code>AzureAdlsResource</code> and <code>PostgreSQLResource</code> resources are used to connect to the Azure Data Lake Storage and PostgreSQL database, respectively. The <code>gld_example</code> asset uses these resources to query data from the Azure Data Lake Storage and copy it to the PostgreSQL database. All the logic is encapsulated in the <code>dagster-cfwb</code> library, which makes it very easy to reuse this code.</p>
<h2 id="üìñ-level-up-the-data-literacy" tabindex="-1">üìñ Level up the data literacy <a class="header-anchor" href="#üìñ-level-up-the-data-literacy" aria-label="Permalink to &quot;üìñ Level up the data literacy&quot;">&ZeroWidthSpace;</a></h2>
<p>As stated in the introduction, in our organisation very few people are trained in data management and programmation. To overcome this challenge, we communicate a lot about our data platform, we train our users, and we provide them with the necessary tools to understand and use the data platform.</p>
<h3 id="communicate-about-the-data-platform" tabindex="-1">Communicate about the data platform <a class="header-anchor" href="#communicate-about-the-data-platform" aria-label="Permalink to &quot;Communicate about the data platform&quot;">&ZeroWidthSpace;</a></h3>
<p>Like show in this image below, we try to use simple yet powerful images to explain the data platform and its components. This helps a lot our stakeholders to understand the data platform, and more importantly, the benefits it brings to the organization.</p>
<ImageCenter src="https://i.imgur.com/bEy2kU2.png" alt="" width="800" /><h3 id="train-the-users" tabindex="-1">Train the users <a class="header-anchor" href="#train-the-users" aria-label="Permalink to &quot;Train the users&quot;">&ZeroWidthSpace;</a></h3>
<p>We also provide training sessions to our users to help them understand the data platform and how to use it. These training sessions are tailored to the level of technical expertise of the users, and cover topics such as: SQL, Python, Git, Docker, Lakehouse, Data modeling, Data visualisation, etc.</p>
<ImageCenter src="https://i.imgur.com/GtduQZ6.png" alt="" width="400" /><ImageCenter src="https://i.imgur.com/zwhAa9D.png" alt="" width="400" /><h3 id="build-a-community-to-share-knowledge" tabindex="-1">Build a community to share knowledge <a class="header-anchor" href="#build-a-community-to-share-knowledge" aria-label="Permalink to &quot;Build a community to share knowledge&quot;">&ZeroWidthSpace;</a></h3>
<p>Last but not least, we try to build a <a href="https://en.wikipedia.org/wiki/Community_of_practice" target="_blank" rel="noreferrer">community or practices</a> of data analysts and data stewards to share knowledge and best practices. We call it &quot;Communaut√© des intendants de donn√©es&quot; (Community of Data Stewards). This community is open to all data analysts and data stewards in the organization, regardless of their level of technical expertise.</p>
<p>We organise regular meetings to discuss to share experiences, and help each other with the challenges we face. This helps to create a culture of data literacy and encourages users to participate in the development of data pipelines.</p>
<h2 id="conclusion" tabindex="-1">Conclusion <a class="header-anchor" href="#conclusion" aria-label="Permalink to &quot;Conclusion&quot;">&ZeroWidthSpace;</a></h2>
<p>In the series of articles, we have explored the implementation of a Data Platform based on Dagster for the F√©d√©ration Wallonie-Bruxelles (FWB). We have discussed the architecture of our data platform, the automation of our data pipelines, and how we lower the technical barrier for our users and improve their data literacy. We enjoyed building this data platform and we hope that this series of articles will help you to build your own data platform with Open Source tools.</p>
<p>We also hope that this series of articles will help you to understand the challenges of building a data platform in a polycephalous organization and how to overcome them.</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Comment savoir si on peut r√©utiliser un calendrier pour une ann√©e donn√©e en SQL ?]]></title>
            <link>localhost/blog/blog/posts/2025/how-to-reuse-a-calendar.html</link>
            <guid>localhost/blog/blog/posts/2025/how-to-reuse-a-calendar.html</guid>
            <pubDate>Wed, 26 Mar 2025 00:00:00 GMT</pubDate>
            <description><![CDATA[<p><strong>Executive summary</strong>: Comment savoir si on peut r√©utiliser un calendrier pour une ann√©e donn√©e en SQL ?</p>
]]></description>
            <content:encoded><![CDATA[<p><strong>Executive summary</strong>: Comment savoir si on peut r√©utiliser un calendrier pour une ann√©e donn√©e en SQL ?</p>
<hr>
<h1 id="comment-savoir-si-on-peut-reutiliser-un-calendrier-pour-une-annee-donnee-en-sql" tabindex="-1">Comment savoir si on peut r√©utiliser un calendrier pour une ann√©e donn√©e en SQL ? <a class="header-anchor" href="#comment-savoir-si-on-peut-reutiliser-un-calendrier-pour-une-annee-donnee-en-sql" aria-label="Permalink to &quot;Comment savoir si on peut r√©utiliser un calendrier pour une ann√©e donn√©e en SQL ?&quot;">&ZeroWidthSpace;</a></h1>
<p>Pour comparer les calendriers de plusieurs ann√©es, on peut suivre la simple logique suivante :</p>
<ul>
<li>Si le 1er janvier et le 1er mars tombent le m√™me jour de la semaine ;</li>
<li>Alors on peut r√©utiliser le calendrier de l'ann√©e pr√©c√©dente.</li>
</ul>
<p>On peut donc g√©n√©rer une cl√© compos√©e de 2 chiffres en base 7 (de <code>0</code> √† <code>6</code>) en fonction du jour de la semaine du 1er janvier et du 1er mars pour chaque ann√©e.</p>
<p>En joignant les calendriers de chaque ann√©e, on peut alors identifier les ann√©es o√π on peut r√©utiliser le calendrier de l'ann√©e pr√©c√©dente.</p>
<p>Et si on essayait de la faire en <strong>SQL</strong> ?</p>
<h2 id="experimentation-en-duckdb" tabindex="-1">Experimentation en DuckDB <a class="header-anchor" href="#experimentation-en-duckdb" aria-label="Permalink to &quot;Experimentation en DuckDB&quot;">&ZeroWidthSpace;</a></h2>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SET</span><span style="color: #BABED8"> VARIABLE start_year </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">2000</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">;</span></span>
<span class="line"><span style="color: #F78C6C">SET</span><span style="color: #BABED8"> VARIABLE end_year </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">2030-12-31</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">::</span><span style="color: #C792EA">date</span><span style="color: #BABED8">;</span></span>
<span class="line"><span style="color: #F78C6C">SET</span><span style="color: #BABED8"> VARIABLE first_jan </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">concat</span><span style="color: #BABED8">(getvariable(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">start_year</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">), </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">-01-01</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">)::</span><span style="color: #C792EA">date</span><span style="color: #BABED8">;</span></span>
<span class="line"><span style="color: #F78C6C">SET</span><span style="color: #BABED8"> VARIABLE first_march </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">concat</span><span style="color: #BABED8">(getvariable(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">start_year</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">), </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">-03-01</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">)::</span><span style="color: #C792EA">date</span><span style="color: #BABED8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F78C6C">WITH</span><span style="color: #BABED8"> t_january </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">YEAR</span><span style="color: #BABED8">(generate_series) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> current_year,</span></span>
<span class="line"><span style="color: #BABED8">        DAYOFWEEK(generate_series) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> wday</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">generate_series</span><span style="color: #BABED8">(</span></span>
<span class="line"><span style="color: #BABED8">        getvariable(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">first_jan</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">        getvariable(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">end_year</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">        INTERVAL </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">year</span></span>
<span class="line"><span style="color: #BABED8">    )</span></span>
<span class="line"><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">t_march </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">YEAR</span><span style="color: #BABED8">(generate_series) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> current_year,</span></span>
<span class="line"><span style="color: #BABED8">        DAYOFWEEK(generate_series) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> wday</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">generate_series</span><span style="color: #BABED8">(</span></span>
<span class="line"><span style="color: #BABED8">        getvariable(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">first_march</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">        getvariable(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">end_year</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">        INTERVAL </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">year</span></span>
<span class="line"><span style="color: #BABED8">    )</span></span>
<span class="line"><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">key_by_year </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">        t_january.current_year,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">concat</span><span style="color: #BABED8">(t_january.wday, t_march.wday) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> wday_key</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> t_january</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">JOIN</span><span style="color: #BABED8"> t_march</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #F78C6C">ON</span><span style="color: #BABED8"> t_january.current_year </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> t_march.current_year</span></span>
<span class="line"><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">calendars_joined </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">        k1.current_year,</span></span>
<span class="line"><span style="color: #BABED8">        k1.wday_key,</span></span>
<span class="line"><span style="color: #BABED8">        k2.current_year </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> compatible_year,</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> key_by_year </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> k1</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">JOIN</span><span style="color: #BABED8"> key_by_year </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> k2</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #F78C6C">ON</span><span style="color: #BABED8"> k1.wday_key </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> k2.wday_key</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> k1.current_year </span><span style="color: #89DDFF">!=</span><span style="color: #BABED8"> k2.current_year</span></span>
<span class="line"><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">    current_year,</span></span>
<span class="line"><span style="color: #BABED8">    array_agg(compatible_year </span><span style="color: #F78C6C">ORDER BY</span><span style="color: #BABED8"> compatible_year) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> same_wday_years</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> calendars_joined</span></span>
<span class="line"><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> current_year</span></span>
<span class="line"><span style="color: #F78C6C">ORDER BY</span><span style="color: #BABED8"> current_year;</span></span></code></pre>
</div><h1 id="et-voila" tabindex="-1">Et voil√† ! üéâ <a class="header-anchor" href="#et-voila" aria-label="Permalink to &quot;Et voil√† ! :tada:&quot;">&ZeroWidthSpace;</a></h1>
<table>
<thead>
<tr>
<th style="text-align:right">current_year</th>
<th>same_wday_years</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">2000</td>
<td>[2028]</td>
</tr>
<tr>
<td style="text-align:right">2001</td>
<td>[2007, 2018, 2029]</td>
</tr>
<tr>
<td style="text-align:right">2002</td>
<td>[2013, 2019, 2030]</td>
</tr>
<tr>
<td style="text-align:right">2003</td>
<td>[2014, 2025]</td>
</tr>
<tr>
<td style="text-align:right">2005</td>
<td>[2011, 2022]</td>
</tr>
<tr>
<td style="text-align:right">2006</td>
<td>[2017, 2023]</td>
</tr>
<tr>
<td style="text-align:right">2007</td>
<td>[2001, 2018, 2029]</td>
</tr>
<tr>
<td style="text-align:right">2009</td>
<td>[2015, 2026]</td>
</tr>
<tr>
<td style="text-align:right">2010</td>
<td>[2021, 2027]</td>
</tr>
<tr>
<td style="text-align:right">2011</td>
<td>[2005, 2022]</td>
</tr>
<tr>
<td style="text-align:right">2013</td>
<td>[2002, 2019, 2030]</td>
</tr>
<tr>
<td style="text-align:right">2014</td>
<td>[2003, 2025]</td>
</tr>
<tr>
<td style="text-align:right">2015</td>
<td>[2009, 2026]</td>
</tr>
<tr>
<td style="text-align:right">2017</td>
<td>[2006, 2023]</td>
</tr>
<tr>
<td style="text-align:right">2018</td>
<td>[2001, 2007, 2029]</td>
</tr>
<tr>
<td style="text-align:right">2019</td>
<td>[2002, 2013, 2030]</td>
</tr>
<tr>
<td style="text-align:right">2021</td>
<td>[2010, 2027]</td>
</tr>
<tr>
<td style="text-align:right">2022</td>
<td>[2005, 2011]</td>
</tr>
<tr>
<td style="text-align:right">2023</td>
<td>[2006, 2017]</td>
</tr>
<tr>
<td style="text-align:right">2025</td>
<td>[2003, 2014]</td>
</tr>
<tr>
<td style="text-align:right">2026</td>
<td>[2009, 2015]</td>
</tr>
<tr>
<td style="text-align:right">2027</td>
<td>[2010, 2021]</td>
</tr>
<tr>
<td style="text-align:right">2028</td>
<td>[2000]</td>
</tr>
<tr>
<td style="text-align:right">2029</td>
<td>[2001, 2007, 2018]</td>
</tr>
<tr>
<td style="text-align:right">2030</td>
<td>[2002, 2013, 2019]</td>
</tr>
</tbody>
</table>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Address lookup - Part 2b: Messing around]]></title>
            <link>localhost/blog/blog/posts/2024/address_lookup-part2b-messing-around.html</link>
            <guid>localhost/blog/blog/posts/2024/address_lookup-part2b-messing-around.html</guid>
            <pubDate>Tue, 03 Dec 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[<p><em>Executive summary</em>: In Belgium, a collaborative effort between regional and federal authorities has led to the creation of a unified service that aggregates all Belgian addresses into a comprehensive dataset. This dataset is called <a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BeStAddress</a>.</p>
]]></description>
            <content:encoded><![CDATA[<p><em>Executive summary</em>: In Belgium, a collaborative effort between regional and federal authorities has led to the creation of a unified service that aggregates all Belgian addresses into a comprehensive dataset. This dataset is called <a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BeStAddress</a>.</p>
<hr>
<h1 id="address-lookup-part-2b-messing-around" tabindex="-1">Address lookup - Part 2b: Messing around <a class="header-anchor" href="#address-lookup-part-2b-messing-around" aria-label="Permalink to &quot;Address lookup - Part 2b: Messing around&quot;">&ZeroWidthSpace;</a></h1>
<p>This post is a continuation of the <a href="/blog/posts/2024/address_lookup-part2-sourcing.html">previous post</a> where we have analyzed the data model of the BeStAddress dataset.</p>
<h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">&ZeroWidthSpace;</a></h2>
<p>In Belgium, each municipality is responsible for naming its streets. <a href="https://www.ibz.rrn.fgov.be/fileadmin/user_upload/fr/rn/circulaires/BeSt_20201104_F.pdf" target="_blank" rel="noreferrer">Although it is recommended to avoid similar street names</a>, this can sometimes result in two streets within the same municipality having very similar names. In this post, we will explore the <strong>BeStAddress dataset</strong> to identify pairs of streets with similar names that are geographically close to each other.</p>
<p>To analyse this, we will use the <a href="/blog/posts/2024/address_lookup-part2-sourcing.html">unified table that aggregates all the data from the different regions of Belgium</a> to find pairs of streets with similar names that are close to each other.</p>
<p>We will proceed in three steps:</p>
<ol>
<li>Find the average latitude and longitude of each street in each municipality.</li>
<li>Calculate the distance between each pair of streets in the same municipality.</li>
<li>Calculate the Levenshtein distance between the street names of each pair of streets.</li>
</ol>
<h2 id="step-1-find-the-average-latitude-and-longitude-of-street-in-each-municipality" tabindex="-1">Step 1: Find the average latitude and longitude of street in each municipality <a class="header-anchor" href="#step-1-find-the-average-latitude-and-longitude-of-street-in-each-municipality" aria-label="Permalink to &quot;Step 1: Find the average latitude and longitude of street in each municipality&quot;">&ZeroWidthSpace;</a></h2>
<p>This step will allow us to identify the geographical center of each street in the dataset and then use this information to calculate the distance between pairs of streets.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">WITH</span><span style="color: #BABED8"> averages_by_streets </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">             street_id,</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #82AAFF">round</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">AVG</span><span style="color: #BABED8">(latitude), </span><span style="color: #F78C6C">4</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> latitude,</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #82AAFF">round</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">AVG</span><span style="color: #BABED8">(longitude), </span><span style="color: #F78C6C">4</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> longitude,</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> municipality_id, street_id</span></span>
<span class="line"><span style="color: #BABED8">  )</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> averages_by_streets</span></span></code></pre>
</div><h2 id="step-2-distance-calculation" tabindex="-1">Step 2. Distance Calculation <a class="header-anchor" href="#step-2-distance-calculation" aria-label="Permalink to &quot;Step 2. Distance Calculation&quot;">&ZeroWidthSpace;</a></h2>
<p>We will calculate the distance between each pair of streets in the same municipality. We will use the <strong>Haversine formula</strong> to calculate the distance between two points on the Earth's surface given their latitude and longitude.</p>
<p>After calculating the distance between each pair of streets, we will filter the results to only include pairs of streets that are less than 5 kilometers apart.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">WITH</span><span style="color: #BABED8"> averages_by_streets </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">             street_id,</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #82AAFF">round</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">AVG</span><span style="color: #BABED8">(latitude), </span><span style="color: #F78C6C">4</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> latitude,</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #82AAFF">round</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">AVG</span><span style="color: #BABED8">(longitude), </span><span style="color: #F78C6C">4</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> longitude,</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> postcode </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">4140</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8"> </span><span style="color: #676E95; font-style: italic">-- Filter by municipality_id == Sprimont</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> municipality_id, street_id</span></span>
<span class="line"><span style="color: #BABED8">  ),</span></span>
<span class="line"><span style="color: #BABED8">combination_streets </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> a.municipality_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> municipality_id_1,</span></span>
<span class="line"><span style="color: #BABED8">           a.street_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> street_id_1,</span></span>
<span class="line"><span style="color: #BABED8">           a.latitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> lat1,</span></span>
<span class="line"><span style="color: #BABED8">           a.longitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> lon1,</span></span>
<span class="line"><span style="color: #BABED8">           b.municipality_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> municipality_id_2,</span></span>
<span class="line"><span style="color: #BABED8">           b.street_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> street_id_2,</span></span>
<span class="line"><span style="color: #BABED8">           b.latitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> lat2,</span></span>
<span class="line"><span style="color: #BABED8">           b.longitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> lon2</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> averages_by_streets a</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">CROSS JOIN</span><span style="color: #BABED8"> averages_by_streets b</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> (a.municipality_id, a.street_id) </span><span style="color: #89DDFF">&lt;&gt;</span><span style="color: #BABED8"> (b.municipality_id, b.street_id) </span><span style="color: #676E95; font-style: italic">-- Exclude self-joins</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> (a.municipality_id </span><span style="color: #89DDFF">&lt;</span><span style="color: #BABED8"> b.municipality_id</span></span>
<span class="line"><span style="color: #BABED8">           </span><span style="color: #F78C6C">OR</span><span style="color: #BABED8"> (a.municipality_id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> b.municipality_id </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> a.street_id </span><span style="color: #89DDFF">&lt;</span><span style="color: #BABED8"> b.street_id)</span></span>
<span class="line"><span style="color: #BABED8">        )  </span><span style="color: #676E95; font-style: italic">-- Ensure unique pairs</span></span>
<span class="line"><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">distance_calculation </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> municipality_id_1,</span></span>
<span class="line"><span style="color: #BABED8">           street_id_1,</span></span>
<span class="line"><span style="color: #BABED8">           municipality_id_2,</span></span>
<span class="line"><span style="color: #BABED8">           street_id_2,</span></span>
<span class="line"><span style="color: #89DDFF">           </span><span style="color: #676E95; font-style: italic">-- Haversine Formula</span></span>
<span class="line"><span style="color: #89DDFF">           </span><span style="color: #676E95; font-style: italic">-- 6371 is the radius of the Earth in kilometers</span></span>
<span class="line"><span style="color: #89DDFF">           </span><span style="color: #676E95; font-style: italic">-- RADIANS converts degrees to radians</span></span>
<span class="line"><span style="color: #BABED8">           </span><span style="color: #F78C6C">6371</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">2</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ASIN</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">SQRT</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">POWER</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">SIN</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">RADIANS</span><span style="color: #BABED8">(lat2 </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> lat1) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">2</span><span style="color: #BABED8">), </span><span style="color: #F78C6C">2</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">+</span></span>
<span class="line"><span style="color: #BABED8">                                </span><span style="color: #82AAFF">COS</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">RADIANS</span><span style="color: #BABED8">(lat1)) </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">COS</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">RADIANS</span><span style="color: #BABED8">(lat2)) </span><span style="color: #89DDFF">*</span></span>
<span class="line"><span style="color: #BABED8">                                </span><span style="color: #82AAFF">POWER</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">SIN</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">RADIANS</span><span style="color: #BABED8">(lon2 </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> lon1) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">2</span><span style="color: #BABED8">), </span><span style="color: #F78C6C">2</span><span style="color: #BABED8">))) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> distance_km</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> combination_streets</span></span>
<span class="line"><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> municipality_id_1,</span></span>
<span class="line"><span style="color: #BABED8">       street_id_1,</span></span>
<span class="line"><span style="color: #BABED8">       municipality_id_2,</span></span>
<span class="line"><span style="color: #BABED8">       street_id_2,</span></span>
<span class="line"><span style="color: #BABED8">       </span><span style="color: #82AAFF">round</span><span style="color: #BABED8">(distance_km, </span><span style="color: #F78C6C">2</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> distance_km</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> distance_calculation</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> distance_km </span><span style="color: #89DDFF">&lt;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">5</span><span style="color: #BABED8">;</span></span></code></pre>
</div><h2 id="step-3-levenshtein-distance-calculation" tabindex="-1">Step 3. Levenshtein Distance Calculation <a class="header-anchor" href="#step-3-levenshtein-distance-calculation" aria-label="Permalink to &quot;Step 3. Levenshtein Distance Calculation&quot;">&ZeroWidthSpace;</a></h2>
<p>Finally, we will calculate the Levenshtein distance between the street names of each pair of streets. The Levenshtein distance is a measure of the similarity between two strings. It is defined as the minimum number of single-character edits (insertions, deletions, or substitutions) required to change one string into the other.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">WITH</span><span style="color: #BABED8"> averages_by_streets </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">             street_id,</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #82AAFF">round</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">AVG</span><span style="color: #BABED8">(latitude), </span><span style="color: #F78C6C">4</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> latitude,</span></span>
<span class="line"><span style="color: #BABED8">             </span><span style="color: #82AAFF">round</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">AVG</span><span style="color: #BABED8">(longitude), </span><span style="color: #F78C6C">4</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> longitude,</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> postcode </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">4140</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8"> </span><span style="color: #676E95; font-style: italic">-- Filter by municipality_id == Sprimont</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> municipality_id, street_id</span></span>
<span class="line"><span style="color: #BABED8">  ),</span></span>
<span class="line"><span style="color: #BABED8">unique_streetname </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">           street_id,</span></span>
<span class="line"><span style="color: #BABED8">           default_streetname</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">1</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> street_id </span><span style="color: #F78C6C">IN</span><span style="color: #BABED8"> (</span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> street_id </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> averages_by_streets)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> municipality_id </span><span style="color: #F78C6C">IN</span><span style="color: #BABED8"> (</span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> municipality_id </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> averages_by_streets)</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> ALL</span></span>
<span class="line"><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">combination_streets </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> a.municipality_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> municipality_id_1,</span></span>
<span class="line"><span style="color: #BABED8">           a.street_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> street_id_1,</span></span>
<span class="line"><span style="color: #BABED8">           a.latitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> lat1,</span></span>
<span class="line"><span style="color: #BABED8">           a.longitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> lon1,</span></span>
<span class="line"><span style="color: #BABED8">           b.municipality_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> municipality_id_2,</span></span>
<span class="line"><span style="color: #BABED8">           b.street_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> street_id_2,</span></span>
<span class="line"><span style="color: #BABED8">           b.latitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> lat2,</span></span>
<span class="line"><span style="color: #BABED8">           b.longitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> lon2</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> averages_by_streets a</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">CROSS JOIN</span><span style="color: #BABED8"> averages_by_streets b</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> (a.municipality_id, a.street_id) </span><span style="color: #89DDFF">&lt;&gt;</span><span style="color: #BABED8"> (b.municipality_id, b.street_id) </span><span style="color: #676E95; font-style: italic">-- Exclude self-joins</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> (a.municipality_id </span><span style="color: #89DDFF">&lt;</span><span style="color: #BABED8"> b.municipality_id</span></span>
<span class="line"><span style="color: #BABED8">           </span><span style="color: #F78C6C">OR</span><span style="color: #BABED8"> (a.municipality_id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> b.municipality_id </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> a.street_id </span><span style="color: #89DDFF">&lt;</span><span style="color: #BABED8"> b.street_id)</span></span>
<span class="line"><span style="color: #BABED8">        )  </span><span style="color: #676E95; font-style: italic">-- Ensure unique pairs</span></span>
<span class="line"><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">distance_calculation </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> municipality_id_1,</span></span>
<span class="line"><span style="color: #BABED8">           street_id_1,</span></span>
<span class="line"><span style="color: #BABED8">           municipality_id_2,</span></span>
<span class="line"><span style="color: #BABED8">           street_id_2,</span></span>
<span class="line"><span style="color: #89DDFF">           </span><span style="color: #676E95; font-style: italic">-- Haversine Formula</span></span>
<span class="line"><span style="color: #89DDFF">           </span><span style="color: #676E95; font-style: italic">-- 6371 is the radius of the Earth in kilometers</span></span>
<span class="line"><span style="color: #89DDFF">           </span><span style="color: #676E95; font-style: italic">-- RADIANS converts degrees to radians</span></span>
<span class="line"><span style="color: #BABED8">           </span><span style="color: #F78C6C">6371</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">2</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">ASIN</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">SQRT</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">POWER</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">SIN</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">RADIANS</span><span style="color: #BABED8">(lat2 </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> lat1) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">2</span><span style="color: #BABED8">), </span><span style="color: #F78C6C">2</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">+</span></span>
<span class="line"><span style="color: #BABED8">                                </span><span style="color: #82AAFF">COS</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">RADIANS</span><span style="color: #BABED8">(lat1)) </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">COS</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">RADIANS</span><span style="color: #BABED8">(lat2)) </span><span style="color: #89DDFF">*</span></span>
<span class="line"><span style="color: #BABED8">                                </span><span style="color: #82AAFF">POWER</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">SIN</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">RADIANS</span><span style="color: #BABED8">(lon2 </span><span style="color: #89DDFF">-</span><span style="color: #BABED8"> lon1) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">2</span><span style="color: #BABED8">), </span><span style="color: #F78C6C">2</span><span style="color: #BABED8">))) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> distance_km</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> combination_streets</span></span>
<span class="line"><span style="color: #BABED8">), combination_with_distances_filtered </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> municipality_id_1,</span></span>
<span class="line"><span style="color: #BABED8">       street_id_1,</span></span>
<span class="line"><span style="color: #BABED8">       municipality_id_2,</span></span>
<span class="line"><span style="color: #BABED8">       street_id_2,</span></span>
<span class="line"><span style="color: #BABED8">       </span><span style="color: #82AAFF">round</span><span style="color: #BABED8">(distance_km, </span><span style="color: #F78C6C">2</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> distance_km</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> distance_calculation</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> distance_km </span><span style="color: #89DDFF">&lt;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">5</span></span>
<span class="line"><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">levenstein_distance </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">    municipality_id_1,</span></span>
<span class="line"><span style="color: #BABED8">    street_id_1,</span></span>
<span class="line"><span style="color: #BABED8">    municipality_id_2,</span></span>
<span class="line"><span style="color: #BABED8">    street_id_2,</span></span>
<span class="line"><span style="color: #BABED8">    distance_km,</span></span>
<span class="line"><span style="color: #BABED8">    a.default_streetname </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> streetname_1,</span></span>
<span class="line"><span style="color: #BABED8">    b.default_streetname </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> streetname_2,</span></span>
<span class="line"><span style="color: #BABED8">    levenshtein(a.default_streetname, b.default_streetname) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> levenshtein_distance</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> combination_with_distances_filtered</span></span>
<span class="line"><span style="color: #F78C6C">LEFT JOIN</span><span style="color: #BABED8"> unique_streetname </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> a</span></span>
<span class="line"><span style="color: #BABED8">   </span><span style="color: #F78C6C">ON</span><span style="color: #BABED8"> a.municipality_id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> municipality_id_1</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> a.street_id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> street_id_1</span></span>
<span class="line"><span style="color: #F78C6C">LEFT JOIN</span><span style="color: #BABED8"> unique_streetname </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> b</span></span>
<span class="line"><span style="color: #BABED8">   </span><span style="color: #F78C6C">ON</span><span style="color: #BABED8"> b.municipality_id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> municipality_id_2</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> b.street_id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> street_id_2</span></span>
<span class="line"><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> levenstein_distance</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">1</span></span>
<span class="line"><span style="color: #BABED8">   </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> levenshtein_distance </span><span style="color: #89DDFF">&lt;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">10</span></span>
<span class="line"><span style="color: #BABED8">   </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> levenshtein_distance </span><span style="color: #89DDFF">&gt;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">0</span></span>
<span class="line"><span style="color: #F78C6C">ORDER BY</span><span style="color: #BABED8"> levenshtein_distance, distance_km;</span></span></code></pre>
</div><p>That's it! We have successfully identified pairs of streets with similar names that are geographically close to each other. It is a long query, but it is very powerful and can be used to identify potential issues with street names in the BeStAddress dataset.</p>
<h2 id="results" tabindex="-1">Results <a class="header-anchor" href="#results" aria-label="Permalink to &quot;Results&quot;">&ZeroWidthSpace;</a></h2>
<table>
<thead>
<tr>
<th style="text-align:right">municipality_id_1</th>
<th style="text-align:right">street_id_1</th>
<th style="text-align:right">municipality_id_2</th>
<th style="text-align:right">street_id_2</th>
<th style="text-align:right">distance_km</th>
<th>streetname_1</th>
<th>streetname_2</th>
<th style="text-align:right">levenshtein_distance</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7732983</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7732991</td>
<td style="text-align:right">4.16</td>
<td>Rue de Damr√©</td>
<td>Rue de Gomz√©</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7732996</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733018</td>
<td style="text-align:right">2.53</td>
<td>Rue de la Carri√®re</td>
<td>Rue de la Sabli√®re</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733062</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733067</td>
<td style="text-align:right">0.63</td>
<td>Rue des Fawes</td>
<td>Rue des Marets</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733110</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733117</td>
<td style="text-align:right">3.48</td>
<td>Rue du Roua</td>
<td>Rue du Vou√©</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7732981</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733047</td>
<td style="text-align:right">4.02</td>
<td>Rue de Coreux</td>
<td>Rue de Theux</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7732981</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733042</td>
<td style="text-align:right">1.13</td>
<td>Rue de Coreux</td>
<td>Rue de Rouvreux</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7732961</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733129</td>
<td style="text-align:right">0.27</td>
<td>Rue Basse Lill√©</td>
<td>Rue Haute Lill√©</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733092</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733108</td>
<td style="text-align:right">4.55</td>
<td>Rue du Coq</td>
<td>Rue du Pont</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733105</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7762862</td>
<td style="text-align:right">0.33</td>
<td>Rue du Pahy</td>
<td>Rue du Parc</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733124</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733132</td>
<td style="text-align:right">4.37</td>
<td>Rue Ferreuse</td>
<td>Rue Houreuse</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733123</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733124</td>
<td style="text-align:right">3.9</td>
<td>Rue Ferrer</td>
<td>Rue Ferreuse</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733081</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7762862</td>
<td style="text-align:right">2.6</td>
<td>Rue du Baron</td>
<td>Rue du Parc</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733083</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7762862</td>
<td style="text-align:right">1.66</td>
<td>Rue du Baty</td>
<td>Rue du Parc</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733083</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733105</td>
<td style="text-align:right">1.99</td>
<td>Rue du Baty</td>
<td>Rue du Pahy</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733081</td>
<td style="text-align:right">62100</td>
<td style="text-align:right">7733083</td>
<td style="text-align:right">3.85</td>
<td>Rue du Baron</td>
<td>Rue du Baty</td>
<td style="text-align:right">3</td>
</tr>
</tbody>
</table>
<h2 id="further-exploration" tabindex="-1">Further exploration <a class="header-anchor" href="#further-exploration" aria-label="Permalink to &quot;Further exploration&quot;">&ZeroWidthSpace;</a></h2>
<ImageCenter src="https://i.giphy.com/media/v1.Y2lkPTc5MGI3NjExZTZ6NW5nbXU2Z3hudGszMDljM3lodjR3bHJyZ3Zva3VvZTF5Z3ZqYyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/KEXq9JVp3OyZmxZw0W/giphy.gif" alt="Further exploration" width="800" /><p>The BeStAddress dataset offers numerous opportunities for interesting analyses beyond just finding similar street names. Let's explore some additional queries that can help us understand the dataset better and potentially identify areas for improvement in address management.</p>
<h3 id="_1-mapping-street-relationships-within-municipalities" tabindex="-1">1. Mapping Street Relationships Within Municipalities <a class="header-anchor" href="#_1-mapping-street-relationships-within-municipalities" aria-label="Permalink to &quot;1. Mapping Street Relationships Within Municipalities&quot;">&ZeroWidthSpace;</a></h3>
<p>When working with addresses, it's often useful to understand how streets are distributed within municipalities. This query helps us identify all unique pairs of streets within each municipality, which can be valuable for:</p>
<ul>
<li>Urban planning analysis</li>
<li>Understanding street network connectivity</li>
<li>Identifying potential naming conflicts</li>
</ul>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight has-diff" ><code><span class="line"><span style="color: #F78C6C">WITH</span><span style="color: #BABED8"> DistinctStreets </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">        municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">        street_id,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">round</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">avg</span><span style="color: #BABED8">(latitude), </span><span style="color: #F78C6C">3</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> latitude, </span><span style="color: #676E95; font-style: italic">-- Round to 3 decimal places (= ~110 meters)</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">round</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">avg</span><span style="color: #BABED8">(longitude), </span><span style="color: #F78C6C">3</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> longitude</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span></span>
<span class="line"><span style="color: #BABED8">        bestAddress</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">GROUP BY</span></span>
<span class="line"><span style="color: #BABED8">        municipality_id, street_id</span></span>
<span class="line"><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">    a.municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">    a.street_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> first_street_id,</span></span>
<span class="line"><span style="color: #BABED8">    b.street_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> second_street_id,</span></span>
<span class="line"><span style="color: #BABED8">    a.latitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> first_street_latitude,</span></span>
<span class="line"><span style="color: #BABED8">    a.longitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> first_street_longitude,</span></span>
<span class="line"><span style="color: #BABED8">    b.latitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> second_street_latitude,</span></span>
<span class="line"><span style="color: #BABED8">    b.longitude </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> second_street_longitude</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span></span>
<span class="line"><span style="color: #BABED8">    DistinctStreets </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> a</span></span>
<span class="line"><span style="color: #F78C6C">JOIN</span></span>
<span class="line"><span style="color: #BABED8">    DistinctStreets </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> b</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">ON</span><span style="color: #BABED8"> a.municipality_id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> b.municipality_id </span><span style="color: #676E95; font-style: italic">-- Same municipality</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> a.street_id </span><span style="color: #89DDFF">&lt;</span><span style="color: #BABED8"> b.street_id </span><span style="color: #676E95; font-style: italic">-- Ensure different street ids and avoid duplicate combinations</span></span>
<span class="line"><span style="color: #F78C6C">ORDER BY</span></span>
<span class="line"><span style="color: #BABED8">    a.municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">    a.street_id,</span></span>
<span class="line"><span style="color: #BABED8">    b.street_id</span></span>
<span class="line"><span style="color: #F78C6C">LIMIT</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">;</span></span></code></pre>
</div><p>The query uses a self-join technique to pair each street with every other street in the same municipality, while avoiding duplicate combinations. We round the coordinates to 3 decimal places (~110 meters precision) to simplify the data while maintaining meaningful geographical precision.</p>
<h3 id="_2-analyzing-multilingual-street-name-coverage" tabindex="-1">2. Analyzing Multilingual Street Name Coverage <a class="header-anchor" href="#_2-analyzing-multilingual-street-name-coverage" aria-label="Permalink to &quot;2. Analyzing Multilingual Street Name Coverage&quot;">&ZeroWidthSpace;</a></h3>
<p>Belgium's multilingual nature makes it essential to understand how well street names are documented in different languages. This query analyzes the completeness of street names across French, Dutch, and German:</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">WITH</span><span style="color: #BABED8"> DistinctStreets </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> municipality_id, street_id, streetname_fr, streetname_de, streetname_nl</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span></span>
<span class="line"><span style="color: #BABED8">        BestAddress</span></span>
<span class="line"><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">    municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> total_streets,</span></span>
<span class="line"><span style="color: #BABED8">    (</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">CASE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">WHEN</span><span style="color: #BABED8"> streetname_fr </span><span style="color: #F78C6C">IS NOT NULL</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">THEN</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">END</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CAST</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FLOAT</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> pct_streetname_fr,</span></span>
<span class="line"><span style="color: #BABED8">    (</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">CASE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">WHEN</span><span style="color: #BABED8"> streetname_de </span><span style="color: #F78C6C">IS NOT NULL</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">THEN</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">END</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CAST</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FLOAT</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> pct_streetname_de,</span></span>
<span class="line"><span style="color: #BABED8">    (</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">CASE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">WHEN</span><span style="color: #BABED8"> streetname_nl </span><span style="color: #F78C6C">IS NOT NULL</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">THEN</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">END</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CAST</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FLOAT</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> pct_streetname_nl</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span></span>
<span class="line"><span style="color: #BABED8">    DistinctStreets</span></span>
<span class="line"><span style="color: #F78C6C">GROUP BY</span></span>
<span class="line"><span style="color: #BABED8">    municipality_id;</span></span></code></pre>
</div><p>This query provides insights into:</p>
<ul>
<li>The completeness of multilingual street naming</li>
<li>Potential gaps in language coverage</li>
<li>Areas that might need attention for complete multilingual support</li>
</ul>
<h3 id="_3-identifying-language-border-municipalities" tabindex="-1">3. Identifying Language Border Municipalities <a class="header-anchor" href="#_3-identifying-language-border-municipalities" aria-label="Permalink to &quot;3. Identifying Language Border Municipalities&quot;">&ZeroWidthSpace;</a></h3>
<p>Perhaps the most interesting analysis is finding municipalities that lie on language borders. These can be identified by looking for municipalities where street names aren't consistently available in all languages:</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">WITH</span><span style="color: #BABED8"> DistinctStreets </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">          </span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> municipality_id, street_id, streetname_fr, streetname_de, streetname_nl, region_code</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">FROM</span></span>
<span class="line"><span style="color: #BABED8">          BestAddress</span></span>
<span class="line"><span style="color: #BABED8">  )</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">      municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">      region_code,</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> total_streets,</span></span>
<span class="line"><span style="color: #BABED8">      (</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">CASE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">WHEN</span><span style="color: #BABED8"> streetname_fr </span><span style="color: #F78C6C">IS NOT NULL</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">THEN</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">END</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CAST</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FLOAT</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> pct_streetname_fr,</span></span>
<span class="line"><span style="color: #BABED8">      (</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">CASE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">WHEN</span><span style="color: #BABED8"> streetname_de </span><span style="color: #F78C6C">IS NOT NULL</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">THEN</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">END</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CAST</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FLOAT</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> pct_streetname_de,</span></span>
<span class="line"><span style="color: #BABED8">      (</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">CASE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">WHEN</span><span style="color: #BABED8"> streetname_nl </span><span style="color: #F78C6C">IS NOT NULL</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">THEN</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">END</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CAST</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FLOAT</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> pct_streetname_nl</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F78C6C">FROM</span></span>
<span class="line"><span style="color: #BABED8">      DistinctStreets</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F78C6C">GROUP BY</span></span>
<span class="line"><span style="color: #BABED8">      municipality_id, region_code</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F78C6C">HAVING</span></span>
<span class="line"><span style="color: #BABED8">      (</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">CASE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">WHEN</span><span style="color: #BABED8"> streetname_fr </span><span style="color: #F78C6C">IS NOT NULL</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">THEN</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">END</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CAST</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FLOAT</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">NOT</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">IN</span><span style="color: #BABED8"> (</span><span style="color: #F78C6C">0</span><span style="color: #BABED8">, </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">OR</span><span style="color: #BABED8"> (</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">CASE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">WHEN</span><span style="color: #BABED8"> streetname_de </span><span style="color: #F78C6C">IS NOT NULL</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">THEN</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">END</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CAST</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FLOAT</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">NOT</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">IN</span><span style="color: #BABED8"> (</span><span style="color: #F78C6C">0</span><span style="color: #BABED8">, </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">OR</span><span style="color: #BABED8"> (</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">CASE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">WHEN</span><span style="color: #BABED8"> streetname_nl </span><span style="color: #F78C6C">IS NOT NULL</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">THEN</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">END</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">/</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">CAST</span><span style="color: #BABED8">(</span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FLOAT</span><span style="color: #BABED8">) </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">NOT</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">IN</span><span style="color: #BABED8"> (</span><span style="color: #F78C6C">0</span><span style="color: #BABED8">, </span><span style="color: #F78C6C">100</span><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #F78C6C">ORDER BY</span></span>
<span class="line"><span style="color: #BABED8">      region_code;</span></span></code></pre>
</div><p>This advanced query helps identify:</p>
<ul>
<li>Municipalities on language borders</li>
<li>Areas with mixed language usage</li>
<li>Potential inconsistencies in multilingual street naming</li>
</ul>
<p>The HAVING clause specifically looks for municipalities where the percentage of street names in any language is neither 0% nor 100%, indicating mixed language usage. This can be particularly useful for:</p>
<ul>
<li>Understanding linguistic diversity in different regions</li>
<li>Planning multilingual signage requirements</li>
<li>Ensuring proper address documentation in all relevant languages</li>
</ul>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Address lookup - Part 2 - Sourcing]]></title>
            <link>localhost/blog/blog/posts/2024/address_lookup-part2-sourcing.html</link>
            <guid>localhost/blog/blog/posts/2024/address_lookup-part2-sourcing.html</guid>
            <pubDate>Fri, 01 Nov 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[<p><em>Executive summary</em>: In Belgium, a collaborative effort between regional and federal authorities has led to the creation of a unified service that aggregates all Belgian addresses into a comprehensive dataset. This dataset is called <a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BeStAddress</a>.</p>
]]></description>
            <content:encoded><![CDATA[<p><em>Executive summary</em>: In Belgium, a collaborative effort between regional and federal authorities has led to the creation of a unified service that aggregates all Belgian addresses into a comprehensive dataset. This dataset is called <a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BeStAddress</a>.</p>
<hr>
<h1 id="address-lookup-sourcing-2" tabindex="-1">Address lookup - Sourcing (2) <a class="header-anchor" href="#address-lookup-sourcing-2" aria-label="Permalink to &quot;Address lookup - Sourcing (2)&quot;">&ZeroWidthSpace;</a></h1>
<h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">&ZeroWidthSpace;</a></h2>
<p>In the <a href="/blog/posts/2024/address_lookup-part1-problematic.html">previous post</a>, we have analyzed the data model of the BeStAddress dataset. In this post, we will focus on building a unified table that aggregates all the data from the different regions of Belgium. It will be the first step to build an address lookup service.</p>
<h2 id="sources" tabindex="-1">Sources <a class="header-anchor" href="#sources" aria-label="Permalink to &quot;Sources&quot;">&ZeroWidthSpace;</a></h2>
<p>The BeStAddress dataset is composed of different tables. For facilitating the exploration, we used the CSV files provided by the BeStAddress service. XML and Web service is also available -- however XML is harder to parse and the API needs to register and get an API key.</p>
<p>The data is split into three regions:</p>
<ul>
<li>BeVlg: Flanders</li>
<li>BeBru: Brussels</li>
<li>BeWal: Wallonia</li>
</ul>
<p>As shown in the previous article, the data model is similar for the three regions -- but the model is not very obvious. For this reason, we will create a unified table that will be easier to work with. The concept of <a href="https://dataengineering.wiki/Concepts/One+Big+Table" target="_blank" rel="noreferrer"><strong>One Big Table</strong></a> designs are amazing for performance in analytics (expecially with OLAP system) but can be a <a href="/blog/posts/2024/address_lookup-part1-problematic.html">nightmare for data analysis and data quality</a>.</p>
<h2 id="downloading-the-data" tabindex="-1">Downloading the data <a class="header-anchor" href="#downloading-the-data" aria-label="Permalink to &quot;Downloading the data&quot;">&ZeroWidthSpace;</a></h2>
<p>We will use <strong><a href="https://dagster.io" target="_blank" rel="noreferrer">Dagster</a></strong> to download the data and <strong><a href="https://duckdb.org" target="_blank" rel="noreferrer">DuckDB</a></strong> create the big table. Using Dagster will allow us to define a pipeline that will download the data from the different regions and store it in a local database. It will be easy to run the pipeline again if we need to update the data and we can also use Dagster to monitor the data quality.</p>
<h3 id="defining-the-asset-in-dagster" tabindex="-1">Defining the asset in Dagster <a class="header-anchor" href="#defining-the-asset-in-dagster" aria-label="Permalink to &quot;Defining the asset in Dagster&quot;">&ZeroWidthSpace;</a></h3>
<div class="language-python"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #BABED8">specs </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">[]</span></span>
<span class="line"><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #BABED8"> table </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #BABED8"> bestAddress_zones</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    output_name </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">raw_bestAddress_</span><span style="color: #89DDFF">&quot;</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">+</span><span style="color: #BABED8"> table</span></span>
<span class="line"><span style="color: #BABED8">    specs</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">append</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">AssetSpec</span><span style="color: #89DDFF">(</span><span style="color: #BABED8; font-style: italic">key</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">output_name</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #BABED8; font-style: italic">kinds</span><span style="color: #89DDFF">={</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">duckdb</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">azure</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">pandas</span><span style="color: #89DDFF">&#39;</span><span style="color: #89DDFF">}))</span></span>
<span class="line"></span>
<span class="line"><span style="color: #89DDFF">@</span><span style="color: #82AAFF">multi_asset</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #BABED8; font-style: italic">group_name</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">raw</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #BABED8; font-style: italic">specs</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">specs</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #BABED8; font-style: italic">can_subset</span><span style="color: #89DDFF">=False,</span></span>
<span class="line"><span style="color: #82AAFF">    </span><span style="color: #BABED8; font-style: italic">description</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">The complete BestAddress files loaded into a DuckDB</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #C792EA">def</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">raw_bestaddress_tables</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #BABED8; font-style: italic">context</span><span style="color: #89DDFF">,</span><span style="color: #BABED8"> </span><span style="color: #BABED8; font-style: italic">duckdb_bestAddress</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> DuckDBResource</span></span>
<span class="line"><span style="color: #89DDFF">)</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">-&gt;</span><span style="color: #BABED8"> MaterializeResult</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #89DDFF; font-style: italic">for</span><span style="color: #BABED8"> table_name </span><span style="color: #89DDFF; font-style: italic">in</span><span style="color: #BABED8"> bestAddress_zones</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">        url </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #BABED8">            </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">https://opendata.bosa.be/download/best/openaddress-</span><span style="color: #89DDFF">&quot;</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">+</span><span style="color: #BABED8"> table_name </span><span style="color: #89DDFF">+</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">.zip</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        r </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> requests</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">get</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">url</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #BABED8">        z </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> zipfile</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">ZipFile</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">io</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">BytesIO</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">r</span><span style="color: #89DDFF">.</span><span style="color: #F07178">content</span><span style="color: #89DDFF">))</span></span>
<span class="line"><span style="color: #BABED8">        extract_location </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">/tmp/</span><span style="color: #89DDFF">&quot;</span></span>
<span class="line"><span style="color: #BABED8">        z</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">extractall</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">extract_location</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        df </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> pd</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">read_csv</span><span style="color: #89DDFF">(</span></span>
<span class="line"><span style="color: #82AAFF">            extract_location </span><span style="color: #89DDFF">+</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">openaddress-</span><span style="color: #89DDFF">&quot;</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">+</span><span style="color: #82AAFF"> table_name </span><span style="color: #89DDFF">+</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">.csv</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #BABED8; font-style: italic">dtype</span><span style="color: #89DDFF">=</span><span style="color: #FFCB6B">str</span></span>
<span class="line"><span style="color: #82AAFF">        </span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        asset_name </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">raw_bestAddress_</span><span style="color: #89DDFF">&quot;</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">+</span><span style="color: #BABED8"> table_name</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #89DDFF; font-style: italic">with</span><span style="color: #BABED8"> duckdb_bestAddress</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">get_connection</span><span style="color: #89DDFF">()</span><span style="color: #BABED8"> </span><span style="color: #89DDFF; font-style: italic">as</span><span style="color: #BABED8"> conn</span><span style="color: #89DDFF">:</span></span>
<span class="line"><span style="color: #BABED8">            conn</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">execute</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">&quot;CREATE OR REPLACE TABLE </span><span style="color: #F78C6C">{</span><span style="color: #82AAFF">table_name</span><span style="color: #F78C6C">}</span><span style="color: #C3E88D"> AS SELECT * FROM df&quot;</span><span style="color: #89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #BABED8">...</span></span></code></pre>
</div><h2 id="creating-the-unified-table" tabindex="-1">Creating the unified table <a class="header-anchor" href="#creating-the-unified-table" aria-label="Permalink to &quot;Creating the unified table&quot;">&ZeroWidthSpace;</a></h2>
<p>Once the data is downloaded, we can create a unified table that will aggregate the data from the different regions. We will use the <code>UNION ALL</code> operator to merge the data from the different regions. We will also create a <strong>unique identifier</strong> of fixed length for each address by concatenating the <code>municipality_id</code>, <code>street_id</code>, and <code>address_id</code>. This will allow us to easily have a single identifier for each address (will be handy for the address lookup service).</p>
<ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/best_address.drawio.png" alt="best address" width="800" /><p>We will also create some custom columns that will be useful. For example, we will create a <code>default_streetname</code> column that will contain the street name in the three languages. We will also create a <code>formatted_address1</code> and <code>formatted_address2</code> column that will contain the formatted address with the street name and the house number. Finally, we will rename <code>latitude</code> and <code>longitude</code> column that will contain the coordinates of the address.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">CREATE OR REPLACE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">TABLE</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">bestAddress</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AS</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">WITH</span><span style="color: #BABED8"> raw_data </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bevlg </span><span style="color: #676E95; font-style: italic">-- in practice we can also use the read_csv() function</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">UNION ALL</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bebru</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">UNION ALL</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bewal</span></span>
<span class="line"><span style="color: #BABED8">    ),</span></span>
<span class="line"><span style="color: #BABED8">    prepared_data </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> (</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">    concat_ws(</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">-</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">,</span></span>
<span class="line"><span style="color: #BABED8">      municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">      lpad(</span><span style="color: #82AAFF">cast</span><span style="color: #BABED8">(street_id </span><span style="color: #F78C6C">as</span><span style="color: #BABED8"> </span><span style="color: #C792EA">varchar</span><span style="color: #BABED8">), </span><span style="color: #F78C6C">8</span><span style="color: #BABED8">, </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">0</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">),</span></span>
<span class="line"><span style="color: #BABED8">      lpad(</span><span style="color: #82AAFF">cast</span><span style="color: #BABED8">(address_id </span><span style="color: #F78C6C">as</span><span style="color: #BABED8"> </span><span style="color: #C792EA">varchar</span><span style="color: #BABED8">), </span><span style="color: #F78C6C">8</span><span style="color: #BABED8">, </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">0</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #BABED8">    )</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> unique_id,</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">status</span><span style="color: #BABED8">,</span></span>
<span class="line"><span style="color: #BABED8">    streetname_fr,</span></span>
<span class="line"><span style="color: #BABED8">    streetname_de,</span></span>
<span class="line"><span style="color: #BABED8">    streetname_nl,</span></span>
<span class="line"><span style="color: #BABED8">    concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D"> / </span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">, streetname_fr, streetname_de, streetname_nl)</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> default_streetname,</span></span>
<span class="line"><span style="color: #BABED8">    house_number,</span></span>
<span class="line"><span style="color: #BABED8">    box_number,</span></span>
<span class="line"><span style="color: #BABED8">    concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D"> / </span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">, house_number, box_number)</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> full_house_number,</span></span>
<span class="line"><span style="color: #BABED8">    postcode,</span></span>
<span class="line"><span style="color: #BABED8">    municipality_name_fr,</span></span>
<span class="line"><span style="color: #BABED8">    municipality_name_de,</span></span>
<span class="line"><span style="color: #BABED8">    municipality_name_nl,</span></span>
<span class="line"><span style="color: #BABED8">       concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D"> / </span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">, municipality_name_fr, municipality_name_de, municipality_name_nl)</span></span>
<span class="line"><span style="color: #BABED8">         </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> default_municipality_name,</span></span>
<span class="line"><span style="color: #BABED8">       concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D"> / </span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">, postname_fr, postname_nl)</span></span>
<span class="line"><span style="color: #BABED8">         </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> default_postname,</span></span>
<span class="line"><span style="color: #BABED8">    postname_fr,</span></span>
<span class="line"><span style="color: #BABED8">    postname_nl,</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #82AAFF">concat</span><span style="color: #BABED8">(</span></span>
<span class="line"><span style="color: #BABED8">        concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D"> / </span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">, streetname_fr, streetname_de, streetname_nl), </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">,</span></span>
<span class="line"><span style="color: #BABED8">        concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">/</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">, house_number, box_number)</span></span>
<span class="line"><span style="color: #BABED8">    ) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> formatted_address1,</span></span>
<span class="line"><span style="color: #BABED8">    concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">, postcode,</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #82AAFF">coalesce</span><span style="color: #BABED8">(</span></span>
<span class="line"><span style="color: #BABED8">     concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D"> / </span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">, postname_fr, postname_nl),</span></span>
<span class="line"><span style="color: #BABED8">     concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D"> / </span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">, municipality_name_fr, municipality_name_de, municipality_name_nl)</span></span>
<span class="line"><span style="color: #BABED8">      )</span></span>
<span class="line"><span style="color: #BABED8">    ) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> formatted_address2,</span></span>
<span class="line"><span style="color: #BABED8">    region_code,</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #82AAFF">cast</span><span style="color: #BABED8">(municipality_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #C792EA">integer</span><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #82AAFF">cast</span><span style="color: #BABED8">(street_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #C792EA">integer</span><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> street_id,</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #82AAFF">cast</span><span style="color: #BABED8">(address_id </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #C792EA">integer</span><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> address_id,</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #82AAFF">cast</span><span style="color: #BABED8">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">EPSG:4326_lat</span><span style="color: #89DDFF">&quot;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FLOAT</span><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> latitude,</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #82AAFF">cast</span><span style="color: #BABED8">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">EPSG:4326_lon</span><span style="color: #89DDFF">&quot;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FLOAT</span><span style="color: #BABED8">)</span></span>
<span class="line"><span style="color: #BABED8">      </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> longitude</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> raw_data</span></span>
<span class="line"><span style="color: #BABED8">    )</span></span>
<span class="line"><span style="color: #BABED8">    </span><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">*</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> prepared_data</span></span></code></pre>
</div><ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/images/bestaddress-sourcing.png" alt="best address pipeline in Dagster" width="800" /><h2 id="next-steps" tabindex="-1">Next steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next steps&quot;">&ZeroWidthSpace;</a></h2>
<p>In the <a href="/blog/posts/2025/address_lookup-part3-api.html">next post</a>, we will focus on creating an address lookup service (FastAPI) that will use the unified table we have created.</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Tax brackets proposition]]></title>
            <link>localhost/blog/blog/posts/2024/tax_brackets_proposition.html</link>
            <guid>localhost/blog/blog/posts/2024/tax_brackets_proposition.html</guid>
            <pubDate>Sun, 27 Oct 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[<p><strong>Executive summary</strong>: The Belgian tax system is notably intricate, characterized by numerous tax brackets that determine the tax liability based on an individual's income. We take a look at the proposed changes to the tax brackets proposed by Bart De Wever in the latest version of the Super Nota (202410).</p>
]]></description>
            <content:encoded><![CDATA[<p><strong>Executive summary</strong>: The Belgian tax system is notably intricate, characterized by numerous tax brackets that determine the tax liability based on an individual's income. We take a look at the proposed changes to the tax brackets proposed by Bart De Wever in the latest version of the Super Nota (202410).</p>
<hr>
<h1 id="tax-brackets-proposition" tabindex="-1">Tax brackets proposition <a class="header-anchor" href="#tax-brackets-proposition" aria-label="Permalink to &quot;Tax brackets proposition&quot;">&ZeroWidthSpace;</a></h1>
<h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">&ZeroWidthSpace;</a></h2>
<p>The Belgian tax system is notably intricate, characterized by numerous tax brackets that determine the tax liability based on an individual's income.</p>
<p>In the latest version of the <a href="https://www.lecho.be/monargent/analyse/impots/ce-que-prevoit-la-nouvelle-super-note-de-bart-de-wever-pour-votre-argent/10569902.html" target="_blank" rel="noreferrer">Super Nota of Bart De Wever</a>, a proposal has been introduced to revise these tax brackets.</p>
<p>This analysis aims to provide a clearer understanding of the proposed changes to the tax brackets.</p>
<h2 id="quick-explanation-of-taxation-in-belgium" tabindex="-1">Quick explanation of taxation in Belgium <a class="header-anchor" href="#quick-explanation-of-taxation-in-belgium" aria-label="Permalink to &quot;Quick explanation of taxation in Belgium&quot;">&ZeroWidthSpace;</a></h2>
<p>In Belgium, personal income tax (IPP - Impot sur les Personnes Physiques) is calculated progressively on an individual‚Äôs net taxable income.</p>
<ul>
<li>Starting from the gross salary, social security contributions are deducted, resulting in a net income.</li>
<li>Then, a tax-free allowance, adjusted based on family situation (e.g., children), is subtracted.</li>
<li>The remaining taxable income is taxed in progressive brackets (currenlty ranging from 25% to 50%).</li>
<li>After calculating gross taxes, specific tax credits and reductions may apply. Monthly, a withholding tax, or &quot;pr√©compte professionnel,&quot; is taken directly from the salary as an advance on the IPP.</li>
<li>At year-end, this is reconciled against the total tax owed, leading to a refund or additional payment if necessary.</li>
</ul>
<h2 id="results" tabindex="-1">Results <a class="header-anchor" href="#results" aria-label="Permalink to &quot;Results&quot;">&ZeroWidthSpace;</a></h2>
<p><img src="https://github.com/tintamarre/tax_brakets_belgium/blob/main/imposition.png?raw=true" alt="Tax brackets"></p>
<p><em>As observed, the changes are quite significant. Each income decile will experience a reduction in the tax rate. The most substantial tax decrease will benefit those earning 20k euros annually (+4.7%) and those earning above 65k euros, with a reduction of &gt; +4.7%.</em></p>
<h2 id="references" tabindex="-1">References <a class="header-anchor" href="#references" aria-label="Permalink to &quot;References&quot;">&ZeroWidthSpace;</a></h2>
<ul>
<li><a href="https://github.com/tintamarre/tax_brakets_belgium/blob/main/imposition.py" target="_blank" rel="noreferrer">Tax brackets proposition source code</a></li>
<li><a href="https://www.lecho.be/monargent/analyse/impots/ce-que-prevoit-la-nouvelle-super-note-de-bart-de-wever-pour-votre-argent/10569902.html" target="_blank" rel="noreferrer">l'Echo : Ce que pr√©voit la nouvelle &quot;super note&quot; de Bart De Wever pour votre argent</a></li>
</ul>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Address lookup - Part 1 - Analysis]]></title>
            <link>localhost/blog/blog/posts/2024/address_lookup-part1-problematic.html</link>
            <guid>localhost/blog/blog/posts/2024/address_lookup-part1-problematic.html</guid>
            <pubDate>Thu, 03 Oct 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[<p><em>Executive summary</em>: In Belgium, a collaborative effort between regional and federal authorities has led to the creation of a unified service that aggregates all Belgian addresses into a comprehensive dataset. This dataset is called <a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BeStAddress</a>.</p>
]]></description>
            <content:encoded><![CDATA[<p><em>Executive summary</em>: In Belgium, a collaborative effort between regional and federal authorities has led to the creation of a unified service that aggregates all Belgian addresses into a comprehensive dataset. This dataset is called <a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BeStAddress</a>.</p>
<hr>
<h1 id="address-lookup-analysis-1" tabindex="-1">Address lookup - Analysis (1) <a class="header-anchor" href="#address-lookup-analysis-1" aria-label="Permalink to &quot;Address lookup - Analysis (1)&quot;">&ZeroWidthSpace;</a></h1>
<h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">&ZeroWidthSpace;</a></h2>
<p>This article outlines an experiment conducted by the <strong>Data Office</strong> of the <strong>Minist√®re de la F√©d√©ration Wallonie-Bruxelles</strong> aimed at leveraging existing address datasets more effectively.</p>
<p>The primary objective is to optimize the process of looking up addresses by postal codes, street names, and house numbers within these datasets, and eventually matching them with the <strong>BeStAddress</strong> dataset.</p>
<p>In Belgium, a collaborative initiative led by <strong>BOSA</strong>, in partnership with regional and federal authorities, resulted in the creation of a unified service that consolidates all Belgian addresses into a single, comprehensive dataset known as <a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BeStAddress</a>.</p>
<h2 id="quick-overview-of-bestaddress" tabindex="-1">Quick overview of BeStAddress <a class="header-anchor" href="#quick-overview-of-bestaddress" aria-label="Permalink to &quot;Quick overview of BeStAddress&quot;">&ZeroWidthSpace;</a></h2>
<p>At first glance, the dataset appears to be quite comprehensive, providing a wealth of information on addresses in Belgium. Key data points include:</p>
<ul>
<li><strong>Municipality names</strong> in French, Dutch, and German</li>
<li><strong>Postnames</strong> in French, Dutch, and German: In Belgium, postnames are used to identify specific zones within a municipality or across parts of one or several municipalities (further details on this will be provided later).</li>
<li><strong>Street names</strong> in French, Dutch, and German (often available in only one language depending on the region)</li>
<li><strong>Postcodes</strong></li>
<li><strong>House numbers</strong></li>
<li><strong>Box numbers</strong></li>
</ul>
<h3 id="example-of-a-single-record-as-json" tabindex="-1">Example of a single record (as JSON): <a class="header-anchor" href="#example-of-a-single-record-as-json" aria-label="Permalink to &quot;Example of a single record (as JSON):&quot;">&ZeroWidthSpace;</a></h3>
<div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">status</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">current</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">streetname_fr</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Rue de la Loi</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">streetname_de</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">null,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">streetname_nl</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Wetstraat</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">house_number</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">16</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">box_number</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">null,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">postcode</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">1000</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">municipality_name_fr</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Bruxelles</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">municipality_name_de</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">null,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">municipality_name_nl</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Brussel</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">postname_fr</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Bruxelles (Centre)</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">postname_nl</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">Brussel (Centrum)</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">region_code</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">BE-BRU</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">municipality_id</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">21004</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">street_id</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1679</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">address_id</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">210225</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">EPSG:4326_lat</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">50.84616</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">EPSG:4326_lon</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">4.36653</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">EPSG:31370_x</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">148303.0</span><span style="color: #89DDFF">,</span></span>
<span class="line"><span style="color: #BABED8">  </span><span style="color: #89DDFF">&quot;</span><span style="color: #C792EA">EPSG:31370_y</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">:</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">169017.0</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
</div><h3 id="summarize-the-datasets" tabindex="-1">Summarize the datasets <a class="header-anchor" href="#summarize-the-datasets" aria-label="Permalink to &quot;Summarize the datasets&quot;">&ZeroWidthSpace;</a></h3>
<p>Based on the export from BOSA website of the dataset in flat format (gzipped CSV) of the 2024-09-23, the dataset contains <strong>6 608 518 records</strong> of status = <code>current</code>.</p>
<p>Here are summaries of each column in each dataset:</p>
<ul>
<li><a href="https://github.com/tintamarre/tintamarre.github.io/blob/master/src/assets/datasets/bestaddress_bxl.md" target="_blank" rel="noreferrer">Brussels (Bruxelles) dataset summary</a></li>
<li><a href="https://github.com/tintamarre/tintamarre.github.io/blob/master/src/assets/datasets/bestaddress_vld.md" target="_blank" rel="noreferrer">Flanders (Vlaanderen) dataset summary</a></li>
<li><a href="https://github.com/tintamarre/tintamarre.github.io/blob/master/src/assets/datasets/bestaddress_wal.md" target="_blank" rel="noreferrer">Wallonia (Wallonie) dataset summary</a></li>
</ul>
<p>As we can see, the dataset contains a lot of fields. It is also multilingual, which seems obivious for an official dataset in Belgium (where French, Dutch and German are <a href="https://www.belgium.be/en/about_belgium/government/federale_staat" target="_blank" rel="noreferrer">the official languages</a>). It also contains some <strong>specific identifiers</strong> such as:</p>
<ul>
<li><code>municipality_id</code> (unique identifier for each municipality is equal to the <a href="https://en.wikipedia.org/wiki/NIS_code" target="_blank" rel="noreferrer">NIS codes</a>)</li>
<li><code>street_id</code></li>
<li><code>address_id</code></li>
</ul>
<h2 id="checking-uniqueness-of-the-identifiers" tabindex="-1">Checking uniqueness of the identifiers <a class="header-anchor" href="#checking-uniqueness-of-the-identifiers" aria-label="Permalink to &quot;Checking uniqueness of the identifiers&quot;">&ZeroWidthSpace;</a></h2>
<p>The first step is to check the uniqueness of the identifiers in the dataset. We will check if the <code>street_id</code>, <code>municipality_id</code>, and <code>address_id</code> are unique.</p>
<p>Let's write a query that will count per region the number of unique <code>street_id</code>, <code>municipality_id</code>, and <code>address_id</code> and the total number of records. If the sum of the unique counts is equal to the total number of records, it means that the identifiers are unique in the dataset.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">BE-BRU</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> region_code,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> municipality_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> municipality_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> street_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> address_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> address_id_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress_BRU</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">status</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">current</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #F78C6C">UNION ALL</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">BE-WAL</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> region_code,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> municipality_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> municipality_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> street_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> address_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> address_id_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress_WAL</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">status</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">current</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #F78C6C">UNION ALL</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">BE-VLG</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> region_code,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> municipality_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> municipality_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> street_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> address_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> address_id_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress_VLG</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">status</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">current</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #F78C6C">UNION ALL</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8">  </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">TOTAL</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> region_code,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> municipality_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> municipality_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> street_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> address_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> address_id_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress;</span></span></code></pre>
</div><h3 id="results" tabindex="-1">Results <a class="header-anchor" href="#results" aria-label="Permalink to &quot;Results&quot;">&ZeroWidthSpace;</a></h3>
<table>
<thead>
<tr>
<th>region_code</th>
<th style="text-align:right">municipality_id_count</th>
<th style="text-align:right">street_id_count</th>
<th style="text-align:right">address_id_count</th>
</tr>
</thead>
<tbody>
<tr>
<td>BE-BRU</td>
<td style="text-align:right">19</td>
<td style="text-align:right">5095</td>
<td style="text-align:right">790713</td>
</tr>
<tr>
<td>BE-WAL</td>
<td style="text-align:right">262</td>
<td style="text-align:right">57707</td>
<td style="text-align:right">1983442</td>
</tr>
<tr>
<td>BE-VLG</td>
<td style="text-align:right">300</td>
<td style="text-align:right">80354</td>
<td style="text-align:right">3834363</td>
</tr>
<tr>
<td>TOTAL</td>
<td style="text-align:right">581</td>
<td style="text-align:right">138457</td>
<td style="text-align:right">4203561</td>
</tr>
<tr>
<td>SUM = TOTAL</td>
<td style="text-align:right"><strong>ok!</strong> ‚úÖ</td>
<td style="text-align:right"><strong>nope</strong> ‚õî</td>
<td style="text-align:right"><strong>nope</strong> ‚õî</td>
</tr>
</tbody>
</table>
<ul>
<li>The <code>municipality_id</code> is unique in the dataset, which is mean that a municipality is unique in each region and is not shared between regions. This is expected as the <code>municipality_id</code> is equal to the <a href="https://en.wikipedia.org/wiki/NIS_code" target="_blank" rel="noreferrer">NIS codes</a>. The municipalities have a political and administrative meaning and are unique in each region.</li>
<li>The <code>street_id</code> shows that a street can be shared between multiple municipalities. This is not surprising as some streets can cross multiple municipalities.</li>
<li>The <code>address_id</code> is not unique throughout the three datasets, but it is probably unique in each dataset.</li>
</ul>
<p>Let's check the uniqueness of the <code>address_id</code> in each dataset.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">BE-BRU</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> region_code,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> address_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> address_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #89DDFF">*</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> total_row_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress_BRU</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">status</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">current</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #F78C6C">UNION ALL</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">BE-WAL</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> region_code,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> address_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> address_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #89DDFF">*</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> total_row_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress_WAL</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">status</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">current</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #F78C6C">UNION ALL</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">BE-VLG</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> region_code,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> address_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> address_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #89DDFF">*</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> total_row_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress_VLG</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">status</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">current</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #F78C6C">UNION ALL</span></span>
<span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">TOTAL</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> region_code,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> address_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> address_id_count,</span></span>
<span class="line"><span style="color: #BABED8">        </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #89DDFF">*</span><span style="color: #BABED8">) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> total_row_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress;</span></span></code></pre>
</div><table>
<thead>
<tr>
<th>region_code</th>
<th style="text-align:right">address_id_count</th>
<th style="text-align:right">total_row_count</th>
</tr>
</thead>
<tbody>
<tr>
<td>BE-BRU</td>
<td style="text-align:right">790713</td>
<td style="text-align:right">790713</td>
</tr>
<tr>
<td>BE-WAL</td>
<td style="text-align:right">1983442</td>
<td style="text-align:right">1983442</td>
</tr>
<tr>
<td>BE-VLG</td>
<td style="text-align:right">3834363</td>
<td style="text-align:right">3834363</td>
</tr>
<tr>
<td>TOTAL</td>
<td style="text-align:right">4203561</td>
<td style="text-align:right">6608518</td>
</tr>
</tbody>
</table>
<p>Indeed the <code>address_id</code> is unique in each dataset but is not unique throughout the three datasets.</p>
<h2 id="understanding-the-data-structure-deep-dive" tabindex="-1">Understanding the data structure - Deep dive <a class="header-anchor" href="#understanding-the-data-structure-deep-dive" aria-label="Permalink to &quot;Understanding the data structure - Deep dive&quot;">&ZeroWidthSpace;</a></h2>
<p>At first glance, we could think from the variables that a <strong>postcode</strong> include 1 or more municipalities and each municipality include 1 or more streets.</p>
<p>The model could simply be something like this:</p>
<ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/best_address_simple_model.drawio.png" alt="best address wrong model" width="800" /><p>Let's check the data to see if this is true.</p>
<p>In some cases, a street can be shared between 2 municipalities. This is the case for example of the street <strong>Rue de la Loi</strong> which is in postcodes <code>['1000', '1012', '1040','1045', '1049']</code> for status_code = 'BE-BRU'.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8">(postcode)</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress_bxl</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">1</span></span>
<span class="line"><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> street_id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1679</span></span>
<span class="line"><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">status</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">current</span><span style="color: #89DDFF">&#39;</span></span></code></pre>
</div><p>On the other hand, a <code>municipality_id</code> can belong to multiple postcodes.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8">(postcode)</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress_bxl</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span></span>
<span class="line"><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> municipality_id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">21004</span><span style="color: #BABED8"> </span><span style="color: #676E95; font-style: italic">-- Bruxelles</span></span>
<span class="line"><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">status</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">current</span><span style="color: #89DDFF">&#39;</span></span></code></pre>
</div><p>This will return 14 distincts postcodes: <code>['1047', '1010', '1045', '1030', '1070', '1000', '1020', '1012', '1130', '1040', '1050', '1120', '1007', '1049']</code>.</p>
<p>In reverse, a postcode can have multiple <code>municipality_id</code> values.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8">(municipality_id)</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress_bxl</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">1</span></span>
<span class="line"><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> postcode </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">1050</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8"> </span><span style="color: #676E95; font-style: italic">-- Ixelles</span></span>
<span class="line"><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">status</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">current</span><span style="color: #89DDFF">&#39;</span></span></code></pre>
</div><p>This will return 3 distincts <code>municipality_id</code>: <code>['21009', '21013', '21004']</code>.</p>
<p>Finally, a street with the same name, could have multiple <code>street_id</code> and <code>municipality_id</code> even within the same postcode. This is the case for example of the street <strong><code>Avenue Louise</code></strong>.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">municipality_id,</span></span>
<span class="line"><span style="color: #BABED8">street_id,</span></span>
<span class="line"><span style="color: #BABED8">postcode</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress_BRU</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span></span>
<span class="line"><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> streetname_fr </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">Avenue Louise</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">status</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">current</span><span style="color: #89DDFF">&#39;</span></span>
<span class="line"><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> all;</span></span></code></pre>
</div><table>
<thead>
<tr>
<th style="text-align:right">municipality_id</th>
<th style="text-align:right">street_id</th>
<th>postcode</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">21004</td>
<td style="text-align:right">1858</td>
<td>1050</td>
</tr>
<tr>
<td style="text-align:right">21009</td>
<td style="text-align:right">3919</td>
<td>1050</td>
</tr>
<tr>
<td style="text-align:right">21013</td>
<td style="text-align:right">751</td>
<td>1060</td>
</tr>
</tbody>
</table>
<h2 id="global-overview" tabindex="-1">Global overview <a class="header-anchor" href="#global-overview" aria-label="Permalink to &quot;Global overview&quot;">&ZeroWidthSpace;</a></h2>
<p>To better understand the relationships between the different entities in the dataset, we can perform some checks to see if there are any <strong>many-to-many</strong> relationships between the entities.</p>
<ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/best_address_postcode_vs_municipality.drawio.png" alt="Let's check the data" width="800" /><h3 id="_1-checking-if-a-postcode-belongs-to-multiple-municipality-id-values" tabindex="-1">1. Checking if a postcode belongs to multiple <code>municipality_id</code> values <a class="header-anchor" href="#_1-checking-if-a-postcode-belongs-to-multiple-municipality-id-values" aria-label="Permalink to &quot;1. Checking if a postcode belongs to multiple `municipality_id` values&quot;">&ZeroWidthSpace;</a></h3>
<p>To check if a postcode is associated with multiple <code>municipality_id</code> values, you can group by the postcode and count distinct <code>municipality_id</code> values. If a postcode has more than 1 unique municipality_id, it means that the postcode is associated with multiple municipalities.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> postcode,</span></span>
<span class="line"><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> municipality_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> municipality_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress</span></span>
<span class="line"><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> postcode</span></span>
<span class="line"><span style="color: #F78C6C">HAVING</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> municipality_id) </span><span style="color: #89DDFF">&gt;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8">;</span></span></code></pre>
</div><table>
<thead>
<tr>
<th>postcode</th>
<th style="text-align:right">municipality_count</th>
</tr>
</thead>
<tbody>
<tr>
<td>4910</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td>1050</td>
<td style="text-align:right">3</td>
</tr>
<tr>
<td>1030</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td>1070</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td>1040</td>
<td style="text-align:right">2</td>
</tr>
</tbody>
</table>
<p>This query will return all postcodes that are associated with more than one <code>municipality_id</code>. We only get 5 postcodes that are associated with multiple municipalities.</p>
<h3 id="_2-checking-if-a-municipality-id-belongs-to-multiple-postcode-values" tabindex="-1">2. Checking if a <code>municipality_id</code> belongs to multiple postcode values <a class="header-anchor" href="#_2-checking-if-a-municipality-id-belongs-to-multiple-postcode-values" aria-label="Permalink to &quot;2. Checking if a `municipality_id` belongs to multiple postcode values&quot;">&ZeroWidthSpace;</a></h3>
<p>Similarly, to check if a <code>municipality_id</code> is associated with multiple postcode values, group by <code>municipality_id</code> and count distinct postcode values. If a <code>municipality_id</code> has more than 1 unique postcode, it means that the <code>municipality_id</code> is associated with multiple postcodes.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> municipality_id,</span></span>
<span class="line"><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> postcode) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> postcode_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress</span></span>
<span class="line"><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> municipality_id</span></span>
<span class="line"><span style="color: #F78C6C">HAVING</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> postcode) </span><span style="color: #89DDFF">&gt;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8">;</span></span></code></pre>
</div><table>
<thead>
<tr>
<th style="text-align:right">municipality_id</th>
<th style="text-align:right">postcode_count</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">73042</td>
<td style="text-align:right">2</td>
</tr>
<tr>
<td style="text-align:right">11002</td>
<td style="text-align:right">14</td>
</tr>
<tr>
<td style="text-align:right">...</td>
<td style="text-align:right">...</td>
</tr>
</tbody>
</table>
<p>This query will return all <strong>municipality_id</strong> that are associated with more than one postcode. We have a 221 <strong>municipality_id</strong> that are associated with multiple postcodes. Only the first ones are shown here.</p>
<p>The relationship between postcodes and municipalities is then a <strong>many-to-many relationship</strong>.</p>
<h3 id="_3-checking-if-a-street-id-belongs-to-multiple-municipality-id-values" tabindex="-1">3. Checking if a <code>street_id</code> belongs to multiple <code>municipality_id</code> values <a class="header-anchor" href="#_3-checking-if-a-street-id-belongs-to-multiple-municipality-id-values" aria-label="Permalink to &quot;3. Checking if a `street_id` belongs to multiple `municipality_id` values&quot;">&ZeroWidthSpace;</a></h3>
<p>To check if a street is associated with multiple municipalities, you can group by the <code>street_id</code> and count distinct <code>municipality_id</code> values. If a street has more than 1 unique municipality_id, it means that the street is associated with multiple municipalities.</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SELECT</span><span style="color: #BABED8"> concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">-</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">,region_code, street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> unique_street,</span></span>
<span class="line"><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> municipality_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> municipality_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress</span></span>
<span class="line"><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">-</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">,region_code, street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> unique_street</span></span>
<span class="line"><span style="color: #F78C6C">HAVING</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> municipality_id) </span><span style="color: #89DDFF">&gt;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8">;</span></span></code></pre>
</div><p>This query will return all street_ids in the same region that are associated with more than one <code>municipality_id</code>. We have <strong>15</strong> street_id that are associated with more than one municipality_id.</p>
<h3 id="_4-checking-if-a-street-id-can-have-multiple-postname-values" tabindex="-1">4. Checking if a <code>street_id</code> can have multiple <code>postname_*</code> values <a class="header-anchor" href="#_4-checking-if-a-street-id-can-have-multiple-postname-values" aria-label="Permalink to &quot;4. Checking if a `street_id` can have multiple `postname_*` values&quot;">&ZeroWidthSpace;</a></h3>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #BABED8">concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D">-</span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">,municipality_id, street_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> unique_street,</span></span>
<span class="line"><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> concat_ws(</span><span style="color: #89DDFF">&#39;</span><span style="color: #C3E88D"> / </span><span style="color: #89DDFF">&#39;</span><span style="color: #BABED8">, postname_fr, postname_nl)) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> postname_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress</span></span>
<span class="line"><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> all</span></span>
<span class="line"><span style="color: #F78C6C">HAVING</span><span style="color: #BABED8"> </span><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(</span><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8"> default_postname) </span><span style="color: #89DDFF">&gt;</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">1</span><span style="color: #BABED8">;</span></span></code></pre>
</div><p>This query will return all unique streets that are associated with more than one <code>postname_*</code> values. We have 3104 unique streets that are associated with more than one <code>postname_*</code> values.</p>
<p>Example of a street with multiple postnames:</p>
<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #F78C6C">SELECT</span></span>
<span class="line"><span style="color: #F78C6C">DISTINCT</span><span style="color: #BABED8">(default_postname),</span></span>
<span class="line"><span style="color: #82AAFF">COUNT</span><span style="color: #BABED8">(address_id) </span><span style="color: #F78C6C">AS</span><span style="color: #BABED8"> address_count</span></span>
<span class="line"><span style="color: #F78C6C">FROM</span><span style="color: #BABED8"> bestAddress</span></span>
<span class="line"><span style="color: #F78C6C">WHERE</span><span style="color: #BABED8"> municipality_id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">25117</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">AND</span><span style="color: #BABED8"> street_id </span><span style="color: #89DDFF">=</span><span style="color: #BABED8"> </span><span style="color: #F78C6C">7705267</span></span>
<span class="line"><span style="color: #F78C6C">GROUP BY</span><span style="color: #BABED8"> all;</span></span></code></pre>
</div><table>
<thead>
<tr>
<th>default_postname</th>
<th style="text-align:right">address_count</th>
</tr>
</thead>
<tbody>
<tr>
<td>Chastre</td>
<td style="text-align:right">32</td>
</tr>
<tr>
<td>Villeroux</td>
<td style="text-align:right">1</td>
</tr>
</tbody>
</table>
<p>We conclude that a street can be associated with multiple postnames.</p>
<h2 id="takeaways-from-the-analysis" tabindex="-1">Takeaways from the analysis <a class="header-anchor" href="#takeaways-from-the-analysis" aria-label="Permalink to &quot;Takeaways from the analysis&quot;">&ZeroWidthSpace;</a></h2>
<ImageCenter src="https://raw.githubusercontent.com/tintamarre/tintamarre.github.io/refs/heads/master/src/assets/diagrams/best_address_model.drawio.png" alt="Let's check the data" width="800" /><ul>
<li>The <code>postcode</code> can be associated with multiple <code>municipality_id</code> values and a <code>municipality_id</code> can be associated with multiple <code>postcode</code> values. The relationship between postcodes and municipalities is then a <strong>many-to-many relationship</strong>.</li>
<li>The <code>municipality_id</code> is unique in the dataset, which is mean that a municipality is unique in each region and is not shared between regions.</li>
<li>The <code>address_id</code> is unique in each dataset but is not unique throughout the three datasets. A same <code>address_id</code> can be found in multiple regions.</li>
<li>The <code>street_id</code> shows that a street can be shared between multiple municipalities and that a municipality can have multiple streets. The relationship between streets and municipalities is then a <strong>many-to-many relationship</strong>.</li>
<li>Postname are not unique for a street. A single street can have multiple postnames. We will consider the <code>postname_*</code> as an attribute of the address and not as a key.</li>
</ul>
<h2 id="next-steps" tabindex="-1">Next steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next steps&quot;">&ZeroWidthSpace;</a></h2>
<p>In the next article, we will explore build a Big Table model of the dataset to use it in a more efficient way for address lookup.</p>
<p>Next steps: <a href="/blog/posts/2024/address_lookup-part2-sourcing.html">Address lookup - Part 2 - Sourcing</a></p>
<h3 id="references" tabindex="-1">References <a class="header-anchor" href="#references" aria-label="Permalink to &quot;References&quot;">&ZeroWidthSpace;</a></h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/NIS_code" target="_blank" rel="noreferrer">NIS codes</a></li>
<li><a href="https://www.smalsresearch.be/pourquoi-une-adresse-belge-cest-complique/" target="_blank" rel="noreferrer">Pourquoi une adresse belge, c'est compliqu√© ?</a></li>
<li><a href="https://bosa.belgium.be/fr/services/best-address-services" target="_blank" rel="noreferrer">BOSA - BeStAddress</a></li>
</ul>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[Hello World]]></title>
            <link>localhost/blog/blog/posts/2024/hello_world.html</link>
            <guid>localhost/blog/blog/posts/2024/hello_world.html</guid>
            <pubDate>Sat, 21 Sep 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[<h3 id="executive-summary" tabindex="-1">Executive summary <a class="header-anchor" href="#executive-summary" aria-label="Permalink to &quot;Executive summary&quot;">&ZeroWidthSpace;</a></h3>
<p>I have been thinking about it for a while, and I finally decided to start writing about my work and my interests. I will try to post regularly, but I am not sure I will be able to keep up with it. We will see.</p>
]]></description>
            <content:encoded><![CDATA[<h3 id="executive-summary" tabindex="-1">Executive summary <a class="header-anchor" href="#executive-summary" aria-label="Permalink to &quot;Executive summary&quot;">&ZeroWidthSpace;</a></h3>
<p>I have been thinking about it for a while, and I finally decided to start writing about my work and my interests. I will try to post regularly, but I am not sure I will be able to keep up with it. We will see.</p>
<hr>
<div class="tip custom-block"><p class="custom-block-title">TIP</p>
<p>The views expressed on this website are my own and do not necessarily reflect the views of my employer.</p>
</div>
]]></content:encoded>
        </item>
    </channel>
</rss>